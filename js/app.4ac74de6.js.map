{"version":3,"file":"js/app.4ac74de6.js","mappings":"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","sources":["webpack://yulin-research/./src/App.vue","webpack://yulin-research/./src/App.vue?7ccd","webpack://yulin-research/./src/views/HomeView.vue","webpack://yulin-research/./src/views/HomeView.vue?1da1","webpack://yulin-research/./src/views/BasicStatsView.vue","webpack://yulin-research/./src/utils/exportImage.js","webpack://yulin-research/./src/views/BasicStatsView.vue?d9d5","webpack://yulin-research/./src/views/CaseCountView.vue","webpack://yulin-research/./src/stores/dataStore.js","webpack://yulin-research/./src/views/CaseCountView.vue?74f2","webpack://yulin-research/./src/views/CaseBudgetView.vue","webpack://yulin-research/./src/views/CaseBudgetView.vue?583b","webpack://yulin-research/./src/router/index.js","webpack://yulin-research/./src/main.js","webpack://yulin-research/webpack/bootstrap","webpack://yulin-research/webpack/runtime/chunk loaded","webpack://yulin-research/webpack/runtime/compat get default export","webpack://yulin-research/webpack/runtime/define property getters","webpack://yulin-research/webpack/runtime/global","webpack://yulin-research/webpack/runtime/hasOwnProperty shorthand","webpack://yulin-research/webpack/runtime/jsonp chunk loading","webpack://yulin-research/webpack/startup"],"sourcesContent":["<script>\n  export default {\n    name: 'App',\n    setup() {\n      return {};\n    },\n  };\n</script>\n\n<template>\n  <div id=\"app\">\n    <router-view />\n  </div>\n</template>\n\n<style>\n  /* 引入共用樣式表 */\n  @import './assets/css/common.css';\n</style>\n","import { render } from \"./App.vue?vue&type=template&id=c7c0ba8c\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=c7c0ba8c&lang=css\"\n\nimport exportComponent from \"../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<script>\n  import { useRouter, useRoute } from 'vue-router';\n  import { computed } from 'vue';\n\n  export default {\n    name: 'HomeView',\n    setup() {\n      const router = useRouter();\n      const route = useRoute();\n\n      // 根據當前路由判斷活躍的 tab\n      const activeTab = computed(() => {\n        if (route.path.includes('basic-stats')) return 'basic-stats';\n        if (route.path.includes('case-count')) return 'case-count';\n        if (route.path.includes('case-budget')) return 'case-budget';\n        return 'basic-stats'; // 預設\n      });\n\n      const switchTab = (tab) => {\n        if (tab === 'basic-stats') {\n          router.push('/basic-stats');\n        } else if (tab === 'case-count') {\n          router.push('/case-count');\n        } else if (tab === 'case-budget') {\n          router.push('/case-budget');\n        }\n      };\n\n      return {\n        activeTab,\n        switchTab,\n      };\n    },\n  };\n</script>\n\n<template>\n  <div class=\"home-container\">\n    <!-- 標題 -->\n    <div class=\"w-100\">\n      <h1 class=\"my-title-xl-black text-center py-4 mb-0\">雲林縣研究案統計</h1>\n    </div>\n\n    <!-- 分頁導航 -->\n    <div class=\"d-flex justify-content-center w-50 mx-auto pb-4\">\n      <div class=\"d-flex align-items-center rounded-pill shadow my-blur gap-2 p-2 w-100\">\n        <button\n          class=\"btn rounded-pill border-0 my-btn-transparent my-font-size-xs text-nowrap w-100 my-cursor-pointer\"\n          :class=\"{ 'my-btn-blue': activeTab === 'basic-stats' }\"\n          @click=\"switchTab('basic-stats')\"\n        >\n          基本統計\n        </button>\n        <button\n          class=\"btn rounded-pill border-0 my-btn-transparent my-font-size-xs text-nowrap w-100 my-cursor-pointer\"\n          :class=\"{ 'my-btn-blue': activeTab === 'case-count' }\"\n          @click=\"switchTab('case-count')\"\n        >\n          委托案件數\n        </button>\n        <button\n          class=\"btn rounded-pill border-0 my-btn-transparent my-font-size-xs text-nowrap w-100 my-cursor-pointer\"\n          :class=\"{ 'my-btn-blue': activeTab === 'case-budget' }\"\n          @click=\"switchTab('case-budget')\"\n        >\n          平均金額\n        </button>\n      </div>\n    </div>\n\n    <!-- 路由內容區域 -->\n    <div class=\"content-section flex-grow-1\">\n      <router-view />\n    </div>\n  </div>\n</template>\n\n<style scoped>\n  .home-container {\n    min-height: 100vh;\n    display: flex;\n    flex-direction: column;\n  }\n\n  .content-section {\n    overflow-y: auto;\n  }\n</style>\n","import { render } from \"./HomeView.vue?vue&type=template&id=3c1bb939&scoped=true\"\nimport script from \"./HomeView.vue?vue&type=script&lang=js\"\nexport * from \"./HomeView.vue?vue&type=script&lang=js\"\n\nimport \"./HomeView.vue?vue&type=style&index=0&id=3c1bb939&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3c1bb939\"]])\n\nexport default __exports__","<script>\n  import { onMounted, onUnmounted, ref } from 'vue';\n  import * as d3 from 'd3';\n  import { exportContainerSvgAsPng } from '@/utils/exportImage';\n\n  export default {\n    name: 'BasicStatsView',\n    setup() {\n      const countsSummary = ref({ 全部: 0, 學術: 0, 非學術: 0, 雲林: 0 });\n\n      const drawYearLineChart = async () => {\n        const container = d3.select('#year-line');\n        container.selectAll('*').remove();\n        const width = container.node().getBoundingClientRect().width;\n        const height = 320;\n\n        const svg = container.append('svg').attr('width', width).attr('height', height);\n\n        // 顏色盤僅用於文字雲，折線圖有固定顏色\n\n        const margin = { top: 0, right: 0, bottom: 32, left: 32 };\n        const innerWidth = width - margin.left - margin.right;\n        const innerHeight = height - margin.top - margin.bottom;\n        const g = svg.append('g').attr('transform', `translate(${margin.left},${margin.top})`);\n\n        const data = await d3.json('/yulin-research/data/計畫年度.json');\n        const parsed = data\n          .map((d) => ({\n            year: +d['計畫年度'],\n            全部: +(d['委托案件數_全部'] ?? 0),\n            學術: +(d['委托案件數_學術單位執行'] ?? 0),\n            非學術: +(d['委托案件數_非學術單位執行'] ?? 0),\n            雲林: +(d['委托案件數_雲林縣政府主管'] ?? 0),\n          }))\n          .sort((a, b) => a.year - b.year);\n\n        // 統計四個數值總和（直接顯示數字）\n        const sumAll = d3.sum(parsed, (d) => d.全部 || 0) || 0;\n        const sumAcademic = d3.sum(parsed, (d) => d.學術 || 0) || 0;\n        const sumNonAcademic = d3.sum(parsed, (d) => d.非學術 || 0) || 0;\n        const sumYunlin = d3.sum(parsed, (d) => d.雲林 || 0) || 0;\n        countsSummary.value = {\n          全部: Math.round(sumAll),\n          學術: Math.round(sumAcademic),\n          非學術: Math.round(sumNonAcademic),\n          雲林: Math.round(sumYunlin),\n        };\n\n        const years = parsed.map((d) => d.year);\n        const [minYear, maxYear] = d3.extent(years);\n        // 在年份範圍兩端各加0.5年的緩衝，讓折線左右有空間\n        const x = d3\n          .scaleLinear()\n          .domain([minYear - 0.5, maxYear + 0.5])\n          .range([0, innerWidth]);\n\n        // 與 bar 圖一致的 Y 軸刻度計算（最多 5 條，包含 0）\n        const maxValue =\n          d3.max(parsed, (d) => Math.max(d.全部 || 0, d.學術 || 0, d.雲林 || 0)) || 1;\n        const getRoundedMax = (val) => {\n          let interval = 5;\n          if (val > 1000) {\n            interval = Math.ceil(val / 5000) * 250;\n            if (interval < 500) interval = 500;\n          } else if (val > 100) {\n            interval = Math.ceil(val / 500) * 25;\n            if (interval < 50) interval = 50;\n          } else if (val > 50) {\n            interval = 10;\n          } else if (val > 25) {\n            interval = 5;\n          }\n          if (interval % 5 !== 0) {\n            interval = Math.ceil(interval / 5) * 5;\n          }\n          const roundedMax = Math.ceil(val / interval) * interval;\n          if (roundedMax / interval < 2) return interval * 2;\n          return roundedMax;\n        };\n        const roundedMaxValue = getRoundedMax(maxValue);\n\n        const calculateYTicks = (roundedMax) => {\n          const ticks = [0];\n          let interval = 5;\n          while (roundedMax / interval > 4) {\n            interval += 5;\n          }\n          for (let i = interval; i <= roundedMax; i += interval) {\n            ticks.push(i);\n            if (ticks.length >= 5) break;\n          }\n          return ticks;\n        };\n        const yTicks = calculateYTicks(roundedMaxValue);\n\n        const y = d3.scaleLinear().domain([0, roundedMaxValue]).range([innerHeight, 0]);\n\n        const yAxis = d3\n          .axisLeft(y)\n          .tickValues(yTicks)\n          .tickSize(0)\n          .tickFormat((d) => d3.format(',')(d));\n\n        // X軸：每一年顯示一個刻度\n        const xAxis = d3\n          .axisBottom(x)\n          .tickValues(years)\n          .tickFormat((d) => d);\n\n        const xAxisG = g.append('g').attr('transform', `translate(0,${innerHeight})`).call(xAxis);\n        xAxisG.select('.domain').remove();\n        xAxisG.selectAll('text').style('font-size', '10px');\n\n        // Y軸\n        g.append('g').call(yAxis).select('.domain').remove();\n\n        // 灰色虛線水平網格，與 bar 圖一致\n        g.selectAll('.grid-line')\n          .data(yTicks)\n          .enter()\n          .append('line')\n          .attr('class', 'grid-line')\n          .attr('x1', 0)\n          .attr('x2', innerWidth)\n          .attr('y1', (d) => y(d))\n          .attr('y2', (d) => y(d))\n          .attr('stroke', '#bdbdbd')\n          .attr('stroke-width', 1)\n          .attr('stroke-dasharray', '3,3')\n          .attr('opacity', (d) => (d === 0 ? 0.8 : 0.4));\n\n        // 準備 tooltip（先清掉既有的）\n        d3.selectAll('.line-tooltip').remove();\n        const tooltip = d3\n          .select('body')\n          .append('div')\n          .attr('class', 'line-tooltip')\n          .style('position', 'absolute')\n          .style('background', 'rgba(0, 0, 0, 0.8)')\n          .style('color', 'white')\n          .style('padding', '8px 12px')\n          .style('border-radius', '4px')\n          .style('font-size', '12px')\n          .style('pointer-events', 'none')\n          .style('z-index', '1000')\n          .style('opacity', 0);\n\n        const makeLine = (key) =>\n          d3\n            .line()\n            .x((d) => x(d.year))\n            .y((d) => y(d[key] || 0));\n\n        // 三條折線：全部(藍)、學術(綠)、雲林縣政府主管(橘)\n        g.append('path')\n          .datum(parsed)\n          .attr('fill', 'none')\n          .attr('stroke', 'var(--my-color-blue)')\n          .attr('stroke-width', 2)\n          .attr('d', makeLine('全部'));\n\n        g.append('path')\n          .datum(parsed)\n          .attr('fill', 'none')\n          .attr('stroke', 'var(--my-color-green)')\n          .attr('stroke-width', 2)\n          .attr('d', makeLine('學術'));\n\n        g.append('path')\n          .datum(parsed)\n          .attr('fill', 'none')\n          .attr('stroke', 'var(--my-color-orange)')\n          .attr('stroke-width', 2)\n          .attr('d', makeLine('雲林'));\n\n        // 點\n        const drawPoints = (key, color, label) => {\n          g.selectAll(`circle.point-${key}`)\n            .data(parsed)\n            .enter()\n            .append('circle')\n            .attr('class', `point-${key}`)\n            .attr('cx', (d) => x(d.year))\n            .attr('cy', (d) => y(d[key] || 0))\n            .attr('r', 2.5)\n            .attr('fill', color)\n            .style('cursor', 'default')\n            .on('mouseover', function (event, d) {\n              tooltip\n                .style('opacity', 1)\n                .html(\n                  `<div><strong>${label}</strong></div><div>年度：${d.year}</div><div>數量：${\n                    d[key]?.toLocaleString?.() || d[key]\n                  }</div>`\n                );\n            })\n            .on('mousemove', function (event) {\n              tooltip.style('left', event.pageX + 10 + 'px').style('top', event.pageY - 10 + 'px');\n            })\n            .on('mouseout', function () {\n              tooltip.style('opacity', 0);\n            });\n        };\n        drawPoints('全部', 'var(--my-color-blue)', '委托案件數_全部');\n        drawPoints('學術', 'var(--my-color-green)', '委托案件數_學術單位執行');\n        drawPoints('雲林', 'var(--my-color-orange)', '委托案件數_雲林縣政府主管');\n\n        // 圖例（於容器下方的 legend 區塊）\n        const legend = d3\n          .select('#year-line-legend')\n          .html('')\n          .append('div')\n          .attr('class', 'd-flex justify-content-center gap-4');\n        const legendItems = [\n          { label: '全部', color: 'var(--my-color-blue)' },\n          { label: '執行單位為學術單位', color: 'var(--my-color-green)' },\n          { label: '主管機關為雲林縣政府', color: 'var(--my-color-orange)' },\n        ];\n        const item = legend\n          .selectAll('div.legend-item')\n          .data(legendItems)\n          .enter()\n          .append('div')\n          .attr('class', 'd-flex align-items-center legend-item');\n        item\n          .append('span')\n          .style('display', 'inline-block')\n          .style('width', '12px')\n          .style('height', '12px')\n          .style('border-radius', '2px')\n          .style('margin-right', '6px')\n          .style('background', (d) => d.color);\n        item\n          .append('span')\n          .style('font-size', '12px')\n          .text((d) => d.label);\n      };\n\n      const drawWordCloud = async (config) => {\n        const container = d3.select(`#${config.containerId}`);\n        container.selectAll('*').remove();\n        const width = container.node().getBoundingClientRect().width;\n        const height = 360;\n        const svg = container.append('svg').attr('width', width).attr('height', height);\n\n        const data = await d3.json(config.url);\n        const items = data\n          .map((d) => ({ text: d[config.textKey], value: +d[config.valueKey] }))\n          .filter((d) => d.text && d.value > 0);\n\n        // 縮放與排序\n        const sizeScale = d3\n          .scalePow()\n          .exponent(1.1)\n          .domain([0, d3.max(items, (d) => d.value)])\n          .range([12, 42]);\n        const words = items\n          .map((d) => ({\n            text: d.text,\n            size: Math.max(10, Math.round(sizeScale(d.value))),\n            value: d.value,\n          }))\n          .sort((a, b) => b.size - a.size);\n\n        // 以現有專案採用的防重疊策略（螺旋+BBox）\n        const placed = [];\n        const rects = [];\n        const measure = (text, fontSize) => {\n          const tempSvg = d3\n            .select('body')\n            .append('svg')\n            .attr('width', 0)\n            .attr('height', 0)\n            .style('position', 'absolute')\n            .style('left', '-9999px')\n            .style('top', '-9999px');\n          const tempText = tempSvg\n            .append('text')\n            .style('font-size', `${fontSize}px`)\n            .style('font-family', 'Arial, Microsoft JhengHei, sans-serif')\n            .text(text);\n          const bbox = tempText.node().getBBox();\n          tempSvg.remove();\n          return { w: bbox.width, h: bbox.height };\n        };\n\n        const centerX = width / 2;\n        const centerY = height / 2;\n        const pad = 1;\n        const intersect = (a, b) => !(a.r < b.l || a.l > b.r || a.b < b.t || a.t > b.b);\n\n        words.forEach((w) => {\n          let placedOk = false;\n          for (let fs = w.size; fs >= 10 && !placedOk; fs -= 2) {\n            const { w: tw, h: th } = measure(w.text, fs);\n            for (let t = 0; t < 3000 && !placedOk; t++) {\n              const ang = 0.35 * t;\n              const rad = 2 + 2 * ang;\n              let x = centerX + rad * Math.cos(ang);\n              let y = centerY + rad * Math.sin(ang);\n              let rect = {\n                l: x - tw / 2 - pad,\n                r: x + tw / 2 + pad,\n                t: y - th / 2 - pad,\n                b: y + th / 2 + pad,\n              };\n              if (rect.l < 0 || rect.r > width || rect.t < 0 || rect.b > height) continue;\n              if (rects.some((r) => intersect(rect, r))) continue;\n\n              // 中心擠壓\n              for (let s = 0; s < 140; s++) {\n                const vx = centerX - x;\n                const vy = centerY - y;\n                const len = Math.hypot(vx, vy) || 1;\n                const nx = x + (vx / len) * 1;\n                const ny = y + (vy / len) * 1;\n                const nrect = {\n                  l: nx - tw / 2 - pad,\n                  r: nx + tw / 2 + pad,\n                  t: ny - th / 2 - pad,\n                  b: ny + th / 2 + pad,\n                };\n                const oob = nrect.l < 0 || nrect.r > width || nrect.t < 0 || nrect.b > height;\n                if (oob || rects.some((r) => intersect(nrect, r))) break;\n                x = nx;\n                y = ny;\n                rect = nrect;\n              }\n\n              // 使用 CSS 變數色盤（本地定義），避免未定義錯誤\n              const palette = [\n                'var(--my-color-red)',\n                'var(--my-color-pink)',\n                'var(--my-color-deeporange)',\n                'var(--my-color-orange)',\n                'var(--my-color-amber)',\n                'var(--my-color-yellow)',\n                'var(--my-color-lime)',\n                'var(--my-color-light-green)',\n                'var(--my-color-green)',\n                'var(--my-color-teal)',\n                'var(--my-color-cyan)',\n                'var(--my-color-lightblue)',\n                'var(--my-color-blue)',\n                'var(--my-color-bluegrey)',\n                'var(--my-color-indigo)',\n                'var(--my-color-deeppurple)',\n                'var(--my-color-purple)',\n                'var(--my-color-brown)',\n              ];\n              placed.push({\n                text: w.text,\n                size: fs,\n                x,\n                y,\n                color: palette[Math.floor(Math.random() * palette.length)],\n              });\n              rects.push(rect);\n              placedOk = true;\n            }\n          }\n        });\n\n        // 全域微擠壓：多輪向中心微移，盡量減少空白\n        const passes = Math.min(60, Math.max(20, Math.floor(6000 / (placed.length || 1))));\n        for (let p = 0; p < passes; p++) {\n          for (let i = 0; i < placed.length; i++) {\n            const w = placed[i];\n            const { w: tw, h: th } = measure(w.text, w.size);\n            const vx = centerX - w.x;\n            const vy = centerY - w.y;\n            const len = Math.hypot(vx, vy) || 1;\n            const nx = w.x + (vx / len) * 1;\n            const ny = w.y + (vy / len) * 1;\n            const nrect = {\n              l: nx - tw / 2 - pad,\n              r: nx + tw / 2 + pad,\n              t: ny - th / 2 - pad,\n              b: ny + th / 2 + pad,\n            };\n            const out = nrect.l < 0 || nrect.r > width || nrect.t < 0 || nrect.b > height;\n            if (out) continue;\n            let collide = false;\n            for (let j = 0; j < rects.length; j++) {\n              if (j === i) continue;\n              if (intersect(nrect, rects[j])) {\n                collide = true;\n                break;\n              }\n            }\n            if (!collide) {\n              placed[i].x = nx;\n              placed[i].y = ny;\n              rects[i] = nrect;\n            }\n          }\n        }\n\n        svg\n          .selectAll('text')\n          .data(placed)\n          .enter()\n          .append('text')\n          .attr('x', (d) => d.x)\n          .attr('y', (d) => d.y)\n          .attr('text-anchor', 'middle')\n          .attr('dominant-baseline', 'middle')\n          .style('font-size', (d) => `${d.size}px`)\n          .style('font-family', 'Arial, Microsoft JhengHei, sans-serif')\n          .style('font-weight', 'bold')\n          .style('fill', (d) => d.color)\n          .text((d) => d.text);\n      };\n\n      var BasicStatsView_onResize = null;\n      onMounted(() => {\n        const redrawAll = () => {\n          drawYearLineChart();\n          drawWordCloud({\n            containerId: 'field-cloud',\n            url: '/yulin-research/data/研究領域.json',\n            textKey: '研究領域',\n            valueKey: '數量',\n          });\n          drawWordCloud({\n            containerId: 'keyword-cloud',\n            url: '/yulin-research/data/中文關鍵詞.json',\n            textKey: '中文關鍵詞',\n            valueKey: '數量',\n          });\n        };\n\n        redrawAll();\n\n        let resizeTimer = null;\n        const onResize = () => {\n          if (resizeTimer) clearTimeout(resizeTimer);\n          resizeTimer = setTimeout(() => {\n            redrawAll();\n          }, 200);\n        };\n        window.addEventListener('resize', onResize);\n\n        // 保存於閉包，供 onUnmounted 移除\n        BasicStatsView_onResize = onResize;\n      });\n\n      onUnmounted(() => {\n        d3.selectAll('.word-cloud-tooltip').remove();\n        if (BasicStatsView_onResize) window.removeEventListener('resize', BasicStatsView_onResize);\n      });\n\n      return { exportContainerSvgAsPng, countsSummary };\n    },\n  };\n</script>\n\n<template>\n  <div class=\"basic-stats-container\">\n    <div class=\"w-100 px-3\">\n      <div class=\"row\">\n        <div class=\"col-4\">\n          <div\n            class=\"my-bgcolor-white rounded-4 border pt-3 mb-4 position-relative\"\n            style=\"height: 320px\"\n          >\n            <div class=\"d-flex justify-content-center my-title-md-black mb-3\">委托案件數</div>\n            <div class=\"\">\n              <div>\n                <div class=\"p-3\">\n                  <div class=\"d-flex justify-content-between\">\n                    <div class=\"my-title-md-black\">委托案件數</div>\n                    <div class=\"my-content-md-black\">\n                      {{ countsSummary.全部?.toLocaleString?.() || countsSummary.全部 }}\n                    </div>\n                  </div>\n                </div>\n                <div class=\"border-bottom my-color-gray-400\"></div>\n                <div class=\"p-3\">\n                  <div class=\"d-flex justify-content-between\">\n                    <div class=\"my-title-md-black\">執行單位為學術單位</div>\n                    <div class=\"my-content-md-black\">\n                      {{ countsSummary.學術?.toLocaleString?.() || countsSummary.學術 }}\n                    </div>\n                  </div>\n                  <div class=\"d-flex justify-content-between pt-2\">\n                    <div class=\"my-title-md-black\">執行單位非學術單位</div>\n                    <div class=\"my-content-md-black\">\n                      {{ countsSummary.非學術?.toLocaleString?.() || countsSummary.非學術 }}\n                    </div>\n                  </div>\n                </div>\n                <div class=\"border-bottom my-color-gray-400\"></div>\n                <div class=\"p-3\">\n                  <div class=\"d-flex justify-content-between\">\n                    <div class=\"my-title-md-black\">主管機關為雲林縣政府</div>\n                    <div class=\"my-content-md-black\">\n                      {{ countsSummary.雲林?.toLocaleString?.() || countsSummary.雲林 }}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"col-8\">\n          <div class=\"my-bgcolor-white rounded-4 border py-3 position-relative\">\n            <button\n              class=\"btn btn-sm btn-outline-secondary position-absolute\"\n              style=\"\n                top: 8px;\n                right: 8px;\n                z-index: 2;\n                color: var(--my-color-gray-400);\n                border-color: var(--my-color-gray-400);\n              \"\n              title=\"下載 PNG\"\n              @click=\"exportContainerSvgAsPng('year-line', '年度趨勢.png')\"\n            >\n              <i class=\"fa-solid fa-download\"></i>\n            </button>\n            <div class=\"d-flex justify-content-center my-title-md-black mb-3\">\n              委托案件數年度趨勢\n            </div>\n            <div id=\"year-line\" style=\"height: 320px\"></div>\n            <div id=\"year-line-legend\" class=\"mt-2\"></div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"row\">\n        <div class=\"col-6 mt-4\">\n          <div class=\"my-bgcolor-white rounded-4 border p-3 mb-4 position-relative\">\n            <button\n              class=\"btn btn-sm position-absolute\"\n              style=\"\n                top: 8px;\n                right: 8px;\n                z-index: 2;\n                color: var(--my-color-gray-400);\n                border-color: var(--my-color-gray-400);\n              \"\n              title=\"下載 PNG\"\n              @click=\"exportContainerSvgAsPng('field-cloud', '研究領域_文字雲.png')\"\n            >\n              <i class=\"fa-solid fa-download\"></i>\n            </button>\n            <div class=\"d-flex justify-content-center my-title-md-black mb-3\">研究領域 文字雲</div>\n            <div id=\"field-cloud\" style=\"height: 360px; width: 100%\"></div>\n          </div>\n        </div>\n        <div class=\"col-6 mt-4\">\n          <div class=\"my-bgcolor-white rounded-4 border p-3 mb-4 position-relative\">\n            <button\n              class=\"btn btn-sm position-absolute\"\n              style=\"\n                top: 8px;\n                right: 8px;\n                z-index: 2;\n                color: var(--my-color-gray-400);\n                border-color: var(--my-color-gray-400);\n              \"\n              title=\"下載 PNG\"\n              @click=\"exportContainerSvgAsPng('keyword-cloud', '中文關鍵詞_文字雲.png')\"\n            >\n              <i class=\"fa-solid fa-download\"></i>\n            </button>\n            <div class=\"d-flex justify-content-center my-title-md-black mb-3\">\n              中文關鍵詞 文字雲\n            </div>\n            <div id=\"keyword-cloud\" style=\"height: 360px; width: 100%\"></div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n  .basic-stats-container {\n    min-height: 100vh;\n    display: flex;\n    flex-direction: column;\n  }\n</style>\n","// Export an SVG inside a container as PNG, with optional high-resolution scaling\n// optionsOrScale: number | { scale?: number; background?: string }\n// - scale: rasterization scale factor (default 2)\n// - background: canvas background color (default '#ffffff')\nexport async function exportContainerSvgAsPng(containerId, filename = 'chart.png', optionsOrScale = undefined) {\n  // Normalize options\n  const defaultScale = 2; // Increase resolution by default without changing call sites\n  const defaultBackground = '#ffffff';\n  const isNumber = typeof optionsOrScale === 'number';\n  const opts = isNumber\n    ? { scale: optionsOrScale, background: defaultBackground }\n    : { scale: (optionsOrScale && optionsOrScale.scale) || defaultScale, background: (optionsOrScale && optionsOrScale.background) || defaultBackground };\n\n  const container = document.getElementById(containerId);\n  if (!container) return;\n  const svg = container.querySelector('svg');\n  if (!svg) return;\n\n  // Clone first\n  const clonedSvg = svg.cloneNode(true);\n\n  // Copy computed styles from the original (attached) SVG to the clone.\n  // This ensures CSS variables and external styles are fully resolved to absolute values.\n  const styleProps = [\n    'fill',\n    'stroke',\n    'stroke-width',\n    'stroke-dasharray',\n    'stroke-linecap',\n    'stroke-linejoin',\n    'opacity',\n    'fill-opacity',\n    'stroke-opacity',\n    'font-family',\n    'font-size',\n    'font-weight',\n    'text-anchor',\n    'dominant-baseline',\n    'shape-rendering',\n    'letter-spacing',\n  ];\n\n  const originalNodes = [svg, ...svg.querySelectorAll('*')];\n  const cloneNodes = [clonedSvg, ...clonedSvg.querySelectorAll('*')];\n  const count = Math.min(originalNodes.length, cloneNodes.length);\n\n  for (let i = 0; i < count; i++) {\n    const src = originalNodes[i];\n    const dst = cloneNodes[i];\n    const computed = window.getComputedStyle(src);\n    styleProps.forEach((prop) => {\n      const val = computed.getPropertyValue(prop);\n      if (val && val !== 'initial') dst.setAttribute(prop, val);\n    });\n  }\n\n  // Ensure proper namespaces\n  clonedSvg.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n  clonedSvg.setAttribute('xmlns:xlink', 'http://www.w3.org/1999/xlink');\n\n  // Ensure width/height attributes are absolute numbers\n  const rect = svg.getBoundingClientRect();\n  const width = Math.ceil(rect.width || parseFloat(svg.getAttribute('width')) || 800);\n  const height = Math.ceil(rect.height || parseFloat(svg.getAttribute('height')) || 600);\n  clonedSvg.setAttribute('width', String(width));\n  clonedSvg.setAttribute('height', String(height));\n\n  const serializer = new XMLSerializer();\n  const svgString = serializer.serializeToString(clonedSvg);\n  const svgBlob = new Blob([svgString], { type: 'image/svg+xml;charset=utf-8' });\n  const url = URL.createObjectURL(svgBlob);\n\n  const img = new Image();\n  await new Promise((resolve, reject) => {\n    img.onload = resolve;\n    img.onerror = reject;\n    img.src = url;\n  });\n\n  const canvas = document.createElement('canvas');\n  const scale = Math.max(1, Number.isFinite(opts.scale) ? Number(opts.scale) : defaultScale);\n  canvas.width = Math.round(width * scale);\n  canvas.height = Math.round(height * scale);\n  const ctx = canvas.getContext('2d');\n  ctx.imageSmoothingEnabled = true;\n  if (ctx.imageSmoothingQuality) ctx.imageSmoothingQuality = 'high';\n\n  // Apply scale and paint background\n  ctx.scale(scale, scale);\n  ctx.fillStyle = opts.background || defaultBackground;\n  ctx.fillRect(0, 0, width, height);\n\n  // Draw the rasterized SVG\n  ctx.drawImage(img, 0, 0, width, height);\n\n  URL.revokeObjectURL(url);\n\n  const a = document.createElement('a');\n  a.download = filename;\n  a.href = canvas.toDataURL('image/png');\n  document.body.appendChild(a);\n  a.click();\n  document.body.removeChild(a);\n}\n","import { render } from \"./BasicStatsView.vue?vue&type=template&id=c5b81034&scoped=true\"\nimport script from \"./BasicStatsView.vue?vue&type=script&lang=js\"\nexport * from \"./BasicStatsView.vue?vue&type=script&lang=js\"\n\nimport \"./BasicStatsView.vue?vue&type=style&index=0&id=c5b81034&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-c5b81034\"]])\n\nexport default __exports__","<!--\n  案件數統計分析視圖組件 (CaseCountView.vue)\n\n  功能概述：\n  本組件專門用於分析雲林縣研究案的案件數統計，提供多維度的數據視覺化分析。\n\n  主要功能模組：\n  1. 主管機關委托案件數統計圖表 - 顯示前12名主管機關的案件數排名\n  2. 學術單位案件數分布地圖 - 台灣地圖上標記學術單位位置和案件數\n  3. 主管機關下屬執行單位分析 - 12個小圖表顯示各機關的執行單位分布\n  4. 主管機關與執行單位關係網絡圖 - 力導向圖顯示合作關係網絡\n\n  數據來源：\n  - 計畫主管機關_normalize.json：主管機關基本資料和統計數據\n  - 執行單位名稱_normalize.json：執行單位基本資料和統計數據\n  - 執行單位名稱_normalize_&_計畫主管機關_normalize.json：主管機關與執行單位的映射關係\n  - 執行單位名稱_locations.json：執行單位的地理位置座標\n\n  技術架構：\n  - Vue 3 Composition API：組件邏輯管理\n  - Pinia Store：數據狀態管理\n  - D3.js：圖表繪製和數據視覺化\n  - Leaflet.js：互動式地圖功能\n  - Bootstrap：響應式UI框架\n-->\n\n<script>\n  import { computed, onMounted, onUnmounted, nextTick } from 'vue';\n  import { useDataStore } from '@/stores/dataStore';\n  import * as d3 from 'd3';\n  import L from 'leaflet';\n  import { exportContainerSvgAsPng } from '@/utils/exportImage';\n\n  export default {\n    // 組件名稱：用於 Vue DevTools 調試和組件識別\n    name: 'CaseCountView',\n\n    setup() {\n      // 初始化數據管理 Store\n      // 使用 Pinia 的 useDataStore 來管理應用程式的數據狀態\n      const dataStore = useDataStore();\n\n      // ==================== 計算屬性 (Computed Properties) ====================\n      // 計算屬性具有響應式特性，當依賴的數據變化時會自動重新計算\n      // 同時具有緩存特性，只有依賴變化時才重新計算，提高性能\n      // 這些屬性會根據原始數據自動生成圖表所需的數據結構\n\n      /**\n       * 主管機關小圖表數據結構計算屬性\n       *\n       * 功能說明：\n       * 為前12名主管機關創建小圖表所需的數據結構，每個主管機關對應一個小圖表，\n       * 顯示該機關下屬執行單位的統計信息。\n       *\n       * 數據流程：\n       * 1. 從 dataStore 獲取前12名主管機關數據（包含下屬執行單位信息）\n       * 2. 為每個主管機關創建標準化的圖表配置對象\n       * 3. 返回包含12個圖表配置的陣列，供模板中的 v-for 指令使用\n       *\n       * 返回值結構：\n       * 陣列中的每個對象包含：\n       * - id: 唯一的DOM元素標識符，用於D3.js選擇器\n       * - title: 圖表顯示標題（主管機關名稱）\n       * - agencyData: 主管機關的基本統計數據\n       * - subUnits: 該機關下屬的執行單位列表\n       *\n       * 使用場景：\n       * 在模板中通過 v-for 指令動態生成12個小圖表，每個圖表顯示\n       * 一個主管機關的執行單位分布情況。\n       */\n      const getSupervisorChartsData = computed(() => {\n        // 步驟1：獲取前12名主管機關數據\n        // getTop10AgenciesWithSubUnits 返回按案件數排序的主管機關數據\n        // slice(0, 12) 截取前12個元素，確保不會超過12個圖表\n        const top12AgenciesWithSubUnits = dataStore.getTop10AgenciesWithSubUnits.slice(0, 12);\n\n        // 步驟2：數據結構轉換\n        // 使用 map 方法將原始數據轉換為圖表所需的標準化格式\n        return top12AgenciesWithSubUnits.map((agency, index) => ({\n          // 生成唯一的圖表ID，格式：supervisor-chart-1, supervisor-chart-2, ...\n          // 這個ID用於D3.js選擇器，確保每個圖表都能正確定位到對應的DOM元素\n          id: `supervisor-chart-${index + 1}`,\n\n          // 圖表標題：直接使用主管機關的完整名稱\n          // 不需要截短，因為小圖表的標題區域足夠顯示完整名稱\n          title: agency.name,\n\n          // 主管機關的核心統計數據\n          // 包含名稱、案件數、平均預算等關鍵指標\n          agencyData: {\n            name: agency.name, // 主管機關完整名稱\n            委托案件數: agency.委托案件數, // 該機關的總案件數\n            所有相符資料_JSON: agency.所有相符資料_JSON, // 該機關的平均預算金額\n          },\n\n          // 下屬執行單位列表\n          // 使用 || 運算符提供默認值，防止數據缺失導致的錯誤\n          // 如果 subUnits 存在則使用，否則使用空陣列\n          subUnits: agency.subUnits || [],\n        }));\n      });\n\n      /**\n       * 調試信息計算屬性\n       *\n       * 功能說明：\n       * 提供開發階段的問題診斷和數據驗證信息，幫助開發者了解組件的運行狀態。\n       * 這些信息會顯示在模板中，用於監控數據載入狀態、錯誤信息和數據統計。\n       *\n       * 主要用途：\n       * 1. 數據載入狀態監控：顯示載入中、載入完成或載入失敗的狀態\n       * 2. 數據可用性檢查：確認是否有足夠的數據來渲染圖表\n       * 3. 錯誤信息顯示：當數據載入失敗時，向用戶顯示具體的錯誤原因\n       * 4. 數據量統計：顯示處理後的數據數量，用於驗證數據處理邏輯\n       *\n       * 返回值結構：\n       * 包含四個關鍵狀態指標的對象，用於模板中的條件渲染和狀態顯示\n       */\n      const debugInfo = computed(() => ({\n        // 數據可用性檢查\n        // 通過檢查主管機關數據陣列的長度來判斷是否有可用數據\n        // 返回值：true 表示有數據可顯示，false 表示無數據\n        hasData: dataStore.supervisorAgencies.length > 0,\n\n        // 篩選後的有效數據量\n        // 顯示經過篩選和排序後的前10名主管機關數量\n        // 用於驗證數據處理邏輯是否正確，以及確認圖表能顯示多少數據\n        topUnitsCount: dataStore.getTopSupervisorAgencies.length,\n\n        // 數據載入狀態\n        // 從 dataStore 獲取當前的載入狀態\n        // 返回值：true 表示正在載入數據，false 表示載入完成\n        loading: dataStore.loading,\n\n        // 錯誤信息\n        // 從 dataStore 獲取載入過程中的錯誤信息\n        // 返回值：有錯誤時為錯誤訊息字串，無錯誤時為 null\n        error: dataStore.error,\n      }));\n\n      // ==================== 圖表繪製函數 (Chart Rendering Functions) ====================\n      // 本區域包含所有與圖表繪製相關的函數，使用 D3.js 進行數據視覺化\n      // 每個函數負責特定類型的圖表，包括主圖表、小圖表、地圖和網絡圖\n\n      /**\n       * 通用圖表繪製函數 - 根據傳入的配置和數據繪製條形圖\n       *\n       * 功能說明：\n       * - 使用 D3.js 創建響應式 SVG 柱狀圖\n       * - 支援動態數據量（主圖表8個，小圖表3個）\n       * - 防止 bar 重疊的唯一標識符設計\n       * - 在圖表上方顯示數值標籤\n       * - 完整的座標軸和標題系統\n       *\n       * @param {Object} config - 圖表配置對象\n       * @param {string} config.containerId - DOM 容器的 ID\n       * @param {Array} config.data - 要顯示的數據陣列\n       * @param {string} config.yAxisLabel - Y 軸標籤文字\n       * @param {number} [config.containerHeight] - 容器總高度（可選）\n       * @param {() => number} [config.getContainerHeight] - 以函數返回容器總高度（可選）\n       * @param {() => number} [config.getChartHeight] - 以函數返回圖表 bar 區高度（可選）\n       */\n      const drawChart = (config) => {\n        // ==================== 初始化和清理階段 ====================\n\n        // 使用 D3.js 選擇器選取目標 DOM 容器\n        // d3.select(): D3.js 的核心方法，類似 document.querySelector()\n        // `#${config.containerId}`: 模板字串，生成 CSS 選擇器如 \"#main-chart\"\n        const container = d3.select(`#${config.containerId}`);\n\n        // 檢查容器是否存在於 DOM 中\n        // container.empty(): 檢查選擇器是否找到元素\n        // container.node(): 獲取實際的 DOM 節點\n        // 如果容器不存在，記錄錯誤並提早返回，避免後續錯誤\n        if (container.empty() || !container.node()) {\n          // eslint-disable-next-line no-console\n          console.error(`圖表容器 #${config.containerId} 不存在`);\n          return; // 提早返回，停止函數執行\n        }\n\n        // 清除容器內的所有舊元素，防止重複渲染造成的視覺重疊\n        // selectAll('*'): 選擇容器內的所有子元素\n        // remove(): D3.js 方法，從 DOM 中移除選中的元素\n        container.selectAll('*').remove();\n\n        // ==================== 數據準備階段 ====================\n\n        // 從配置對象中提取圖表數據\n        // config.data: 包含要顯示的數據陣列，每個元素包含 name 和 value 屬性\n        const chartData = config.data;\n\n        // 從配置對象中提取 Y 軸標籤文字（現已移除Y軸標籤顯示）\n        // config.yAxisLabel: 字串，原用於顯示在 Y 軸旁邊，現在不再使用\n\n        // 數據有效性檢查：確保數據已載入且不為空\n        // !chartData: 檢查數據是否為 null 或 undefined\n        // chartData.length === 0: 檢查數據陣列是否為空\n        // 如果數據無效，顯示載入中提示並提早返回\n        if (!chartData || chartData.length === 0) {\n          // 在容器中創建載入中提示元素\n          container\n            .append('div') // 添加一個 div 元素\n            .attr('class', 'd-flex align-items-center justify-content-center h-100') // Bootstrap 類別：垂直水平置中，高度100%\n            .style('color', '#666') // 設定文字顏色為灰色\n            .text('載入中...'); // 設定提示文字\n          return; // 提早返回，停止函數執行\n        }\n\n        // ==================== 圖表尺寸設定階段 ====================\n\n        // 動態獲取容器的實際寬度，實現響應式設計\n        // getBoundingClientRect(): 瀏覽器 API，獲取元素的位置和尺寸信息\n        // .width: 提取寬度屬性，單位為像素\n        const containerWidth = container.node().getBoundingClientRect().width;\n\n        // 設定容器高度：優先使用函數回傳，否則使用傳入數值或預設320\n        const containerHeight =\n          (typeof config.getContainerHeight === 'function'\n            ? config.getContainerHeight()\n            : config.containerHeight) || 320;\n\n        // 設定圖表的內邊距（margin），實現滿版顯示效果\n        // 使用傳入的邊距設定，如果沒有傳入則使用滿版默認值\n        // ||: 邏輯或運算符，提供默認配置對象\n        const margin = config.margin || {\n          top: 20, // 頂部邊距：為數值標籤預留最小空間\n          right: 0, // 右側邊距：設為0實現右邊滿版\n          bottom: 160, // 底部邊距：為X軸垂直文字預留160px空間\n          left: 40, // 左側邊距：固定為32px以容納Y軸刻度數字\n        };\n\n        // 計算bar區域的實際高度：可由函數回傳，否則預設160px\n        const barAreaHeight =\n          (typeof config.getChartHeight === 'function' ? config.getChartHeight() : null) || 160;\n\n        // 計算實際可用的繪圖區域大小\n        // 從容器總寬度中減去左右邊距，得到圖表內容區域的寬度\n        const width = containerWidth - margin.left - margin.right;\n        // bar區域高度固定為160px，減去頂部邊距得到實際繪圖高度\n        const height = barAreaHeight - margin.top;\n\n        // ==================== SVG 容器創建階段 ====================\n\n        // 創建 SVG 主容器元素，作為整個圖表的根元素\n        const svg = container\n          .append('svg') // 在選定的容器中添加 SVG 元素\n          .attr('width', containerWidth) // 設定 SVG 的總寬度（包含邊距）\n          .attr('height', containerHeight); // 設定 SVG 的總高度（包含邊距）\n\n        // 創建主要繪圖群組（group），並應用邊距位移\n        // 所有的圖表元素都會在這個群組內繪製\n        // append('g'): 添加一個 SVG 群組元素\n        // attr('transform', ...): 設定群組的位移變換\n        // translate(${margin.left},${margin.top}): 將群組向右下移動，創造邊距效果\n        const g = svg.append('g').attr('transform', `translate(${margin.left},${margin.top})`);\n\n        // ==================== 比例尺設定階段（防止重疊的關鍵）====================\n\n        // 判斷當前是否為主圖表，用於決定顯示的數據量\n        // config.containerId === 'main-chart': 檢查容器 ID 是否為主圖表\n        // 主圖表顯示8個項目，小圖表顯示3個項目\n        const isMainChart = config.containerId === 'main-chart';\n\n        // 設定最大柱子數量，根據圖表類型動態調整\n        // 三元運算符: 條件 ? 真值 : 假值\n        // 主圖表12個，小圖表6個，確保固定的視覺佈局\n        const maxBars = isMainChart ? 12 : 6;\n\n        // 從原始數據中截取前 N 名數據\n        // slice(0, maxBars): JavaScript 陣列方法，截取從索引0開始的 maxBars 個元素\n        // 確保只顯示指定數量的項目\n        const topData = chartData.slice(0, maxBars);\n\n        // 創建固定位置的數據結構，確保每個位置都有唯一的名稱\n        // 這是防止柱子重疊的關鍵設計：為每個位置創建唯一標識符\n        // 主圖表固定8個位置，小圖表固定3個位置\n        // Array.from({ length: maxBars }, callback): 創建指定長度的陣列並填充\n        const displayData = Array.from({ length: maxBars }, (_, i) => {\n          // 檢查當前位置是否有實際數據\n          if (topData[i]) {\n            // 有數據的位置：展開原始數據並添加位置信息\n            return {\n              ...topData[i], // 使用展開運算符複製原始數據的所有屬性（name, value, fullName等）\n              position: i, // 添加位置標識符，用於排序和定位，值為 0, 1, 2, ...\n              uniqueName: `pos-${i}-${topData[i].name}`, // 創建唯一名稱，格式: pos-0-教育部, pos-1-科技部, ...\n            };\n          } else {\n            // 沒有數據的位置：創建空位佔位符，確保固定的視覺佈局\n            return {\n              name: `空位${i + 1}`, // 空位顯示名稱，用於調試和識別\n              value: 0, // 數值為0，不會顯示實際的柱子\n              fullName: '', // 完整名稱為空字串\n              isEmpty: true, // 標記為空位，用於後續過濾和處理\n              position: i, // 位置標識符，與有數據的位置保持一致的索引\n              uniqueName: `pos-${i}-empty`, // 空位的唯一名稱，格式: pos-3-empty, pos-4-empty, ...\n            };\n          }\n        });\n\n        // X 軸比例尺設定：實現 justify-content: space-around 效果\n        const barWidth = 16; // 固定柱子寬度為16px\n\n        // 實現 space-around 佈局的自定義比例尺\n        const dataCount = displayData.length;\n        const totalBarWidth = dataCount * barWidth; // 所有bar的總寬度\n        const availableSpaceWidth = width - totalBarWidth; // 可用於間距的寬度\n        const spaceUnit = availableSpaceWidth / (dataCount * 2); // 每個space-around單位的寬度\n\n        // 創建自定義的位置映射函數\n        const xScale = (uniqueName) => {\n          const index = displayData.findIndex((d) => d.uniqueName === uniqueName);\n          if (index === -1) return 0;\n          // space-around: 每個元素前後都有 spaceUnit，再加上前面所有bar和space的寬度\n          return spaceUnit + index * (barWidth + 2 * spaceUnit) + barWidth / 2;\n        };\n\n        // Y 軸比例尺設定：使用線性比例尺映射數值到 SVG 高度\n        const maxValue = d3.max(topData, (d) => d.value) || 1; // 獲取數據最大值\n\n        // 計算適合5的倍數刻度的最大值\n        const getRoundedMax = (val) => {\n          // 找到適當的間隔（5的倍數）\n          let interval = 5;\n\n          // 根據數值大小調整間隔\n          if (val > 1000) {\n            // 對於大於1000的數值，使用更大的5的倍數間隔\n            interval = Math.ceil(val / 5000) * 250; // 250, 500, 750, 1000, 1250...\n            if (interval < 500) interval = 500;\n          } else if (val > 100) {\n            interval = Math.ceil(val / 500) * 25; // 25, 50, 75, 100, 125...\n            if (interval < 50) interval = 50;\n          } else if (val > 50) {\n            interval = 10; // 50-100 使用間隔10\n          } else if (val > 25) {\n            interval = 5; // 25-50 使用間隔5\n          }\n\n          // 確保間隔是5的倍數\n          if (interval % 5 !== 0) {\n            interval = Math.ceil(interval / 5) * 5;\n          }\n\n          // 確保最大值是間隔的倍數，且略大於實際最大值\n          const roundedMax = Math.ceil(val / interval) * interval;\n\n          // 確保至少有合理的刻度數量（2-5條線）\n          if (roundedMax / interval < 2) {\n            return interval * 2; // 至少2條刻度線\n          }\n\n          return roundedMax;\n        };\n\n        const roundedMaxValue = getRoundedMax(maxValue);\n        const yScale = d3\n          .scaleLinear() // 創建線性比例尺，用於連續數值數據\n          .domain([0, roundedMaxValue]) // 定義域：從0到舍入後的最大值，確保刻度對齊\n          .range([height, 0]); // 值域：從圖表底部到頂部（SVG坐標系Y軸向下，需要反轉）\n\n        // 計算Y軸刻度：刻度值為5的倍數，最多5條線（包含0）\n        const calculateYTicks = (roundedMax) => {\n          const ticks = [0]; // 始終包含0作為基準線\n\n          // 計算適當的間隔，確保為5的倍數\n          let interval = 5;\n\n          // 根據最大值調整間隔，確保最多5條線\n          while (roundedMax / interval > 4) {\n            interval += 5; // 增加間隔，保持5的倍數\n          }\n\n          // 生成刻度，從interval開始，每次增加interval\n          for (let i = interval; i <= roundedMax; i += interval) {\n            ticks.push(i);\n            if (ticks.length >= 5) break; // 最多5條線\n          }\n\n          return ticks;\n        };\n\n        const yTicks = calculateYTicks(roundedMaxValue);\n\n        // ==================== 移除互動功能階段 ====================\n        // 根據用戶需求，移除了原有的 tooltip 互動功能\n        // 不再創建 tooltip 元素，簡化圖表顯示，專注於數據呈現\n\n        // ==================== 柱狀圖繪製階段（無重疊設計）====================\n\n        // 使用 D3.js 的數據綁定模式創建柱狀圖的矩形元素\n        // 這是 D3.js 的核心概念：數據驅動文檔（Data-Driven Documents）\n        g.selectAll('.bar') // 選擇所有具有 'bar' 類別的元素（初始為空）\n          .data(displayData) // 將 displayData 陣列與選中的元素綁定\n          .enter() // 處理數據多於元素的情況，為每個新數據項創建元素\n          .append('rect') // 在 SVG 中添加矩形元素，用於繪製柱子\n          .attr('class', 'bar') // 為每個矩形添加 'bar' CSS 類別，便於樣式控制\n          // 位置和尺寸設定（確保無重疊的關鍵設計）\n          .attr('x', (d) => xScale(d.uniqueName) - barWidth / 2) // X 座標：置中對齊固定寬度柱子\n          .attr('y', (d) => yScale(d.value)) // Y 座標：使用數值通過 yScale 計算位置（SVG 坐標系）\n          .attr('width', barWidth) // 寬度：使用固定的32px寬度\n          .attr('height', (d) => height - yScale(d.value)) // 高度：從圖表底部到數值對應的 Y 位置\n          .attr('fill', 'var(--my-color-blue)'); // 填充顏色：使用 CSS 自定義屬性，便於主題切換\n\n        // ==================== 數值標籤添加階段 ====================\n        // 在每個柱子的上方顯示具體數值，但只顯示有實際數據的項目\n        // 過濾掉空位和數值為0的項目，避免顯示無意義的標籤\n        // filter(): JavaScript 陣列方法，根據條件篩選元素\n        // !d.isEmpty: 不是空位\n        // d.value > 0: 數值大於0\n        const labelData = displayData.filter((d) => !d.isEmpty && d.value > 0);\n\n        // 使用 D3.js 數據綁定創建數值標籤的文字元素\n        g.selectAll('.bar-label') // 選擇所有具有 'bar-label' 類別的元素\n          .data(labelData) // 綁定過濾後的標籤數據（只包含有效數據）\n          .enter() // 為新數據項創建對應的元素\n          .append('text') // 在 SVG 中添加文字元素\n          .attr('class', 'bar-label') // 設定 CSS 類別，便於樣式控制\n          .attr('x', (d) => {\n            // X 座標計算：將標籤精確置於對應柱子的水平中央\n            // xScale(d.uniqueName): 使用唯一名稱獲取柱子中心點的 X 座標\n            // 由於使用 scalePoint 和固定寬度，直接返回中心點位置\n            return xScale(d.uniqueName);\n          })\n          .attr('y', (d) => {\n            // Y 座標計算：將標籤放置在柱子頂部的上方\n            // yScale(d.value): 使用數值獲取柱子頂部的 Y 座標\n            // - 5: 向上偏移5像素，讓標籤與柱子頂部保持適當距離，避免視覺重疊\n            // 注意：SVG 座標系中 Y 軸向下為正，所以減法表示向上移動\n            return yScale(d.value) - 5;\n          })\n          .attr('text-anchor', 'middle') // SVG 文字錨點：設定為中央對齊，配合 X 座標實現完美置中\n          .style('font-size', '12px') // CSS 樣式：設定字體大小為12像素，確保可讀性\n          .style('fill', '#333') // CSS 樣式：設定文字顏色為深灰色 (#333)，提供良好的對比度\n          .style('font-weight', 'bold') // CSS 樣式：設定粗體字重，增強數值的視覺重要性\n          .text((d) => d3.format(',')(d.value)); // 文字內容：使用 d3.format(',') 格式化數值，添加千分位逗號\n\n        // ==================== 座標軸和網格線繪製階段 ====================\n\n        // 繪製水平虛線網格：根據Y軸刻度繪製虛線，包含刻度0\n        g.selectAll('.grid-line')\n          .data(yTicks) // 綁定所有Y軸刻度數據（包括0）\n          .enter()\n          .append('line') // 添加線條元素\n          .attr('class', 'grid-line') // 設定CSS類別\n          .attr('x1', 0) // 線條起點X座標：圖表左邊\n          .attr('x2', width) // 線條終點X座標：圖表右邊\n          .attr('y1', (d) => yScale(d)) // 線條起點Y座標：根據刻度值計算\n          .attr('y2', (d) => yScale(d)) // 線條終點Y座標：與起點相同，形成水平線\n          .attr('stroke', '#bdbdbd') // 統一使用 gray-400 顏色 (#bdbdbd)\n          .attr('stroke-width', 1) // 設定線條寬度\n          .attr('stroke-dasharray', '3,3') // 設定虛線樣式：3像素實線，3像素空白\n          .attr('opacity', (d) => (d === 0 ? 0.8 : 0.4)); // 刻度0更明顯，其他更淡\n\n        // X 軸繪製：顯示主管機關或執行單位的名稱標籤\n        const xAxisGroup = g\n          .append('g') // 在主繪圖群組中添加新的群組元素，用於容納 X 軸\n          .attr('transform', `translate(0,${height})`); // 變換設定：將 X 軸群組移動到圖表底部\n\n        // 由於使用自定義 xScale 函數，不需要調用 d3.axisBottom\n        // 刻度線已設定為 tickSize(0)，所以不需要額外創建\n\n        // 移除預設的 X 軸文字，改為自訂垂直文字\n        xAxisGroup.selectAll('text').remove();\n\n        // 自訂 X 軸垂直文字：支援換行和垂直排列\n        displayData.forEach((dataItem) => {\n          if (!dataItem.isEmpty && dataItem.name) {\n            // 添加 dataItem.name 的檢查\n            const x = xScale(dataItem.uniqueName); // 取得 bar 的 x 位置\n            const text = dataItem.name;\n\n            // 為每個機關名稱創建垂直文字群組\n            const textGroup = xAxisGroup.append('g').attr('transform', `translate(${x}, 20)`); // 置中對齊 bar，向下偏移20px\n\n            // 將文字按每10個字符分割成多行\n            const lines = [];\n            for (let i = 0; i < text.length; i += 10) {\n              lines.push(text.substring(i, i + 10));\n            }\n\n            // 根據行數決定水平排列方式\n            const totalLines = lines.length;\n\n            lines.forEach((line, lineIndex) => {\n              // 計算每行的水平偏移：將多行置中排列\n              const lineOffset =\n                totalLines === 1\n                  ? 0\n                  : totalLines === 2\n                    ? lineIndex === 0\n                      ? -8\n                      : 8\n                    : totalLines === 3\n                      ? lineIndex === 0\n                        ? -12\n                        : lineIndex === 1\n                          ? 0\n                          : 12\n                      : // 4行或更多時，均勻分布\n                        (lineIndex - (totalLines - 1) / 2) * 8;\n\n              // 在每行內垂直排列字符\n              line.split('').forEach((char, charIndex) => {\n                textGroup\n                  .append('text')\n                  .text(char)\n                  .attr('x', lineOffset) // 水平偏移以實現多行排列\n                  .attr('y', charIndex * (12 + 0.6)) // 字體大小12px + letter-spacing 0.6px\n                  .style('font-size', '12px')\n                  .style('font-family', 'Arial, sans-serif')\n                  .style('fill', '#333')\n                  .style('text-anchor', 'middle'); // 水平置中\n              });\n            });\n          }\n        });\n\n        // Y 軸繪製：數值顯示在圖表內部，實現滿版效果\n        g.append('g') // 在主繪圖群組中添加新的群組元素，用於容納 Y 軸\n          .call(\n            d3\n              .axisLeft(yScale)\n              .tickValues(yTicks) // 使用自定義的刻度值\n              .tickSize(0) // 移除垂直刻度線\n              .tickFormat((d) => {\n                // 自定義格式化函數：顯示原始數字，添加千分位逗號\n                return d3.format(',')(d); // 使用千分位逗號格式化，不顯示k或M\n              }) // 格式化：顯示原始數字，添加千分位逗號\n          )\n          .style('font-size', '11px') // CSS 樣式：設定 Y 軸刻度文字的字體大小\n          .select('.domain')\n          .remove(); // 移除Y軸主線\n\n        // Y軸數值標籤保持在左側正常位置\n        g.selectAll('.tick text')\n          .style('fill', '#666') // 設定文字顏色\n          .style('font-weight', 'normal'); // 設定字重\n\n        // 移除Y軸標籤：根據用戶需求，不再顯示Y軸標籤\n      };\n\n      /**\n       * 小圖表批次繪製函數\n       * 功能：遍歷所有主管機關，為每個主管機關創建對應的執行單位統計圖表\n       *\n       * 處理流程：\n       * 1. 獲取前8名主管機關的數據\n       * 2. 為每個主管機關提取其下前3名執行單位\n       * 3. 調用通用圖表繪製函數創建小圖表\n       *\n       * 設計特點：\n       * - 統一使用 drawChart 函數，確保視覺一致性\n       * - 動態數據轉換，適配不同的數據結構\n       * - 批次處理，提高渲染效率\n       */\n      const drawSupervisorCharts = () => {\n        // 獲取計算屬性的值：前12名主管機關及其子單位數據\n        // .value: Vue 3 Composition API 中獲取計算屬性實際值的語法\n        const chartsData = getSupervisorChartsData.value;\n\n        // 添加防護性檢查\n        if (!chartsData || chartsData.length === 0) {\n          return;\n        }\n\n        // 遍歷每個主管機關的數據，為其創建對應的小圖表\n        // forEach(): JavaScript 陣列方法，對每個元素執行指定的函數\n        chartsData.forEach((chartData) => {\n          // 添加防護性檢查\n          if (!chartData || !chartData.subUnits) {\n            return;\n          }\n\n          // 數據格式轉換：將子單位數據轉換為圖表所需的格式\n          // 只取前6名執行單位，符合用戶需求\n          // slice(0, 6): 截取前6個子單位\n          // map(): 將每個子單位轉換為標準的圖表數據格式\n          const subUnitsData = chartData.subUnits\n            .slice(0, 6)\n            .map((unit) => {\n              // 添加防護性檢查\n              if (!unit || !unit.name_sub) {\n                return null;\n              }\n\n              return {\n                name: unit.name_sub, // 添加name屬性，drawChart函數需要這個屬性\n                uniqueName: unit.name_sub,\n                value: unit.委托案件數 || 0, // 使用委托案件數，提供默認值\n                extra: {\n                  count: unit.委托案件數 || 0, // 使用委托案件數，提供默認值\n                  budget: Math.round(unit.本期經費平均_千元 || 0), // 使用本期經費平均_千元，提供默認值\n                },\n              };\n            })\n            .filter(Boolean); // 過濾掉 null 值\n\n          // 如果沒有有效的子單位數據，跳過這個圖表\n          if (subUnitsData.length === 0) {\n            return;\n          }\n\n          // 小圖表配置對象：定義圖表的所有參數和設定\n          const chartConfig = {\n            // 容器ID：對應HTML中的元素ID，用於D3.js選擇器定位\n            containerId: chartData.id,\n            // 圖表數據：轉換後的執行單位數據陣列\n            data: subUnitsData,\n            // Y軸標籤：根據用戶需求，設為空字串不顯示\n            yAxisLabel: '',\n            // 容器高度：與主圖表完全一致（160px bar區域 + 160px文字區域）\n            containerHeight: 320,\n            // Tooltip模板：定義懸停提示的HTML內容（雖然已移除互動功能，但保留配置）\n            tooltipTemplate: (d) => `\n              <strong>${d.fullName}</strong><br/>\n              案件數: ${d.value}<br/>\n              平均預算: ${d.extra.budget}萬元<br/>\n              主管機關: ${d.extra.agencyName}\n            `,\n          };\n\n          // 調用通用圖表繪製函數：使用統一的繪圖邏輯創建小圖表\n          // 傳入配置對象，確保所有小圖表具有一致的視覺風格\n          drawChart(chartConfig);\n        });\n      };\n\n      // ==================== 數據準備函數區域 ====================\n\n      /**\n       * 主圖表數據準備函數\n       * 功能：從數據存儲中提取並轉換主管機關數據，準備用於主圖表顯示\n       *\n       * 處理邏輯：\n       * 1. 從 dataStore 獲取排序後的主管機關數據\n       * 2. 截取前8名（根據用戶最新需求調整）\n       * 3. 轉換數據格式以適配圖表繪製函數\n       * 4. 處理名稱長度以適應 X 軸顯示\n       *\n       * @returns {Array} 轉換後的圖表數據陣列\n       */\n      const prepareMainChartData = () => {\n        const topAgencies = dataStore.getTopSupervisorAgencies;\n\n        // 添加防護性檢查\n        if (!topAgencies || topAgencies.length === 0) {\n          return [];\n        }\n\n        return topAgencies\n          .map((agency) => {\n            // 確保 agency 和必要屬性存在\n            if (!agency || !agency.name) {\n              return null;\n            }\n\n            return {\n              name: agency.name, // 添加name屬性用於顯示\n              uniqueName: agency.name,\n              value: agency.委托案件數 || 0, // 使用委托案件數，提供默認值\n              extra: {\n                count: agency.委托案件數 || 0, // 使用委托案件數，提供默認值\n                budget: agency.本期經費平均_千元 || 0, // 使用本期經費平均_千元，提供默認值\n              },\n            };\n          })\n          .filter(Boolean); // 過濾掉 null 值\n      };\n\n      // ==================== 關係圖數據準備函數區域 ====================\n\n      /**\n       * 準備關係圖的節點和連結數據\n       * 功能：從主管機關與執行單位映射數據中提取節點和邊的關係\n       *\n       * 數據過濾原則：\n       * 只包含 \"學術單位\":\"TRUE\" 的數據，確保網絡圖只顯示學術相關的合作關係\n       *\n       * 數據處理流程：\n       * 1. 數據過濾：從所有主管機關中篩選出學術單位（\"學術單位\":\"TRUE\"）\n       * 2. 關係映射：收集與學術單位主管機關有關的所有映射關係\n       * 3. 節點創建：為學術單位主管機關和相關執行單位創建節點數據\n       * 4. 連結建立：基於映射關係創建節點間的連結，表示合作關係\n       * 5. 數據驗證：確保所有連結都指向實際存在的節點，避免渲染錯誤\n       *\n       * 節點類型定義：\n       * - 主管機關節點（type: 'agency'）：藍色圓圈，代表學術單位主管機關\n       * - 執行單位節點（type: 'unit'）：橘色圓圈，代表與學術單位合作的執行單位\n       *\n       * 數據結構設計：\n       * 每個節點包含完整的統計信息（案件數、預算、項目數等），\n       * 每個連結包含關係強度信息（基於案件數或預算金額）。\n       *\n       * 返回值結構：\n       * {\n       *   nodes: Array,  // 節點數據陣列，包含主管機關和執行單位\n       *   links: Array   // 連結數據陣列，表示節點間的合作關係\n       * }\n       *\n       * 使用場景：\n       * 為 D3.js 力導向網絡圖提供標準化的數據輸入，實現主管機關與\n       * 執行單位合作關係的視覺化展示。\n       */\n      const prepareNetworkGraphData = () => {\n        // 1. 獲取主管機關數據，找出所有學術單位\n        const supervisorAgencies = dataStore.supervisorAgencies;\n        if (!supervisorAgencies || supervisorAgencies.length === 0) {\n          console.log('沒有主管機關數據');\n          return { nodes: [], links: [] };\n        }\n\n        // 2. 創建學術單位集合\n        const academicAgencies = new Set();\n        supervisorAgencies.forEach((agency) => {\n          if (agency.學術單位 === 'TRUE') {\n            academicAgencies.add(agency.name);\n          }\n        });\n\n        console.log('學術單位主管機關:', [...academicAgencies]);\n\n        // 3. 獲取映射關係數據\n        const mappingData = dataStore.supervisorExecutingMapping;\n        if (!mappingData || mappingData.length === 0) {\n          console.log('沒有映射關係數據');\n          return { nodes: [], links: [] };\n        }\n\n        // 4. 過濾出只與學術單位有關的映射關係\n        const academicMappings = mappingData.filter((item) => academicAgencies.has(item.name));\n\n        console.log('過濾前映射數據數量:', mappingData.length);\n        console.log('過濾後學術單位映射數量:', academicMappings.length);\n\n        if (academicMappings.length === 0) {\n          console.log('沒有學術單位的映射關係');\n          return { nodes: [], links: [] };\n        }\n\n        // 5. 收集所有相關的執行單位，但只保留真正的學術單位\n        const academicUnits = new Set();\n        academicMappings.forEach((item) => {\n          // 檢查執行單位本身是否為學術單位\n          const unitData = dataStore.executingUnits.find((unit) => unit.name === item.name_sub);\n          if (unitData && unitData.學術單位 === 'TRUE') {\n            academicUnits.add(item.name_sub);\n          }\n        });\n\n        // 6. 創建節點數據\n        let nodes = [];\n\n        // 添加學術單位主管機關節點\n        academicAgencies.forEach((agencyName) => {\n          // 計算該主管機關的統計數據\n          const agencyMappings = academicMappings.filter((item) => item.name === agencyName);\n          const totalCount = agencyMappings.reduce((sum, item) => sum + (item.委托案件數 || 0), 0);\n          const totalBudget = agencyMappings.reduce(\n            (sum, item) => sum + (item.本期經費平均_千元 || 0),\n            0\n          );\n          const projectCount = agencyMappings.length;\n\n          nodes.push({\n            id: `agency-${agencyName}`,\n            name: agencyName,\n            type: 'agency',\n            totalCount: totalCount,\n            totalBudget: totalBudget,\n            projectCount: projectCount,\n            meanBudget: projectCount > 0 ? totalBudget / projectCount : 0,\n            isAcademic: true, // 標記為學術單位\n            academicStatus: 'TRUE', // 學術單位狀態\n          });\n        });\n\n        // 添加與學術單位有關係的執行單位節點\n        academicUnits.forEach((unitName) => {\n          // 計算該執行單位的統計數據\n          const unitMappings = academicMappings.filter((item) => item.name_sub === unitName);\n          const totalCount = unitMappings.reduce((sum, item) => sum + (item.委托案件數 || 0), 0);\n          const totalBudget = unitMappings.reduce(\n            (sum, item) => sum + (item.本期經費平均_千元 || 0),\n            0\n          );\n          const projectCount = unitMappings.length;\n\n          // 從執行單位數據中獲取學術單位狀態\n          const unitData = dataStore.executingUnits.find((item) => item.name === unitName);\n          const unitAcademicStatus = unitData ? unitData.學術單位 : 'FALSE';\n\n          nodes.push({\n            id: `unit-${unitName}`,\n            name: unitName,\n            type: 'unit',\n            totalCount: totalCount,\n            totalBudget: totalBudget,\n            projectCount: projectCount,\n            meanBudget: projectCount > 0 ? totalBudget / projectCount : 0,\n            isAcademic: unitAcademicStatus === 'TRUE',\n            academicStatus: unitAcademicStatus, // 使用 JSON 數據中的學術單位狀態\n          });\n        });\n\n        // 7. 創建連結數據，只保留目標執行單位是學術單位的連結\n        let links = academicMappings\n          .filter((item) => academicUnits.has(item.name_sub)) // 只保留目標執行單位在學術單位集合中的連結\n          .map((item) => ({\n            source: `agency-${item.name}`,\n            target: `unit-${item.name_sub}`,\n            value: item.委托案件數 || 0, // 案件數頁面使用委托案件數\n          }));\n\n        // 8. 合併案件數為 1 的執行單位節點為「其他」\n        //    策略：\n        //    - 找出 type==='unit' 且 totalCount === 1 的節點\n        //    - 將其從 nodes/links 中移除，並建立單一聚合節點 'unit-其他'\n        //    - 將所有指向這些節點的連結，依來源 agency 聚合加總為連到 'unit-其他' 的單一連結\n        const unitNodesToMerge = new Set(\n          nodes.filter((n) => n.type === 'unit' && Number(n.totalCount) === 1).map((n) => n.id)\n        );\n\n        if (unitNodesToMerge.size > 0) {\n          // 聚合目標節點的統計量\n          let aggTotalCount = 0;\n          let aggTotalBudget = 0;\n          let aggProjectCount = 0;\n\n          nodes\n            .filter((n) => unitNodesToMerge.has(n.id))\n            .forEach((n) => {\n              aggTotalCount += Number(n.totalCount) || 0;\n              aggTotalBudget += Number(n.totalBudget) || 0;\n              aggProjectCount += Number(n.projectCount) || 0;\n            });\n\n          // 依來源 agency 聚合連結權重\n          const linkAggBySource = new Map(); // key: sourceId, val: sumValue\n          links\n            .filter((l) => unitNodesToMerge.has(l.target))\n            .forEach((l) => {\n              const prev = linkAggBySource.get(l.source) || 0;\n              linkAggBySource.set(l.source, prev + (Number(l.value) || 0));\n            });\n\n          // 過濾掉原本指向要合併節點的連結\n          const keptLinks = links.filter((l) => !unitNodesToMerge.has(l.target));\n\n          // 若有聚合量，建立「其他」節點與新連結\n          if (aggProjectCount > 0 || aggTotalCount > 0) {\n            const otherNodeId = 'unit-其他';\n            const otherNode = {\n              id: otherNodeId,\n              name: '其他',\n              type: 'unit',\n              totalCount: aggTotalCount,\n              totalBudget: aggTotalBudget,\n              projectCount: aggProjectCount,\n              meanBudget: aggProjectCount > 0 ? aggTotalBudget / aggProjectCount : 0,\n              isAcademic: true,\n              academicStatus: 'TRUE',\n            };\n\n            // 產生聚合後的連結（每個 agency 只有一條連到「其他」）\n            const aggregatedLinks = Array.from(linkAggBySource.entries()).map(\n              ([sourceId, sumValue]) => ({\n                source: sourceId,\n                target: otherNodeId,\n                value: sumValue || 1,\n              })\n            );\n\n            // 更新 nodes 與 links（不提前 return，後續還要套用門檻過濾）\n            const keptNodes = nodes.filter((n) => !unitNodesToMerge.has(n.id));\n            keptNodes.push(otherNode);\n            nodes = keptNodes;\n            links = keptLinks.concat(aggregatedLinks);\n          }\n        }\n\n        // 9. 門檻過濾：只繪製「委托案件數 > 10」的節點，並同步過濾連結\n        const MIN_COUNT = 10;\n        const allowedNodeIds = new Set(\n          nodes.filter((n) => Number(n.totalCount) > MIN_COUNT).map((n) => n.id)\n        );\n        nodes = nodes.filter((n) => allowedNodeIds.has(n.id));\n        links = links.filter((l) => allowedNodeIds.has(l.source) && allowedNodeIds.has(l.target));\n\n        return { nodes, links };\n      };\n\n      // 學術單位案件數分布圖表功能已移除，恢復為地圖功能\n\n      /**\n       * 關係網絡圖繪製函數\n       *\n       * 功能說明：\n       * 使用 D3.js 力導向布局算法創建主管機關與執行單位的關係網絡圖，\n       * 通過節點和連結的視覺化展示，幫助用戶理解學術單位之間的合作關係\n       * 和網絡結構。這個圖表是整個分析系統的核心視覺化組件之一。\n       *\n       * 技術實現架構：\n       * - 布局引擎：D3.js 力導向模擬，實現節點的自動布局和動態調整\n       * - 視覺化設計：SVG 繪製，支持縮放、拖拽等互動操作\n       * - 數據驅動：基於 prepareNetworkGraphData 函數處理的標準化數據\n       * - 響應式設計：自動適應容器尺寸，支持不同螢幕分辨率\n       *\n       * 視覺設計特點：\n       * - 節點類型編碼：藍色圓圈代表主管機關，橘色圓圈代表執行單位\n       * - 大小編碼：圓圈大小與案件數成正比，直觀反映業務規模\n       * - 連結設計：灰色線條表示合作關係，線條粗細反映關係強度\n       * - 布局算法：力導向布局自動優化節點位置，避免重疊\n       *\n       * 互動功能：\n       * - 節點拖拽：用戶可以拖拽節點調整位置，優化視覺效果\n       * - 懸停效果：滑鼠懸停時顯示詳細的統計信息\n       * - 縮放平移：支持圖表的縮放和平移操作，便於查看細節\n       * - 動態更新：節點位置會根據力導向算法自動調整，形成最佳布局\n       *\n       * 性能優化：\n       * - 節點數量控制：只顯示學術單位相關的節點，避免圖表過於複雜\n       * - 動畫優化：使用 D3.js 的過渡動畫，提升用戶體驗\n       * - 記憶體管理：及時清理舊的圖表元素，防止記憶體洩漏\n       */\n      const drawNetworkGraph = () => {\n        // 獲取圖表數據：節點和連結關係\n        const graphData = prepareNetworkGraphData();\n\n        // 數據驗證：如果沒有節點，顯示提示信息\n        if (!graphData.nodes || graphData.nodes.length === 0) {\n          const container = d3.select('#network-graph');\n          container.html('<div class=\"text-center text-muted p-5\">暫無關係數據</div>');\n          return;\n        }\n\n        // 清除舊的圖表內容\n        const container = d3.select('#network-graph');\n        container.selectAll('*').remove();\n\n        // 獲取容器尺寸：動態適應容器大小\n        const containerRect = container.node().getBoundingClientRect();\n        const width = containerRect.width;\n        const height = 600; // 固定高度，與CSS設定一致\n\n        // 創建 SVG 容器：關係圖的根元素\n        const svg = container.append('svg').attr('width', width).attr('height', height);\n\n        // 創建主繪圖群組：所有圖形元素的容器\n        const g = svg.append('g');\n\n        // 添加縮放功能：允許用戶縮放和平移圖表\n        const zoom = d3\n          .zoom()\n          .scaleExtent([0.1, 3]) // 縮放範圍：0.1x 到 3x\n          .on('zoom', (event) => {\n            // 應用變換：縮放和平移\n            g.attr('transform', event.transform);\n          });\n\n        // 將縮放行為綁定到 SVG 元素\n        svg.call(zoom);\n\n        // 設定力導向模擬：控制節點和連結的物理行為\n        const simulation = d3\n          .forceSimulation(graphData.nodes)\n          .force(\n            'link',\n            d3\n              .forceLink(graphData.links)\n              .id((d) => d.id) // 使用節點 ID 來匹配連結\n              .distance(100)\n          ) // 連結的理想長度\n          .force('charge', d3.forceManyBody().strength(-300)) // 節點間的排斥力\n          .force('center', d3.forceCenter(width / 2, height / 2)) // 將圖形置於中心\n          .force(\n            'collision',\n            d3.forceCollide().radius((d) => {\n              // 計算節點半徑：讓節點面積與案件數成正比\n              // 目標：1500案件數對應50×50×π = 2500π平方像素\n              // 所以1案件數 = 1平方像素\n              // 面積 = 案件數，半徑 = √(面積/π)\n              const scaleMultiplier = 1.0; // 放大倍數：1.0 = 原始大小，2.0 = 放大2倍，0.5 = 縮小2倍\n              const area = d.totalCount * scaleMultiplier; // 面積 = 案件數 × 放大倍數\n              const radius = Math.sqrt(area / Math.PI);\n              return Math.max(5, Math.min(radius, 100)); // 最小半徑5px（直徑10px），最大半徑100px（直徑200px）\n            })\n          ); // 防止節點重疊，調整碰撞半徑與圓圈大小一致\n\n        // 繪製連結線：表示主管機關與執行單位的關係\n        const links = g\n          .append('g')\n          .attr('class', 'links')\n          .selectAll('line')\n          .data(graphData.links)\n          .enter()\n          .append('line')\n          .attr('stroke', '#999') // 灰色線條\n          .attr('stroke-opacity', 0.6) // 半透明效果\n          .attr('stroke-width', 2); // 固定線條寬度\n\n        // 繪製節點：主管機關和執行單位的圓圈\n        const nodes = g\n          .append('g')\n          .attr('class', 'nodes')\n          .selectAll('circle')\n          .data(graphData.nodes)\n          .enter()\n          .append('circle')\n          .attr('r', (d) => {\n            // 計算節點半徑：讓節點面積與案件數成正比\n            // 目標：1500案件數對應50×50×π = 2500π平方像素\n            // 所以1案件數 = 1平方像素\n            // 面積 = 案件數，半徑 = √(面積/π)\n            const scaleMultiplier = 5.0; // 放大倍數：1.0 = 原始大小，2.0 = 放大2倍，0.5 = 縮小2倍\n            const area = d.totalCount * scaleMultiplier; // 面積 = 案件數 × 放大倍數\n            const radius = Math.sqrt(area / Math.PI);\n            return Math.max(5, Math.min(radius, 100)); // 最小半徑5px（直徑10px），最大半徑100px（直徑200px）\n          })\n          .attr('fill', (d) => (d.type === 'agency' ? '#4a90e2' : '#f5a623')) // 藍色：機關，橘色：單位\n          .attr('stroke', '#fff') // 白色邊框\n          .attr('stroke-width', 2) // 邊框寬度\n          .style('cursor', 'pointer') // 滑鼠游標變為手型\n          .call(\n            d3\n              .drag() // 添加拖拽功能\n              .on('start', dragstarted) // 拖拽開始\n              .on('drag', dragged) // 拖拽進行中\n              .on('end', dragended)\n          ); // 拖拽結束\n\n        // 添加節點標籤：顯示機關或單位名稱\n        const labels = g\n          .append('g')\n          .attr('class', 'labels')\n          .selectAll('text')\n          .data(graphData.nodes)\n          .enter()\n          .append('text')\n          .text((d) => {\n            // 截短過長的名稱：超過10個字符則截斷並加省略號\n            return d.name.length > 10 ? d.name.substring(0, 10) + '...' : d.name;\n          })\n          .attr('font-size', '12px')\n          .attr('font-family', 'Arial, sans-serif')\n          .attr('fill', '#333')\n          .attr('text-anchor', 'middle') // 文字置中對齊\n          .attr('dy', '0.35em') // 垂直置中調整\n          .style('pointer-events', 'none'); // 標籤不響應滑鼠事件\n\n        // 創建自定義 tooltip 元素\n        const tooltip = d3\n          .select('body')\n          .append('div')\n          .attr('class', 'network-tooltip')\n          .style('position', 'absolute')\n          .style('padding', '10px')\n          .style('background', 'rgba(0, 0, 0, 0.8)')\n          .style('color', 'white')\n          .style('border-radius', '5px')\n          .style('font-size', '12px')\n          .style('line-height', '1.4')\n          .style('pointer-events', 'none')\n          .style('opacity', 0)\n          .style('z-index', '1000');\n\n        // 添加滑鼠事件：懸停顯示詳細資訊\n        nodes\n          .on('mouseover', function (event, d) {\n            // 高亮當前節點\n            d3.select(this)\n              .transition()\n              .duration(200)\n              .attr('stroke-width', 3)\n              .attr('stroke', '#333');\n\n            // 準備顯示的資訊\n            const typeText = d.type === 'agency' ? '主管機關' : '執行單位';\n\n            let tooltipContent = `\n              <div style=\"font-weight: bold; margin-bottom: 5px;\">${typeText}</div>\n              <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 8px;\">${d.name}</div>\n              <div>案件數: <span style=\"color: #4a90e2;\">${d.totalCount}</span></div>\n              <div>平均金額: <span style=\"color: #50e3c2;\">${Math.round(d.totalBudget / d.projectCount || 0).toLocaleString()}</span>(千元)</div>\n            `;\n\n            // 如果是執行單位，顯示額外資訊\n            if (d.type === 'unit') {\n              tooltipContent += `<div style=\"margin-top: 5px; color: #f5a623;\">🏫 學術機構</div>`;\n            }\n\n            // 顯示 tooltip\n            tooltip\n              .html(tooltipContent)\n              .style('opacity', 1)\n              .style('left', event.pageX + 10 + 'px')\n              .style('top', event.pageY - 10 + 'px');\n          })\n          .on('mousemove', function (event) {\n            // 跟隨滑鼠移動\n            tooltip.style('left', event.pageX + 10 + 'px').style('top', event.pageY - 10 + 'px');\n          })\n          .on('mouseout', function () {\n            // 恢復節點樣式\n            d3.select(this)\n              .transition()\n              .duration(200)\n              .attr('stroke-width', 2)\n              .attr('stroke', '#fff');\n\n            // 隱藏 tooltip\n            tooltip.transition().duration(200).style('opacity', 0);\n          });\n\n        // 力導向模擬的每一幀更新：更新節點和連結位置\n        simulation.on('tick', () => {\n          // 更新連結線的位置\n          links\n            .attr('x1', (d) => d.source.x)\n            .attr('y1', (d) => d.source.y)\n            .attr('x2', (d) => d.target.x)\n            .attr('y2', (d) => d.target.y);\n\n          // 更新節點圓圈的位置\n          nodes.attr('cx', (d) => d.x).attr('cy', (d) => d.y);\n\n          // 更新標籤文字的位置\n          labels.attr('x', (d) => d.x).attr('y', (d) => d.y);\n        });\n\n        // 拖拽事件處理函數：拖拽開始時重新啟動模擬\n        function dragstarted(event, d) {\n          if (!event.active) simulation.alphaTarget(0.3).restart();\n          d.fx = d.x; // 固定 X 座標\n          d.fy = d.y; // 固定 Y 座標\n        }\n\n        // 拖拽進行中：更新節點位置\n        function dragged(event, d) {\n          d.fx = event.x; // 更新固定的 X 座標\n          d.fy = event.y; // 更新固定的 Y 座標\n        }\n\n        // 拖拽結束：釋放節點固定位置\n        function dragended(event, d) {\n          if (!event.active) simulation.alphaTarget(0); // 停止模擬的熱重啟\n          d.fx = null; // 釋放 X 座標固定\n          d.fy = null; // 釋放 Y 座標固定\n        }\n      };\n\n      // ==================== 地圖初始化函數區域 ====================\n\n      /**\n       * 台灣地圖初始化函數\n       * 功能：使用 Leaflet.js 創建互動式地圖，顯示學術單位執行單位的地理分布\n       *\n       * 地圖特色：\n       * - 以台灣為中心的地理視圖\n       * - 圓圈標記代表執行單位位置\n       * - 圓圈大小反映案件數量\n       * - 點擊圓圈顯示詳細信息\n       * - 滿版顯示設計（左右下邊緣對齊容器）\n       *\n       * 數據篩選：\n       * - 只顯示包含「大學」或「學院」關鍵字的執行單位\n       * - 過濾掉沒有地理座標的單位\n       */\n      /**\n       * 台灣地圖初始化函數\n       *\n       * 功能說明：\n       * 創建互動式台灣地圖，在地圖上標記所有學術單位（學術單位）的地理位置，\n       * 並通過圓圈大小視覺化顯示各單位的案件數規模。這為用戶提供了\n       * 學術單位地理分布的直觀視圖，幫助理解研究案的地理分布模式。\n       *\n       * 技術實現架構：\n       * - 地圖引擎：使用 Leaflet.js 創建互動式地圖\n       * - 地圖服務：基於 OpenStreetMap 的免費地圖服務\n       * - 視覺化設計：圓圈大小與案件數成正比，實現數據的視覺化表達\n       * - 互動功能：支持縮放、拖拽、懸停效果和點擊彈出視窗\n       *\n       * 數據處理邏輯：\n       * 1. 從 dataStore 獲取學術單位數據（\"學術單位\":\"TRUE\"）\n       * 2. 結合地理位置數據，過濾出有座標信息的單位\n       * 3. 根據案件數計算圓圈大小，實現數據的視覺化表達\n       * 4. 為每個單位創建互動式標記，包含詳細的統計信息\n       *\n       * 視覺設計特點：\n       * - 圓圈標記：使用紅色圓圈標記學術單位位置\n       * - 大小編碼：圓圈大小反映委托案件數的相對規模\n       * - 透明度設計：半透明填充，確保地圖底層可見\n       * - 懸停效果：滑鼠懸停時圓圈變大變深，提升用戶體驗\n       *\n       * 彈出視窗內容：\n       * 點擊圓圈時顯示包含單位名稱、委托案件數和平均金額的詳細信息\n       */\n      const initMap = () => {\n        // 防止重複初始化：檢查地圖容器是否已存在 Leaflet 實例\n        const mapContainer = document.getElementById('taiwan-map');\n\n        // 檢查容器是否存在\n        if (!mapContainer) {\n          console.warn('地圖容器 taiwan-map 不存在');\n          return;\n        }\n\n        // Leaflet 實例檢查：_leaflet_id 是 Leaflet 自動添加的內部屬性\n        // 如果存在則表示已經初始化過地圖實例\n        if (mapContainer._leaflet_id) {\n          // 清理舊的 Leaflet 實例：重置內部 ID 和清空容器內容\n          mapContainer._leaflet_id = null; // 重置 Leaflet 內部標識\n          mapContainer.innerHTML = ''; // 清空容器內的所有 HTML 內容\n        }\n\n        // 創建地圖實例，設定中心點為台灣中部，移除版權和縮放控制\n        const map = L.map('taiwan-map', {\n          zoomControl: false, // 移除縮放按鈕\n          attributionControl: false, // 移除版權bar\n        }).setView([23.8, 120.9], 7);\n\n        // 添加 OpenStreetMap 圖層（無版權標示）\n        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n          attribution: '', // 移除版權文字\n        }).addTo(map);\n\n        // 獲取包含\"大學\"或\"學院\"並有地理位置的執行單位數據\n        const universityUnits = dataStore.getUniversityExecutingUnitsWithLocation;\n\n        // 輸出除錯資訊\n        console.log('地圖數據:', {\n          總大學學院數: universityUnits.length,\n          有地理位置的數量: universityUnits.filter((u) => u.hasLocation).length,\n          樣本數據: universityUnits.slice(0, 3),\n        });\n\n        // 如果沒有數據，顯示提示訊息\n        if (universityUnits.length === 0) {\n          console.warn('沒有找到包含學術單位且有地理位置的執行單位數據');\n          return;\n        }\n\n        // 在地圖上添加圓圈標記，大小反映案件數\n        universityUnits.forEach((unit) => {\n          // 跳過沒有地理位置的單位\n          if (!unit.hasLocation) return;\n\n          // 計算圓圈大小：基於案件數的相對大小\n          // 使用對數比例確保視覺效果合理\n          const scaleFactor = 10; // 縮放因子，調整整體大小\n          const radius = Math.sqrt((unit.委托案件數 * scaleFactor) / Math.PI); // 使用委托案件數\n\n          // 創建圓圈標記\n          const circle = L.circle([unit.lat, unit.lng], {\n            color: 'var(--my-color-red)', // 邊框顏色\n            fillColor: 'var(--my-color-red)', // 填充顏色\n            fillOpacity: 0.6, // 透明度\n            radius: radius * 1000, // 轉換為公尺\n            weight: 1, // 邊框寬度\n          }).addTo(map);\n\n          // 創建詳細的彈出視窗內容\n          const popupContent = `\n            <div>\n              <strong>${unit.name}</strong><br/>\n              <div>\n                <div>委托案件數: ${unit.委托案件數.toLocaleString()}</div>\n                <div>平均金額: ${Math.round(unit.本期經費平均_千元).toLocaleString()}(千元)</div>\n              </div>\n            </div>\n          `;\n\n          // 綁定彈出視窗\n          circle.bindPopup(popupContent, {\n            maxWidth: 300,\n          });\n\n          // 添加滑鼠懸停效果\n          circle.on('mouseover', function () {\n            this.setStyle({\n              fillOpacity: 0.8,\n              weight: 3,\n            });\n          });\n\n          circle.on('mouseout', function () {\n            this.setStyle({\n              fillOpacity: 0.6,\n              weight: 2,\n            });\n          });\n        });\n      };\n\n      /**\n       * 文字雲繪製函數\n       *\n       * 功能說明：\n       * 使用 D3.js 創建學術單位的文字雲視覺化，文字大小反映各單位的委托案件數。\n       * 這為用戶提供了另一種視角來理解學術單位的案件分布情況，文字越大表示案件數越多。\n       *\n       * 技術實現架構：\n       * - 布局算法：使用 D3.js 的 d3-cloud 布局算法，實現文字的隨機分布\n       * - 視覺化設計：文字大小與案件數成正比，實現數據的視覺化表達\n       * - 互動功能：支持滑鼠懸停效果，顯示詳細的統計信息\n       * - 響應式設計：自動適應容器尺寸，支持不同螢幕分辨率\n       *\n       * 數據處理邏輯：\n       * 1. 從 dataStore 獲取學術單位數據（\"學術單位\":\"TRUE\"）\n       * 2. 過濾出有案件數的單位，避免顯示零案件數的單位\n       * 3. 根據案件數計算文字大小，實現數據的視覺化表達\n       * 4. 使用 d3-cloud 算法計算文字的隨機位置，避免重疊\n       *\n       * 視覺設計特點：\n       * - 文字大小編碼：文字大小與委托案件數成正比\n       * - 顏色編碼：使用漸變色彩，案件數越多顏色越深\n       * - 隨機布局：文字位置隨機分布，創造視覺上的動態感\n       * - 懸停效果：滑鼠懸停時文字變大變深，提升用戶體驗\n       *\n       * 性能優化：\n       * - 只顯示有案件數的學術單位，避免無意義的視覺元素\n       * - 使用 D3.js 的過渡動畫，提升用戶體驗\n       * - 及時清理舊的文字雲元素，防止記憶體洩漏\n       */\n      const drawWordCloud = () => {\n        // 獲取文字雲容器\n        const container = d3.select('#word-cloud');\n        if (container.empty()) {\n          console.warn('文字雲容器 #word-cloud 不存在');\n          return;\n        }\n\n        // 清理容器\n        container.selectAll('*').remove();\n\n        // 獲取學術單位數據\n        const academicUnits = dataStore.executingUnits.filter(\n          (unit) => unit.學術單位 === 'TRUE' && unit.委托案件數 > 0\n        );\n\n        if (academicUnits.length === 0) {\n          container\n            .append('div')\n            .attr('class', 'd-flex align-items-center justify-content-center h-100')\n            .style('color', '#666')\n            .text('無學術單位數據');\n          return;\n        }\n\n        // 計算字級比例尺（壓縮動態範圍，避免字過大）\n        const countsForScale = academicUnits.map((u) => u.委托案件數 || 0);\n        const minCountForScale = d3.min(countsForScale) || 0;\n        const maxCountForScale = d3.max(countsForScale) || 1;\n        const sizeScale = d3\n          .scalePow()\n          .exponent(1.15)\n          .domain([minCountForScale, maxCountForScale])\n          .range([12, 44]);\n\n        // 準備文字雲數據（套用縮小後字級）\n        const wordData = academicUnits.map((unit) => ({\n          text: unit.name,\n          size: Math.max(10, Math.round(sizeScale(unit.委托案件數 || 0))),\n          count: unit.委托案件數,\n          budget: unit.本期經費平均_千元 || 0,\n        }));\n\n        // 創建 SVG 容器\n        const containerWidth = container.node().getBoundingClientRect().width;\n        const containerHeight = 400;\n\n        const svg = container\n          .append('svg')\n          .attr('width', containerWidth)\n          .attr('height', containerHeight);\n\n        // CSS 顏色變數陣列\n        const cssColors = [\n          'var(--my-color-red)',\n          'var(--my-color-pink)',\n          'var(--my-color-deeporange)',\n          'var(--my-color-orange)',\n          'var(--my-color-amber)',\n          'var(--my-color-yellow)',\n          'var(--my-color-lime)',\n          'var(--my-color-light-green)',\n          'var(--my-color-green)',\n          'var(--my-color-teal)',\n          'var(--my-color-cyan)',\n          'var(--my-color-lightblue)',\n          'var(--my-color-blue)',\n          'var(--my-color-bluegrey)',\n          'var(--my-color-indigo)',\n          'var(--my-color-deeppurple)',\n          'var(--my-color-purple)',\n          'var(--my-color-brown)',\n        ];\n\n        // 以螺旋搜尋與實際文字矩形碰撞檢測的防重疊布局\n        const words = [];\n        const placedRects = [];\n\n        // 測量特定字級的文字實際寬高\n        const measureText = (text, fontSize) => {\n          const tempSvg = d3\n            .select('body')\n            .append('svg')\n            .attr('width', 0)\n            .attr('height', 0)\n            .style('position', 'absolute')\n            .style('left', '-9999px')\n            .style('top', '-9999px');\n          const tempText = tempSvg\n            .append('text')\n            .style('font-size', `${fontSize}px`)\n            .style('font-family', 'Arial, Microsoft JhengHei, sans-serif')\n            .text(text);\n          const bbox = tempText.node().getBBox();\n          tempSvg.remove();\n          return { width: bbox.width, height: bbox.height };\n        };\n\n        const centerX = containerWidth / 2;\n        const centerY = containerHeight / 2;\n        const marginPad = 2;\n\n        const rectsIntersect = (a, b) =>\n          !(a.right < b.left || a.left > b.right || a.bottom < b.top || a.top > b.bottom);\n\n        const sortedWordData = [...wordData].sort((a, b) => b.size - a.size);\n\n        sortedWordData.forEach((word) => {\n          let placed = false;\n\n          // 嘗試縮小字級以增加可放置機會\n          for (let trySize = word.size; trySize >= 10 && !placed; trySize -= 2) {\n            const { width, height } = measureText(word.text, trySize);\n\n            // 螺旋搜尋位置\n            for (let t = 0; t < 2000 && !placed; t++) {\n              const angle = 0.35 * t;\n              const radius = 2 + 2 * angle;\n              const x = centerX + radius * Math.cos(angle);\n              const y = centerY + radius * Math.sin(angle);\n\n              const rect = {\n                left: x - width / 2 - marginPad,\n                right: x + width / 2 + marginPad,\n                top: y - height / 2 - marginPad,\n                bottom: y + height / 2 + marginPad,\n              };\n\n              // 邊界檢查\n              if (\n                rect.left < 0 ||\n                rect.right > containerWidth ||\n                rect.top < 0 ||\n                rect.bottom > containerHeight\n              ) {\n                continue;\n              }\n\n              // 與已放置文字碰撞檢測\n              const hasCollision = placedRects.some((r) => rectsIntersect(rect, r));\n              if (!hasCollision) {\n                // 朝中心方向作微移擠壓，盡量貼近中心\n                let curX = x;\n                let curY = y;\n                let curRect = { ...rect };\n                for (let s = 0; s < 80; s++) {\n                  const vx = centerX - curX;\n                  const vy = centerY - curY;\n                  const vlen = Math.hypot(vx, vy) || 1;\n                  const step = 1; // 每步1px\n                  const nx = curX + (vx / vlen) * step;\n                  const ny = curY + (vy / vlen) * step;\n                  const nrect = {\n                    left: nx - width / 2 - marginPad,\n                    right: nx + width / 2 + marginPad,\n                    top: ny - height / 2 - marginPad,\n                    bottom: ny + height / 2 + marginPad,\n                  };\n                  const outOfBounds =\n                    nrect.left < 0 ||\n                    nrect.right > containerWidth ||\n                    nrect.top < 0 ||\n                    nrect.bottom > containerHeight;\n                  const collide = placedRects.some((r) => rectsIntersect(nrect, r));\n                  if (outOfBounds || collide) break;\n                  curX = nx;\n                  curY = ny;\n                  curRect = nrect;\n                }\n\n                const placedWord = {\n                  text: word.text,\n                  size: trySize,\n                  budget: word.budget,\n                  count: word.count,\n                  x: curX,\n                  y: curY,\n                  color: cssColors[Math.floor(Math.random() * cssColors.length)],\n                };\n                words.push(placedWord);\n                placedRects.push(curRect);\n                placed = true;\n              }\n            }\n          }\n        });\n\n        // 繪製文字雲\n        svg\n          .selectAll('text')\n          .data(words)\n          .enter()\n          .append('text')\n          .style('font-size', (d) => `${d.size}px`)\n          .style('font-family', 'Arial, Microsoft JhengHei, sans-serif')\n          .style('font-weight', 'bold')\n          .style('fill', (d) => d.color)\n          .style('cursor', 'pointer')\n          .attr('text-anchor', 'middle')\n          .attr('dominant-baseline', 'middle')\n          .attr('x', (d) => d.x)\n          .attr('y', (d) => d.y)\n          // 移除旋轉以簡化碰撞判定\n          .text((d) => d.text)\n          .on('mouseover', function (event, d) {\n            // 懸停效果\n            d3.select(this).style('fill', 'var(--my-color-red)');\n\n            // 顯示 tooltip\n            const tooltip = d3\n              .select('body')\n              .append('div')\n              .attr('class', 'word-cloud-tooltip')\n              .style('position', 'absolute')\n              .style('background', 'rgba(0, 0, 0, 0.8)')\n              .style('color', 'white')\n              .style('padding', '8px 12px')\n              .style('border-radius', '4px')\n              .style('font-size', '12px')\n              .style('pointer-events', 'none')\n              .style('z-index', '1000');\n\n            tooltip.html(`\n              <div><strong>${d.text}</strong></div>\n              <div>委托案件數: ${d.count.toLocaleString()}</div>\n              <div>平均金額: ${Math.round(d.budget).toLocaleString()}(千元)</div>\n            `);\n          })\n          .on('mousemove', function (event) {\n            // 跟隨滑鼠移動 tooltip\n            d3.select('.word-cloud-tooltip')\n              .style('left', event.pageX + 10 + 'px')\n              .style('top', event.pageY - 10 + 'px');\n          })\n          .on('mouseout', function (event, d) {\n            // 恢復原始狀態\n            d3.select(this).style('font-size', `${d.size}px`).style('fill', d.color);\n\n            // 移除 tooltip\n            d3.select('.word-cloud-tooltip').remove();\n          });\n      };\n\n      // ==================== 生命週期鉤子 (Lifecycle Hooks) ====================\n      // 本區域包含 Vue 組件的生命週期管理函數，負責組件的初始化、數據載入、\n      // 圖表渲染和清理工作。這些鉤子確保組件在不同生命週期階段的正確行為。\n\n      /**\n       * 組件掛載生命週期鉤子\n       *\n       * 功能說明：\n       * 在組件 DOM 掛載完成後執行的初始化邏輯，這是組件生命週期中最關鍵的階段。\n       * 負責載入所有必要的數據、初始化各種圖表組件，並確保整個分析系統\n       * 能夠正常運行。這個鉤子使用異步處理，確保數據載入的完整性和可靠性。\n       *\n       * 執行流程設計：\n       * 1. 數據載入階段：從 dataStore 載入所有必要的數據源\n       *    - 主管機關數據：包含基本信息和統計數據\n       *    - 執行單位數據：包含單位信息和地理位置\n       *    - 映射關係數據：主管機關與執行單位的合作關係\n       *    - 地理位置數據：執行單位的座標信息\n       *\n       * 2. DOM 更新等待：使用 nextTick 確保 Vue 的響應式更新完成\n       *    - 等待模板渲染完成\n       *    - 確保所有 DOM 容器都已準備就緒\n       *    - 避免在容器未準備好時進行圖表渲染\n       *\n       * 3. 圖表初始化階段：按順序初始化各種視覺化組件\n       *    - 主圖表：主管機關委托案件數統計圖表\n       *    - 小圖表：12個主管機關下屬執行單位分析圖表\n       *    - 地圖：台灣地圖上的學術單位分布\n       *    - 網絡圖：主管機關與執行單位的關係網絡\n       *\n       * 4. 錯誤處理和調試：提供詳細的載入狀態信息和錯誤處理\n       *    - 記錄載入過程中的關鍵信息\n       *    - 輸出數據統計信息，便於問題診斷\n       *    - 處理載入失敗的情況，提供用戶友好的錯誤提示\n       *\n       * 技術特點：\n       * - 異步處理：使用 async/await 確保數據載入的順序性和可靠性\n       * - 錯誤處理：完善的錯誤捕獲和處理機制\n       * - 性能優化：並行載入數據源，提升載入速度\n       * - 狀態管理：與 Pinia store 緊密集成，實現數據的統一管理\n       */\n      onMounted(async () => {\n        // 開發調試信息：記錄組件初始化開始\n        // eslint-disable-next-line no-console\n        console.log('案件數統計頁面已初始化');\n\n        // 數據載入階段：從 dataStore 載入所有必要的數據\n        // await: 等待異步操作完成，確保數據準備就緒\n        // loadAllData(): dataStore 中的方法，載入主管機關、執行單位等所有數據\n        await dataStore.loadAllData();\n\n        // 開發調試信息：輸出載入狀態資訊，協助問題診斷\n        // eslint-disable-next-line no-console\n        console.log('資料載入狀態:', {\n          // 原始主管機關數據的數量\n          主管機關數量: dataStore.supervisorAgencies.length,\n          // 主管機關與執行單位映射關係的數量\n          映射資料數量: dataStore.supervisorExecutingMapping.length,\n          // 經過處理的前N名主管機關數量\n          前十名主管機關: dataStore.getTopSupervisorAgencies.length,\n          // 當前載入狀態（布林值）\n          載入中: dataStore.loading,\n          // 載入過程中的錯誤信息（如果有）\n          錯誤: dataStore.error,\n        });\n\n        // DOM 更新等待：確保 Vue 的響應式更新完成後再進行 DOM 操作\n        // nextTick(): Vue 3 提供的方法，等待下一個 DOM 更新週期\n        // 這確保所有的模板渲染和條件顯示都已完成，DOM 容器已準備就緒\n        const redrawAll = () => {\n          // 主圖表初始化：創建配置對象並調用繪圖函數\n          const mainChartConfig = {\n            // DOM 容器 ID：對應模板中的主圖表容器\n            containerId: 'main-chart',\n            // 圖表數據：調用數據準備函數獲取前8名主管機關數據\n            data: prepareMainChartData(),\n            // Y 軸標籤：根據用戶需求，設為空字串不顯示\n            yAxisLabel: '',\n            // 提高主圖高度：bar 區 320、容器總高 480（原本 160/320）\n            getChartHeight: () => 320,\n            getContainerHeight: () => 480,\n          };\n          // 調用主圖表繪製函數：使用配置對象創建主統計圖表\n          drawChart(mainChartConfig);\n\n          // 調用小圖表批次繪製函數：為每個主管機關創建執行單位圖表\n          drawSupervisorCharts();\n\n          // 調用地圖初始化函數：創建台灣地圖並添加學術單位標記\n          initMap();\n\n          // 調用關係圖繪製函數：創建主管機關與執行單位的網絡關係圖\n          drawNetworkGraph();\n\n          // 調用文字雲繪製函數：創建學術單位案件數文字雲\n          drawWordCloud();\n        };\n\n        nextTick(() => {\n          redrawAll();\n          let resizeTimer = null;\n          const onResize = () => {\n            if (resizeTimer) clearTimeout(resizeTimer);\n            resizeTimer = setTimeout(() => {\n              // 清空主要容器避免重疊\n              d3.select('#main-chart').selectAll('*').remove();\n              redrawAll();\n            }, 200);\n          };\n          window.addEventListener('resize', onResize);\n          CaseCount_onResize = onResize;\n        });\n      });\n\n      /**\n       * 組件卸載生命週期鉤子\n       *\n       * 功能說明：\n       * 在組件從 DOM 中移除前執行的清理工作，這是組件生命週期的最後階段。\n       * 負責清理組件運行過程中創建的各種資源，防止記憶體洩漏和 DOM 污染，\n       * 確保組件能夠安全地卸載，並且不會影響其他組件或頁面的正常運行。\n       *\n       * 清理工作的重要性：\n       * 1. 記憶體管理：清理 D3.js 創建的大型數據結構和事件監聽器\n       * 2. DOM 清理：移除可能殘留在全域範圍的 DOM 元素\n       * 3. 事件清理：解除事件綁定，防止事件監聽器洩漏\n       * 4. 資源釋放：釋放圖表相關的計算資源和緩存\n       *\n       * 清理策略設計：\n       * - 主動清理：在組件卸載時主動清理所有創建的資源\n       * - 選擇性清理：針對特定的元素類別進行清理，避免影響其他組件\n       * - 安全清理：使用 try-catch 包裝清理邏輯，確保清理過程不會出錯\n       * - 完整性檢查：清理完成後進行檢查，確保沒有遺漏的資源\n       *\n       * 注意事項：\n       * 由於在圖表重繪時使用了 selectAll('*').remove()，大部分 DOM 元素的\n       * 清理工作已經在重繪過程中自動完成。這個鉤子主要負責清理那些可能\n       * 殘留在全域範圍或需要特殊處理的資源。\n       */\n      let CaseCount_onResize = null;\n      onUnmounted(() => {\n        // 清理 D3.js 創建的全域圖表標籤元素\n        // selectAll('.bar-label'): 選擇所有具有 'bar-label' 類別的元素\n        // remove(): 從 DOM 中移除選中的元素，釋放記憶體\n        // 這確保組件卸載時不會留下孤立的 DOM 元素\n        d3.selectAll('.bar-label').remove();\n\n        // 清理網絡圖的 tooltip 元素，避免記憶體洩漏\n        d3.selectAll('.network-tooltip').remove();\n\n        // 清理文字雲的 tooltip 元素，避免記憶體洩漏\n        d3.selectAll('.word-cloud-tooltip').remove();\n        if (CaseCount_onResize) window.removeEventListener('resize', CaseCount_onResize);\n      });\n\n      // ==================== 返回對象 (Return Object) ====================\n      // 在 Vue 3 Composition API 中，setup 函數必須返回一個對象，\n      // 這個對象包含模板中需要使用的所有響應式數據、計算屬性和方法。\n      // 返回的對象會與模板進行響應式綁定，當數據變化時，模板會自動更新。\n\n      return {\n        // 數據管理 Store 實例\n        // 提供給模板使用的 Pinia store 實例，包含所有數據載入、處理和狀態管理功能\n        // 模板可以通過 dataStore.loading、dataStore.supervisorAgencies 等方式訪問數據狀態\n        dataStore,\n\n        // 調試信息計算屬性\n        // 提供給模板的調試和狀態顯示數據，包含載入狀態、錯誤信息、數據統計等關鍵信息\n        // 用於模板中的條件渲染，顯示載入中、錯誤或數據狀態\n        debugInfo,\n\n        // 主管機關小圖表數據計算屬性\n        // 提供前12名主管機關的圖表配置數據，每個主管機關對應一個小圖表\n        // 模板中的 v-for 指令使用此數據來動態生成12個小圖表，顯示各機關的執行單位分布\n        getSupervisorChartsData,\n        exportContainerSvgAsPng,\n      };\n    }, // setup 函數結束\n  }; // Vue 組件配置對象結束\n</script>\n\n<template>\n  <div class=\"case-count-container\">\n    <div class=\"w-100 px-3\">\n      <div class=\"row\">\n        <div class=\"col-6\">\n          <div class=\"chart-container my-bgcolor-white rounded-4 border py-3 position-relative\">\n            <button\n              class=\"btn btn-sm btn-outline-secondary position-absolute\"\n              style=\"\n                top: 8px;\n                right: 8px;\n                z-index: 2;\n                color: var(--my-color-gray-400);\n                border-color: var(--my-color-gray-400);\n              \"\n              title=\"下載 PNG\"\n              @click=\"exportContainerSvgAsPng('main-chart', '案件數_主圖表.png')\"\n            >\n              <i class=\"fa-solid fa-download\"></i>\n            </button>\n            <div class=\"d-flex justify-content-center my-title-md-black\">\n              主管機關委托案件數統計 (前12名)\n            </div>\n            <div v-if=\"debugInfo.error\" class=\"alert alert-danger mb-3\">\n              載入錯誤：{{ debugInfo.error }}\n            </div>\n            <div v-if=\"debugInfo.loading\" class=\"text-center text-muted mb-3\">載入中...</div>\n\n            <div\n              v-if=\"!debugInfo.hasData && !debugInfo.loading && !debugInfo.error\"\n              class=\"text-center text-muted mb-3\"\n            >\n              無資料\n            </div>\n\n            <div id=\"main-chart\" style=\"min-height: 480px\"></div>\n          </div>\n        </div>\n\n        <div class=\"col-6\">\n          <div class=\"chart-container my-bgcolor-white rounded-4 border pt-3\">\n            <div class=\"d-flex justify-content-center my-title-md-black pb-3\">\n              學術單位案件數分布\n            </div>\n            <div id=\"taiwan-map\" style=\"height: 480px; border-radius: 0 0 1rem 1rem\"></div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"row\">\n        <div v-for=\"chartData in getSupervisorChartsData\" :key=\"chartData.id\" class=\"col-3 mt-4\">\n          <div class=\"chart-container my-bgcolor-white rounded-4 border py-3 position-relative\">\n            <button\n              class=\"btn btn-sm btn-outline-secondary position-absolute\"\n              style=\"\n                top: 8px;\n                right: 8px;\n                z-index: 2;\n                color: var(--my-color-gray-400);\n                border-color: var(--my-color-gray-400);\n              \"\n              title=\"下載 PNG\"\n              @click=\"exportContainerSvgAsPng(chartData.id, chartData.title + '_小圖表.png')\"\n            >\n              <i class=\"fa-solid fa-download\"></i>\n            </button>\n            <div class=\"d-flex justify-content-center my-title-md-black\">\n              {{ chartData.title }}\n            </div>\n            <div :id=\"chartData.id\" style=\"min-height: 320px\"></div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"row\">\n        <div class=\"col-12 mt-4\">\n          <div class=\"my-bgcolor-white rounded-4 border p-3 position-relative\">\n            <button\n              class=\"btn btn-sm btn-outline-secondary position-absolute\"\n              style=\"\n                top: 8px;\n                right: 8px;\n                z-index: 2;\n                color: var(--my-color-gray-400);\n                border-color: var(--my-color-gray-400);\n              \"\n              title=\"下載 PNG\"\n              @click=\"exportContainerSvgAsPng('network-graph', '案件數_關係圖.png')\"\n            >\n              <i class=\"fa-solid fa-download\"></i>\n            </button>\n            <div class=\"d-flex justify-content-center my-title-md-black mb-3\">\n              主管機關與執行單位關係網絡圖\n            </div>\n\n            <div id=\"network-graph\" style=\"height: 600px; width: 100%\"></div>\n          </div>\n        </div>\n      </div>\n\n      <!-- 文字雲獨立框 -->\n      <div class=\"row\">\n        <div class=\"col-12 mt-4\">\n          <div class=\"my-bgcolor-white rounded-4 border p-3\">\n            <div class=\"d-flex justify-content-center my-title-md-black mb-3\">\n              學術單位案件數文字雲\n            </div>\n            <div id=\"word-cloud\" style=\"height: 400px; width: 100%\"></div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n  /* 使用Bootstrap和common.css的樣式，高度設定使用內聯style */\n</style>\n","/**\n * 雲林縣研究案統計分析平台 - 數據管理 Store\n *\n * 功能概述：\n * 使用 Pinia 管理應用程式的全局數據狀態，提供統一的數據存取、處理和計算介面。\n * 作為整個應用程式的數據中心，負責所有數據的載入、轉換、存儲和分發工作。\n *\n * 核心職責：\n * 1. 數據載入管理：異步載入多個 JSON 數據源，處理載入狀態和錯誤情況\n * 2. 數據轉換處理：將原始 JSON 數據轉換為應用程式所需的標準化格式\n * 3. 數據計算統計：提供各種統計計算、排序和過濾功能\n * 4. 狀態同步管理：確保所有組件都能及時獲取到最新的數據狀態\n * 5. 性能優化：實現數據緩存、懶加載和並行載入等優化策略\n *\n * 數據源管理：\n * - 執行單位數據（執行單位名稱_normalize.json）：包含單位基本信息和統計數據\n * - 主管機關數據（計畫主管機關_normalize.json）：包含機關基本信息和統計數據\n * - 映射關係數據（執行單位名稱_normalize_&_計畫主管機關_normalize.json）：機關與單位的合作關係\n * - 地理位置數據（執行單位名稱_locations.json）：單位的經緯度座標信息\n *\n * 技術特點：\n * - 響應式數據：使用 Vue 3 的 ref 和 computed 實現響應式數據綁定\n * - 異步處理：支持並行載入多個數據源，提升載入性能\n * - 錯誤處理：完善的錯誤捕獲、記錄和用戶友好的錯誤提示\n * - 數據驗證：載入後進行數據完整性檢查和格式驗證\n * - 記憶體管理：及時清理無用的數據引用，防止記憶體洩漏\n *\n * 架構設計：\n * - 單一數據源：所有組件都從這個 store 獲取數據，確保數據一致性\n * - 計算屬性：使用 computed 實現數據的派生計算，避免重複計算\n * - 模組化設計：按功能模組組織數據和方法，便於維護和擴展\n * - 類型安全：雖然使用 JavaScript，但通過 JSDoc 註解提供類型信息\n */\n\nimport { defineStore } from 'pinia';\nimport { ref, computed } from 'vue';\n\nexport const useDataStore = defineStore('data', () => {\n  // ==================== 響應式狀態定義 (Reactive State Definitions) ====================\n  // 本區域定義了 store 中所有的響應式狀態變數，這些變數會自動觸發\n  // 依賴它們的計算屬性和組件的重新渲染。每個狀態變數都使用 ref() 包裝，\n  // 確保在組件中使用時能夠正確地建立響應式連接。\n\n  /**\n   * 執行單位數據陣列\n   * 結構：[{ name: string, 委托案件數: number, 所有相符資料_JSON: number }, ...]\n   */\n  const executingUnits = ref([]);\n\n  /**\n   * 主管機關數據陣列\n   * 結構：[{ name: string, 委托案件數: number, 所有相符資料_JSON: number }, ...]\n   */\n  const supervisorAgencies = ref([]);\n\n  /**\n   * 主管機關-執行單位映射數據陣列\n   * 結構：[{ name: string, name_sub: string, 委托案件數: number, 所有相符資料_JSON: number }, ...]\n   * name: 主管機關名稱, name_sub: 執行單位名稱\n   */\n  const supervisorExecutingMapping = ref([]);\n\n  /**\n   * 執行單位地理位置數據陣列\n   * 結構：[{ name: string, lat: number, lng: number }, ...]\n   */\n  const executingUnitsLocations = ref([]);\n\n  /** 數據載入狀態標記 */\n  const loading = ref(false);\n\n  /** 錯誤訊息，null 表示無錯誤 */\n  const error = ref(null);\n\n  // ==================== 計算屬性 (Computed Properties / Getters) ====================\n  // 本區域包含所有基於響應式狀態計算得出的派生數據，這些計算屬性具有\n  // 緩存特性，只有當依賴的狀態變化時才會重新計算，大大提升了性能。\n  // 每個計算屬性都提供特定的數據視圖，滿足不同組件的數據需求。\n\n  /**\n   * 獲取前10名執行單位（按案件數排序）\n   *\n   * 功能說明：\n   * 基於執行單位的委托案件數進行排序，返回案件數最多的前10名執行單位。\n   * 這個計算屬性主要用於案件數統計頁面，幫助用戶快速識別最活躍的執行單位。\n   *\n   * 排序邏輯：\n   * 1. 按委托案件數降序排列（從高到低）\n   * 2. 取前10名單位，確保返回結果的數量可控\n   * 3. 創建數據副本，避免修改原始數據\n   *\n   * 數據結構：\n   * 返回的每個執行單位對象包含：\n   * - name: 執行單位名稱\n   * - 委托案件數: 該單位的案件總數\n   * - 所有相符資料_JSON: 該單位的平均預算金額\n   * - 學術單位: 是否為學術單位的標記\n   *\n   * 使用場景：\n   * - 案件數統計頁面的執行單位排名展示\n   * - 主管機關下屬執行單位的案件數分析\n   * - 執行單位活躍度的快速評估\n   *\n   * 性能特點：\n   * - 使用 computed 緩存，只有當 executingUnits 變化時才重新計算\n   * - 排序操作在數據副本上進行，不影響原始數據\n   *\n   * @returns {ComputedRef<Array>} 排序後的前10名執行單位陣列\n   */\n  const getTopExecutingUnits = computed(() => {\n    return executingUnits.value\n      .slice() // 創建副本避免修改原始資料\n      .sort((a, b) => b.委托案件數 - a.委托案件數) // 按案件數降序排列\n      .slice(0, 10); // 取前10名\n  });\n\n  /**\n   * 獲取前10名執行單位（按平均預算排序）\n   *\n   * 功能說明：\n   * 基於執行單位的平均預算金額進行排序，返回預算金額最高的前10名執行單位。\n   * 這個計算屬性主要用於平均金額統計頁面，幫助用戶理解資金分配模式。\n   *\n   * 排序邏輯：\n   * 1. 按平均預算金額降序排列（從高到低）\n   * 2. 取前10名單位，確保返回結果的數量可控\n   * 3. 創建數據副本，避免修改原始數據\n   *\n   * 數據結構：\n   * 返回的每個執行單位對象包含：\n   * - name: 執行單位名稱\n   * - 委托案件數: 該單位的案件總數\n   * - 所有相符資料_JSON: 該單位的平均預算金額\n   * - 學術單位: 是否為學術單位的標記\n   *\n   * 與案件數排序的區別：\n   * - 排序依據：使用平均預算金額而非案件數量\n   * - 分析重點：關注資金分配效率而非業務活躍度\n   * - 應用場景：主要用於預算分析和資金流向研究\n   *\n   * 使用場景：\n   * - 平均金額統計頁面的執行單位排名展示\n   * - 主管機關下屬執行單位的預算分布分析\n   * - 執行單位資金使用效率的評估\n   *\n   * 性能特點：\n   * - 使用 computed 緩存，只有當 executingUnits 變化時才重新計算\n   * - 排序操作在數據副本上進行，不影響原始數據\n   *\n   * @returns {ComputedRef<Array>} 按預算排序的前10名執行單位陣列\n   */\n  const getExecutingUnitsByBudget = computed(() => {\n    return executingUnits.value\n      .slice() // 創建副本避免修改原始資料\n      .sort((a, b) => b.所有相符資料_JSON - a.所有相符資料_JSON) // 按平均預算降序排列\n      .slice(0, 10); // 取前10名\n  });\n\n  /**\n   * 計算所有執行單位的總案件數\n   *\n   * 功能說明：\n   * 統計所有執行單位的委托案件數總和，提供整個系統的案件總量指標。\n   * 這個計算屬性用於概覽頁面和統計摘要，幫助用戶了解研究案的整體規模。\n   *\n   * 計算邏輯：\n   * 1. 遍歷所有執行單位數據\n   * 2. 累加每個單位的委托案件數\n   * 3. 返回總案件數的數值\n   *\n   * 數據處理：\n   * - 使用 reduce 方法進行累加計算，性能優化\n   * - 自動處理空數據情況，返回 0 而不是 NaN\n   * - 支持實時更新，當執行單位數據變化時自動重新計算\n   *\n   * 使用場景：\n   * - 概覽頁面的總案件數顯示\n   * - 統計摘要和報表生成\n   * - 系統規模的快速評估\n   * - 與其他指標的對比分析\n   *\n   * 性能特點：\n   * - 使用 computed 緩存，只有當 executingUnits 變化時才重新計算\n   * - 單次遍歷完成計算，時間複雜度為 O(n)\n   *\n   * @returns {ComputedRef<number>} 所有執行單位的總案件數\n   */\n  const getTotalCount = computed(() => {\n    return executingUnits.value.reduce((sum, unit) => sum + unit.委托案件數, 0);\n  });\n\n  /**\n   * 計算所有執行單位的平均預算\n   *\n   * 功能說明：\n   * 計算所有執行單位的平均預算金額，提供整個系統的預算水平指標。\n   * 這個計算屬性用於預算分析和資金效率評估，幫助用戶了解研究案的資金分配情況。\n   *\n   * 計算邏輯：\n   * 1. 檢查是否有可用的執行單位數據\n   * 2. 計算所有單位的預算總和\n   * 3. 除以單位數量得到平均值\n   * 4. 處理空數據情況，返回 0\n   *\n   * 數據處理：\n   * - 使用 reduce 方法累加所有預算金額\n   * - 自動處理空數據情況，避免除以零的錯誤\n   * - 支持實時更新，當執行單位數據變化時自動重新計算\n   *\n   * 與總案件數的區別：\n   * - 計算維度：關注預算金額而非案件數量\n   * - 分析重點：資金分配效率而非業務規模\n   * - 應用場景：主要用於預算分析和資金流向研究\n   *\n   * 使用場景：\n   * - 概覽頁面的平均預算顯示\n   * - 預算分析和資金效率評估\n   * - 與其他指標的對比分析\n   * - 系統資金水平的快速評估\n   *\n   * 性能特點：\n   * - 使用 computed 緩存，只有當 executingUnits 變化時才重新計算\n   * - 單次遍歷完成計算，時間複雜度為 O(n)\n   *\n   * @returns {ComputedRef<number>} 所有執行單位的平均預算金額，若無資料則返回 0\n   */\n  const getAverageBudget = computed(() => {\n    if (executingUnits.value.length === 0) return 0;\n    const totalBudget = executingUnits.value.reduce((sum, unit) => sum + unit.所有相符資料_JSON, 0);\n    return totalBudget / executingUnits.value.length;\n  });\n\n  /**\n   * 獲取前12名主管機關（按案件數排序）\n   * @returns {ComputedRef<Array>} 排序後的前12名主管機關陣列\n   */\n  const getTopSupervisorAgencies = computed(() => {\n    return supervisorAgencies.value\n      .slice() // 創建副本避免修改原始資料\n      .sort((a, b) => b.委托案件數 - a.委托案件數) // 按案件數降序排列\n      .slice(0, 12); // 取前12名\n  });\n\n  /**\n   * 獲取前12名主管機關（按平均預算排序）\n   * @returns {ComputedRef<Array>} 按平均預算排序後的前12名主管機關陣列\n   */\n  const getTopSupervisorAgenciesByBudget = computed(() => {\n    return supervisorAgencies.value\n      .slice() // 創建副本避免修改原始資料\n      .sort((a, b) => b.本期經費平均_千元 - a.本期經費平均_千元) // 按平均預算降序排列\n      .slice(0, 12); // 取前12名\n  });\n\n  // ==================== 輔助函數 ====================\n\n  /**\n   * 獲取指定主管機關下的前10名執行單位\n   * @param {string} agencyName - 主管機關名稱\n   * @returns {Array} 該主管機關下的執行單位陣列（最多10個）\n   */\n  const getAgencySubUnits = (agencyName) => {\n    // 過濾出該主管機關的所有執行單位記錄\n    const subUnits = supervisorExecutingMapping.value\n      .filter((record) => record.name === agencyName)\n      .sort((a, b) => b.委托案件數 - a.委托案件數) // 按案件數降序排列\n      .slice(0, 10); // 限制最多10個\n\n    return subUnits;\n  };\n\n  /**\n   * 獲取指定主管機關下的前10名執行單位（按平均預算排序）\n   * @param {string} agencyName - 主管機關名稱\n   * @returns {Array} 該主管機關下的執行單位陣列（最多10個）\n   */\n  const getAgencySubUnitsByBudget = (agencyName) => {\n    // 過濾出該主管機關的所有執行單位記錄\n    const subUnits = supervisorExecutingMapping.value\n      .filter((record) => record.name === agencyName)\n      .sort((a, b) => b.本期經費平均_千元 - a.本期經費平均_千元) // 按平均預算降序排列\n      .slice(0, 10); // 限制最多10個\n\n    return subUnits;\n  };\n\n  /**\n   * 為前12名主管機關獲取其下屬執行單位資料\n   * @returns {ComputedRef<Array>} 包含主管機關及其執行單位的完整資料陣列\n   */\n  const getTop10AgenciesWithSubUnits = computed(() => {\n    const top12Agencies = getTopSupervisorAgencies.value;\n\n    return top12Agencies.map((agency) => {\n      const subUnits = getAgencySubUnits(agency.name);\n\n      // 輸出除錯資訊到控制台\n      // eslint-disable-next-line no-console\n      console.log(`主管機關: ${agency.name} -> 執行單位數: ${subUnits.length}`);\n\n      return {\n        ...agency, // 展開主管機關的原始屬性\n        subUnits: subUnits, // 添加該主管機關下的執行單位陣列\n      };\n    });\n  });\n\n  /**\n   * 為前12名主管機關（按平均預算排序）獲取其下屬執行單位資料\n   * @returns {ComputedRef<Array>} 包含主管機關及其執行單位的完整資料陣列\n   */\n  const getTop10AgenciesWithSubUnitsByBudget = computed(() => {\n    const top12Agencies = getTopSupervisorAgenciesByBudget.value;\n\n    return top12Agencies.map((agency) => {\n      const subUnits = getAgencySubUnitsByBudget(agency.name);\n\n      // 輸出除錯資訊到控制台\n      // eslint-disable-next-line no-console\n      console.log(`主管機關: ${agency.name} -> 執行單位數: ${subUnits.length}`);\n\n      return {\n        ...agency, // 展開主管機關的原始屬性\n        subUnits: subUnits, // 添加該主管機關下的執行單位陣列\n      };\n    });\n  });\n\n  /**\n   * 獲取學術單位（\"學術單位\":\"TRUE\"）的執行單位，並結合地理位置和預算數據\n   * @returns {ComputedRef<Array>} 包含地理位置的學術單位執行單位陣列\n   */\n  const getUniversityExecutingUnitsWithLocation = computed(() => {\n    // 直接從執行單位數據中過濾出學術單位\n    const universityUnits = executingUnits.value.filter((unit) => unit.學術單位 === 'TRUE');\n\n    // 將預算數據與地理位置數據結合\n    return universityUnits\n      .map((unit) => {\n        const location = executingUnitsLocations.value.find((loc) => loc.name === unit.name);\n        return {\n          ...unit,\n          lat: location?.lat || null,\n          lng: location?.lng || null,\n          hasLocation: !!(location?.lat && location?.lng),\n        };\n      })\n      .filter((unit) => unit.hasLocation); // 只返回有地理位置的單位\n  });\n\n  // ==================== 異步操作（Actions）====================\n\n  /**\n   * 載入主管機關數據\n   * 從 public/data/計畫主管機關_normalize.json 載入資料\n   */\n  const loadSupervisorAgencies = async () => {\n    try {\n      // 發送 HTTP 請求載入 JSON 資料\n      const response = await fetch('./data/計畫主管機關_normalize.json');\n\n      // 檢查 HTTP 回應狀態\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n\n      // 解析 JSON 資料\n      const data = await response.json();\n\n      // 將 JSON 欄位名稱映射到代碼中使用的欄位名稱\n      const mappedData = data.map((item) => ({\n        name: item['計畫主管機關_normalize'], // 映射計畫主管機關_normalize 到 name\n        委托案件數: item['委托案件數'],\n        所有相符資料_JSON: item['所有相符資料_JSON'],\n        學術單位: item['學術單位'],\n        本期經費總合_千元: item['本期經費總合_千元'],\n        本期經費平均_千元: item['本期經費平均_千元'],\n      }));\n\n      // 更新響應式狀態\n      supervisorAgencies.value = mappedData;\n\n      // 輸出載入成功資訊\n      // eslint-disable-next-line no-console\n      console.log('主管機關資料載入成功:', mappedData.length, '筆資料');\n      // eslint-disable-next-line no-console\n      console.log('前5名主管機關:', mappedData.slice(0, 5));\n    } catch (err) {\n      // 處理載入錯誤\n      // eslint-disable-next-line no-console\n      console.error('載入主管機關資料失敗:', err);\n      error.value = err.message;\n    }\n  };\n\n  /**\n   * 載入主管機關-執行單位映射數據\n   * 從 public/data/執行單位名稱_normalize_&_計畫主管機關_normalize.json 載入資料\n   */\n  const loadSupervisorExecutingMapping = async () => {\n    try {\n      // 發送 HTTP 請求載入 JSON 資料\n      const response = await fetch('./data/執行單位名稱_normalize_&_計畫主管機關_normalize.json');\n\n      // 檢查 HTTP 回應狀態\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n\n      // 解析 JSON 資料\n      const data = await response.json();\n\n      // 將 JSON 欄位名稱映射到代碼中使用的欄位名稱\n      const mappedData = data.map((item) => ({\n        name: item['計畫主管機關_normalize'], // 映射計畫主管機關_normalize 到 name\n        name_sub: item['執行單位名稱_normalize'], // 映射執行單位名稱_normalize 到 name_sub\n        委托案件數: item['委托案件數'],\n        所有相符資料_JSON: item['所有相符資料_JSON'],\n        本期經費總合_千元: item['本期經費總合_千元'],\n        本期經費平均_千元: item['本期經費平均_千元'],\n      }));\n\n      // 更新響應式狀態\n      supervisorExecutingMapping.value = mappedData;\n\n      // 輸出載入成功資訊\n      // eslint-disable-next-line no-console\n      console.log('主管機關-執行單位映射資料載入成功:', mappedData.length, '筆資料');\n    } catch (err) {\n      // 處理載入錯誤\n      // eslint-disable-next-line no-console\n      console.error('載入主管機關-執行單位映射資料失敗:', err);\n      error.value = err.message;\n    }\n  };\n\n  /**\n   * 載入執行單位數據（包含平均金額）\n   * 從 public/data/執行單位名稱_normalize.json 載入資料\n   */\n  const loadExecutingUnits = async () => {\n    try {\n      // 發送 HTTP 請求載入 JSON 資料\n      const response = await fetch('./data/執行單位名稱_normalize.json');\n\n      // 檢查 HTTP 回應狀態\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n\n      // 解析 JSON 資料\n      const data = await response.json();\n\n      // 將 JSON 欄位名稱映射到代碼中使用的欄位名稱\n      const mappedData = data.map((item) => ({\n        name: item['執行單位名稱_normalize'], // 映射執行單位名稱_normalize 到 name\n        委托案件數: item['委托案件數'],\n        所有相符資料_JSON: item['所有相符資料_JSON'],\n        本期經費總合_千元: item['本期經費總合_千元'],\n        本期經費平均_千元: item['本期經費平均_千元'],\n        學術單位: item['學術單位'], // 載入學術單位字段\n      }));\n\n      // 更新響應式狀態\n      executingUnits.value = mappedData;\n\n      // 輸出載入成功資訊\n      // eslint-disable-next-line no-console\n      console.log('執行單位資料載入成功:', mappedData.length, '筆資料');\n\n      // 輸出包含學術單位的單位數量\n      const universityCount = mappedData.filter(\n        (unit) => unit.name.includes('大學') || unit.name.includes('學院')\n      ).length;\n      // eslint-disable-next-line no-console\n      console.log('包含學術單位的執行單位數量:', universityCount);\n    } catch (err) {\n      // 處理載入錯誤\n      // eslint-disable-next-line no-console\n      console.error('載入執行單位資料失敗:', err);\n      error.value = err.message;\n    }\n  };\n\n  /**\n   * 載入執行單位地理位置數據\n   * 從 public/data/執行單位名稱_locations.json 載入資料\n   */\n  const loadExecutingUnitsLocations = async () => {\n    try {\n      // 發送 HTTP 請求載入 JSON 資料\n      const response = await fetch('./data/執行單位名稱_locations.json');\n\n      // 檢查 HTTP 回應狀態\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n\n      // 解析 JSON 資料\n      const data = await response.json();\n\n      // 更新響應式狀態\n      executingUnitsLocations.value = data;\n\n      // 輸出載入成功資訊\n      // eslint-disable-next-line no-console\n      console.log('執行單位地理位置資料載入成功:', data.length, '筆資料');\n    } catch (err) {\n      // 處理載入錯誤\n      // eslint-disable-next-line no-console\n      console.error('載入執行單位地理位置資料失敗:', err);\n      error.value = err.message;\n    }\n  };\n\n  /**\n   * 載入所有必要的數據\n   * 並行載入所有數據源以提升性能\n   */\n  const loadAllData = async () => {\n    // 設置載入狀態\n    loading.value = true;\n    error.value = null;\n\n    try {\n      // 並行載入多個數據源以提升載入速度\n      await Promise.all([\n        loadSupervisorAgencies(),\n        loadSupervisorExecutingMapping(),\n        loadExecutingUnits(),\n        loadExecutingUnitsLocations(),\n      ]);\n    } catch (err) {\n      // 處理整體載入錯誤\n      error.value = err.message;\n    } finally {\n      // 無論成功或失敗都要重置載入狀態\n      loading.value = false;\n    }\n  };\n\n  /**\n   * 搜尋執行單位\n   * @param {string} keyword - 搜尋關鍵字\n   * @returns {Array} 符合搜尋條件的執行單位陣列\n   */\n  const searchExecutingUnits = (keyword) => {\n    // 如果沒有關鍵字，返回所有資料\n    if (!keyword) return executingUnits.value;\n\n    // 進行不區分大小寫的模糊搜尋\n    return executingUnits.value.filter((unit) =>\n      unit.name.toLowerCase().includes(keyword.toLowerCase())\n    );\n  };\n\n  // ==================== 返回公開介面 ====================\n\n  return {\n    // 響應式狀態\n    executingUnits,\n    supervisorAgencies,\n    supervisorExecutingMapping,\n    executingUnitsLocations,\n    loading,\n    error,\n\n    // 計算屬性（Getters）\n    getTopExecutingUnits,\n    getExecutingUnitsByBudget,\n    getTotalCount,\n    getAverageBudget,\n    getTopSupervisorAgencies,\n    getTopSupervisorAgenciesByBudget,\n    getTop10AgenciesWithSubUnits,\n    getTop10AgenciesWithSubUnitsByBudget,\n    getUniversityExecutingUnitsWithLocation,\n\n    // 異步操作（Actions）\n    loadSupervisorAgencies,\n    loadSupervisorExecutingMapping,\n    loadExecutingUnits,\n    loadExecutingUnitsLocations,\n    loadAllData,\n    searchExecutingUnits,\n  };\n});\n","import { render } from \"./CaseCountView.vue?vue&type=template&id=47c051bf&scoped=true\"\nimport script from \"./CaseCountView.vue?vue&type=script&lang=js\"\nexport * from \"./CaseCountView.vue?vue&type=script&lang=js\"\n\nimport \"./CaseCountView.vue?vue&type=style&index=0&id=47c051bf&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-47c051bf\"]])\n\nexport default __exports__","<!--\n  平均金額統計分析視圖組件 (CaseBudgetView.vue)\n\n  功能概述：\n  本組件專門用於分析雲林縣研究案的平均金額統計，提供多維度的預算分析視覺化功能。\n  與案件數統計頁面形成互補，幫助用戶從不同角度理解研究案的資金分配模式。\n\n  主要功能模組：\n  1. 主管機關平均金額統計圖表 - 顯示前12名主管機關的平均金額排名\n  2. 學術單位平均金額分布地圖 - 台灣地圖上標記學術單位位置和平均金額\n  3. 主管機關下屬執行單位分析 - 12個小圖表顯示各機關的執行單位預算分布\n  4. 主管機關與執行單位關係網絡圖 - 力導向圖顯示基於預算的合作關係網絡\n\n  數據來源：\n  - 計畫主管機關_normalize.json：主管機關基本資料和預算統計數據\n  - 執行單位名稱_normalize.json：執行單位基本資料和預算統計數據\n  - 執行單位名稱_normalize_&_計畫主管機關_normalize.json：主管機關與執行單位的映射關係\n  - 執行單位名稱_locations.json：執行單位的地理位置座標\n\n  技術架構：\n  - Vue 3 Composition API：組件邏輯管理\n  - Pinia Store：數據狀態管理\n  - D3.js：圖表繪製和數據視覺化\n  - Leaflet.js：互動式地圖功能\n  - Bootstrap：響應式UI框架\n\n  與案件數統計頁面的區別：\n  - 數據維度：專注於預算金額而非案件數量\n  - 排序邏輯：按平均金額而非案件數進行排序\n  - 視覺編碼：圓圈大小反映預算規模而非案件數量\n  - 分析重點：幫助理解資金分配模式和預算效率\n-->\n\n<script>\n  import { computed, onMounted, onUnmounted, nextTick } from 'vue';\n  import { useDataStore } from '@/stores/dataStore';\n  import * as d3 from 'd3';\n  import L from 'leaflet';\n  import { exportContainerSvgAsPng } from '@/utils/exportImage';\n\n  export default {\n    // 組件名稱：用於 Vue DevTools 調試和組件識別\n    name: 'CaseBudgetView',\n\n    setup() {\n      const dataStore = useDataStore();\n\n      // ==================== 計算屬性 (Computed Properties) ====================\n      // 計算屬性具有響應式特性，當依賴的數據變化時會自動重新計算\n      // 同時具有緩存特性，只有依賴變化時才重新計算，提高性能\n      // 這些屬性會根據原始數據自動生成圖表所需的數據結構\n\n      /**\n       * 主管機關小圖表數據結構計算屬性\n       *\n       * 功能說明：\n       * 為前12名主管機關創建小圖表所需的數據結構，每個主管機關對應一個小圖表，\n       * 顯示該機關下屬執行單位的預算分布情況。與案件數統計頁面不同，這裡的\n       * 數據按平均金額進行排序，幫助用戶理解資金分配模式。\n       *\n       * 數據流程：\n       * 1. 從 dataStore 獲取前12名主管機關數據（按平均金額排序）\n       * 2. 為每個主管機關創建標準化的圖表配置對象\n       * 3. 返回包含12個圖表配置的陣列，供模板中的 v-for 指令使用\n       *\n       * 返回值結構：\n       * 陣列中的每個對象包含：\n       * - id: 唯一的DOM元素標識符，用於D3.js選擇器\n       * - title: 圖表顯示標題（主管機關名稱）\n       * - agencyData: 主管機關的核心統計數據（名稱、案件數、平均金額）\n       * - subUnits: 該機關下屬的執行單位列表\n       *\n       * 與案件數統計頁面的區別：\n       * - 排序依據：使用 getTop10AgenciesWithSubUnitsByBudget 而非 getTop10AgenciesWithSubUnits\n       * - 數據重點：關注預算金額而非案件數量\n       * - 視覺編碼：圖表大小反映預算規模而非案件數量\n       *\n       * 使用場景：\n       * 在模板中通過 v-for 指令動態生成12個小圖表，每個圖表顯示\n       * 一個主管機關的執行單位預算分布情況。\n       */\n      const getSupervisorChartsData = computed(() => {\n        // 從 dataStore 獲取前12名主管機關數據\n        // getTop10AgenciesWithSubUnitsByBudget: store 中的 getter，返回按平均預算排序的主管機關數據\n        // slice(0, 12): JavaScript 陣列方法，截取前12個元素\n        const top12AgenciesWithSubUnits = dataStore.getTop10AgenciesWithSubUnitsByBudget.slice(\n          0,\n          12\n        );\n\n        // 使用 map 方法轉換數據結構，為每個主管機關創建圖表配置對象\n        // map: JavaScript 陣列方法，對每個元素執行轉換函數，返回新陣列\n        // (agency, index): 回調函數參數，agency 是當前主管機關數據，index 是索引\n        return top12AgenciesWithSubUnits.map((agency, index) => ({\n          // 為每個圖表生成唯一的 DOM 元素 ID\n          // 格式：supervisor-chart-1, supervisor-chart-2, ...\n          // 用於 D3.js 選擇器定位對應的 DOM 元素\n          id: `supervisor-chart-${index + 1}`,\n\n          // 生成顯示標題，如果名稱超過8個字符則截短並加省略號\n          // 顯示完整的主管機關名稱作為標題\n          title: agency.name,\n\n          // 主管機關的完整數據對象，包含名稱、案件數、平均預算\n          agencyData: {\n            name: agency.name, // 完整主管機關名稱，未截短\n            委托案件數: agency.委托案件數, // 該主管機關的案件總數\n            所有相符資料_JSON: agency.所有相符資料_JSON, // 該主管機關的平均預算金額\n          },\n\n          // 該主管機關下的執行單位列表\n          // 使用邏輯或運算符 || 提供默認值，防止 undefined 錯誤\n          // 如果 agency.subUnits 存在則使用它，否則使用空陣列\n          subUnits: agency.subUnits || [],\n        }));\n      });\n\n      /**\n       * 調試信息計算屬性\n       *\n       * 功能說明：\n       * 提供開發階段的問題診斷和數據驗證信息，幫助開發者了解組件的運行狀態。\n       * 這些信息會顯示在模板中，用於監控數據載入狀態、錯誤信息和數據統計。\n       * 與案件數統計頁面保持一致的調試信息結構，便於問題排查和性能監控。\n       *\n       * 主要用途：\n       * 1. 數據載入狀態監控：顯示載入中、載入完成或載入失敗的狀態\n       * 2. 數據可用性檢查：確認是否有足夠的數據來渲染圖表\n       * 3. 錯誤信息顯示：當數據載入失敗時，向用戶顯示具體的錯誤原因\n       * 4. 數據量統計：顯示處理後的數據數量，用於驗證數據處理邏輯\n       *\n       * 返回值結構：\n       * 包含四個關鍵狀態指標的對象，用於模板中的條件渲染和狀態顯示\n       *\n       * 與案件數統計頁面的對應關係：\n       * - 相同的數據結構和屬性名稱\n       * - 相同的錯誤處理和狀態管理邏輯\n       * - 便於兩個頁面之間的代碼維護和功能對齊\n       */\n      const debugInfo = computed(() => ({\n        // 數據可用性檢查：判斷是否有主管機關數據\n        // 布林值：通過檢查 supervisorAgencies 陣列長度是否大於0\n        // length > 0 表示有數據，length === 0 表示無數據\n        hasData: dataStore.supervisorAgencies.length > 0,\n\n        // 篩選後數據量：前10名主管機關的數量\n        // 數字：經過篩選和排序後的前10名主管機關數量\n        // 用於驗證數據處理邏輯是否正確\n        topUnitsCount: dataStore.getTopSupervisorAgencies.length,\n\n        // 數據載入狀態：從 dataStore 獲取當前是否正在載入數據\n        // 布林值：true 表示正在載入，false 表示載入完成\n        loading: dataStore.loading,\n\n        // 錯誤信息：從 dataStore 獲取載入過程中的錯誤信息\n        // 字串或 null：有錯誤時為錯誤訊息，無錯誤時為 null\n        error: dataStore.error,\n      }));\n\n      // ==================== 圖表繪製函數 ====================\n\n      /**\n       * 通用圖表繪製函數 - 根據傳入的配置和數據繪製條形圖\n       *\n       * 功能說明：\n       * - 使用 D3.js 創建響應式 SVG 柱狀圖\n       * - 支援動態數據量（主圖表8個，小圖表3個）\n       * - 防止 bar 重疊的唯一標識符設計\n       * - 在圖表上方顯示數值標籤\n       * - 完整的座標軸和標題系統\n       *\n       * @param {Object} config - 圖表配置對象\n       * @param {string} config.containerId - DOM 容器的 ID\n       * @param {Array} config.data - 要顯示的數據陣列\n       * @param {string} config.yAxisLabel - Y 軸標籤文字\n       * @param {number} [config.containerHeight] - 容器總高度（可選）\n       * @param {() => number} [config.getContainerHeight] - 以函數返回容器總高度（可選）\n       * @param {() => number} [config.getChartHeight] - 以函數返回圖表 bar 區高度（可選）\n       */\n      const drawChart = (config) => {\n        // ==================== 初始化和清理階段 ====================\n\n        // 使用 D3.js 選擇器選取目標 DOM 容器\n        // d3.select(): D3.js 的核心方法，類似 document.querySelector()\n        // `#${config.containerId}`: 模板字串，生成 CSS 選擇器如 \"#main-chart\"\n        const container = d3.select(`#${config.containerId}`);\n\n        // 檢查容器是否存在於 DOM 中\n        // container.empty(): 檢查選擇器是否找到元素\n        // container.node(): 獲取實際的 DOM 節點\n        // 如果容器不存在，記錄錯誤並提早返回，避免後續錯誤\n        if (container.empty() || !container.node()) {\n          // eslint-disable-next-line no-console\n          console.error(`圖表容器 #${config.containerId} 不存在`);\n          return; // 提早返回，停止函數執行\n        }\n\n        // 清除容器內的所有舊元素，防止重複渲染造成的視覺重疊\n        // selectAll('*'): 選擇容器內的所有子元素\n        // remove(): D3.js 方法，從 DOM 中移除選中的元素\n        container.selectAll('*').remove();\n\n        // ==================== 數據準備階段 ====================\n\n        // 從配置對象中提取圖表數據\n        // config.data: 包含要顯示的數據陣列，每個元素包含 name 和 value 屬性\n        const chartData = config.data;\n\n        // 從配置對象中提取 Y 軸標籤文字（現已移除Y軸標籤顯示）\n        // config.yAxisLabel: 字串，原用於顯示在 Y 軸旁邊，現在不再使用\n\n        // 數據有效性檢查：確保數據已載入且不為空\n        // !chartData: 檢查數據是否為 null 或 undefined\n        // chartData.length === 0: 檢查數據陣列是否為空\n        // 如果數據無效，顯示載入中提示並提早返回\n        if (!chartData || chartData.length === 0) {\n          // 在容器中創建載入中提示元素\n          container\n            .append('div') // 添加一個 div 元素\n            .attr('class', 'd-flex align-items-center justify-content-center h-100') // Bootstrap 類別：垂直水平置中，高度100%\n            .style('color', '#666') // 設定文字顏色為灰色\n            .text('載入中...'); // 設定提示文字\n          return; // 提早返回，停止函數執行\n        }\n\n        // ==================== 圖表尺寸設定階段 ====================\n\n        // 動態獲取容器的實際寬度，實現響應式設計\n        // getBoundingClientRect(): 瀏覽器 API，獲取元素的位置和尺寸信息\n        // .width: 提取寬度屬性，單位為像素\n        const containerWidth = container.node().getBoundingClientRect().width;\n\n        // 設定容器高度：優先使用函數回傳，否則使用傳入數值或預設320\n        const containerHeight =\n          (typeof config.getContainerHeight === 'function'\n            ? config.getContainerHeight()\n            : config.containerHeight) || 320;\n\n        // 設定圖表的內邊距（margin），實現滿版顯示效果\n        // 使用傳入的邊距設定，如果沒有傳入則使用滿版默認值\n        // ||: 邏輯或運算符，提供默認配置對象\n        const margin = config.margin || {\n          top: 16, // 頂部邊距：為數值標籤預留最小空間\n          right: 0, // 右側邊距：設為0實現右邊滿版\n          bottom: 160, // 底部邊距：為X軸垂直文字預留160px空間\n          left: 56, // 左側邊距：固定為32px以容納Y軸刻度數字\n        };\n\n        // 計算bar區域的實際高度：可由函數回傳，否則預設160px\n        const barAreaHeight =\n          (typeof config.getChartHeight === 'function' ? config.getChartHeight() : null) || 160;\n\n        // 計算實際可用的繪圖區域大小\n        // 從容器總寬度中減去左右邊距，得到圖表內容區域的寬度\n        const width = containerWidth - margin.left - margin.right;\n        // bar區域高度固定為160px，減去頂部邊距得到實際繪圖高度\n        const height = barAreaHeight - margin.top;\n\n        // ==================== SVG 容器創建階段 ====================\n\n        // 創建 SVG 主容器元素，作為整個圖表的根元素\n        const svg = container\n          .append('svg') // 在選定的容器中添加 SVG 元素\n          .attr('width', containerWidth) // 設定 SVG 的總寬度（包含邊距）\n          .attr('height', containerHeight); // 設定 SVG 的總高度（包含邊距）\n\n        // 創建主要繪圖群組（group），並應用邊距位移\n        // 所有的圖表元素都會在這個群組內繪製\n        // append('g'): 添加一個 SVG 群組元素\n        // attr('transform', ...): 設定群組的位移變換\n        // translate(${margin.left},${margin.top}): 將群組向右下移動，創造邊距效果\n        const g = svg.append('g').attr('transform', `translate(${margin.left},${margin.top})`);\n\n        // ==================== 比例尺設定階段（防止重疊的關鍵）====================\n\n        // 判斷當前是否為主圖表，用於決定顯示的數據量\n        // config.containerId === 'main-chart': 檢查容器 ID 是否為主圖表\n        // 主圖表顯示8個項目，小圖表顯示3個項目\n        const isMainChart = config.containerId === 'main-chart';\n\n        // 設定最大柱子數量，根據圖表類型動態調整\n        // 三元運算符: 條件 ? 真值 : 假值\n        // 主圖表12個，小圖表6個，確保固定的視覺佈局\n        const maxBars = isMainChart ? 12 : 6;\n\n        // 從原始數據中截取前 N 名數據\n        // slice(0, maxBars): JavaScript 陣列方法，截取從索引0開始的 maxBars 個元素\n        // 確保只顯示指定數量的項目\n        const topData = chartData.slice(0, maxBars);\n\n        // 創建固定位置的數據結構，確保每個位置都有唯一的名稱\n        // 這是防止柱子重疊的關鍵設計：為每個位置創建唯一標識符\n        // 主圖表固定8個位置，小圖表固定3個位置\n        // Array.from({ length: maxBars }, callback): 創建指定長度的陣列並填充\n        const displayData = Array.from({ length: maxBars }, (_, i) => {\n          // 檢查當前位置是否有實際數據\n          if (topData[i]) {\n            // 有數據的位置：展開原始數據並添加位置信息\n            return {\n              ...topData[i], // 使用展開運算符複製原始數據的所有屬性（name, value, fullName等）\n              position: i, // 添加位置標識符，用於排序和定位，值為 0, 1, 2, ...\n              uniqueName: `pos-${i}-${topData[i].name}`, // 創建唯一名稱，格式: pos-0-教育部, pos-1-科技部, ...\n            };\n          } else {\n            // 沒有數據的位置：創建空位佔位符，確保固定的視覺佈局\n            return {\n              name: `空位${i + 1}`, // 空位顯示名稱，用於調試和識別\n              value: 0, // 數值為0，不會顯示實際的柱子\n              fullName: '', // 完整名稱為空字串\n              isEmpty: true, // 標記為空位，用於後續過濾和處理\n              position: i, // 位置標識符，與有數據的位置保持一致的索引\n              uniqueName: `pos-${i}-empty`, // 空位的唯一名稱，格式: pos-3-empty, pos-4-empty, ...\n            };\n          }\n        });\n\n        // X 軸比例尺設定：實現 justify-content: space-around 效果\n        const barWidth = 16; // 固定柱子寬度為16px\n\n        // 實現 space-around 佈局的自定義比例尺\n        const dataCount = displayData.length;\n        const totalBarWidth = dataCount * barWidth; // 所有bar的總寬度\n        const availableSpaceWidth = width - totalBarWidth; // 可用於間距的寬度\n        const spaceUnit = availableSpaceWidth / (dataCount * 2); // 每個space-around單位的寬度\n\n        // 創建自定義的位置映射函數\n        const xScale = (uniqueName) => {\n          const index = displayData.findIndex((d) => d.uniqueName === uniqueName);\n          if (index === -1) return 0;\n          // space-around: 每個元素前後都有 spaceUnit，再加上前面所有bar和space的寬度\n          return spaceUnit + index * (barWidth + 2 * spaceUnit) + barWidth / 2;\n        };\n\n        // Y 軸比例尺設定：使用線性比例尺映射數值到 SVG 高度\n        const maxValue = d3.max(topData, (d) => d.value) || 1; // 獲取數據最大值\n\n        // 計算適合平均預算金額的刻度最大值和間隔\n        const getRoundedMax = (val) => {\n          // 簡化邏輯：直接根據數值範圍選擇合適的間隔\n          let interval;\n\n          if (val > 100000) {\n            // 大於10萬：使用5萬的倍數\n            interval = 50000;\n          } else if (val > 50000) {\n            // 大於5萬：使用2萬的倍數\n            interval = 20000;\n          } else if (val > 20000) {\n            // 大於2萬：使用1萬的倍數\n            interval = 10000;\n          } else if (val > 10000) {\n            // 大於1萬：使用5000的倍數\n            interval = 5000;\n          } else if (val > 5000) {\n            // 大於5000：使用1000的倍數\n            interval = 1000;\n          } else if (val > 1000) {\n            // 大於1000：使用500的倍數\n            interval = 500;\n          } else {\n            // 小於1000：使用100的倍數\n            interval = 100;\n          }\n\n          // 計算最大值，確保是間隔的倍數\n          const roundedMax = Math.ceil(val / interval) * interval;\n\n          return { roundedMax, interval };\n        };\n\n        const { roundedMax: roundedMaxValue, interval } = getRoundedMax(maxValue);\n        const yScale = d3\n          .scaleLinear() // 創建線性比例尺，用於連續數值數據\n          .domain([0, roundedMaxValue]) // 定義域：從0到舍入後的最大值，確保刻度對齊\n          .range([height, 0]); // 值域：從圖表底部到頂部（SVG坐標系Y軸向下，需要反轉）\n\n        // 計算Y軸刻度：生成均勻分布的刻度\n        const calculateYTicks = (roundedMax, interval) => {\n          const ticks = [0]; // 始終包含0作為基準線\n\n          // 計算需要多少個刻度\n          const numTicks = Math.ceil(roundedMax / interval);\n\n          // 如果刻度數量太多，調整間隔\n          let finalInterval = interval;\n          if (numTicks > 4) {\n            // 重新計算間隔，確保最多5條線（包含0）\n            finalInterval = Math.ceil(roundedMax / 4);\n            // 將間隔調整為更友好的數值\n            if (finalInterval > 100000) {\n              finalInterval = Math.ceil(finalInterval / 50000) * 50000;\n            } else if (finalInterval > 50000) {\n              finalInterval = Math.ceil(finalInterval / 20000) * 20000;\n            } else if (finalInterval > 20000) {\n              finalInterval = Math.ceil(finalInterval / 10000) * 10000;\n            } else if (finalInterval > 10000) {\n              finalInterval = Math.ceil(finalInterval / 5000) * 5000;\n            } else if (finalInterval > 5000) {\n              finalInterval = Math.ceil(finalInterval / 1000) * 1000;\n            } else if (finalInterval > 1000) {\n              finalInterval = Math.ceil(finalInterval / 500) * 500;\n            } else {\n              finalInterval = Math.ceil(finalInterval / 100) * 100;\n            }\n          }\n\n          // 生成刻度，從finalInterval開始，每次增加finalInterval\n          for (let i = finalInterval; i <= roundedMax; i += finalInterval) {\n            ticks.push(i);\n            if (ticks.length >= 5) break; // 最多5條線\n          }\n\n          return ticks;\n        };\n\n        const yTicks = calculateYTicks(roundedMaxValue, interval);\n\n        // ==================== 移除互動功能階段 ====================\n        // 根據用戶需求，移除了原有的 tooltip 互動功能\n        // 不再創建 tooltip 元素，簡化圖表顯示，專注於數據呈現\n\n        // ==================== 柱狀圖繪製階段（無重疊設計）====================\n\n        // 使用 D3.js 的數據綁定模式創建柱狀圖的矩形元素\n        // 這是 D3.js 的核心概念：數據驅動文檔（Data-Driven Documents）\n        g.selectAll('.bar') // 選擇所有具有 'bar' 類別的元素（初始為空）\n          .data(displayData) // 將 displayData 陣列與選中的元素綁定\n          .enter() // 處理數據多於元素的情況，為每個新數據項創建元素\n          .append('rect') // 在 SVG 中添加矩形元素，用於繪製柱子\n          .attr('class', 'bar') // 為每個矩形添加 'bar' CSS 類別，便於樣式控制\n          // 位置和尺寸設定（確保無重疊的關鍵設計）\n          .attr('x', (d) => xScale(d.uniqueName) - barWidth / 2) // X 座標：置中對齊固定寬度柱子\n          .attr('y', (d) => yScale(d.value)) // Y 座標：使用數值通過 yScale 計算位置（SVG 坐標系）\n          .attr('width', barWidth) // 寬度：使用固定的32px寬度\n          .attr('height', (d) => height - yScale(d.value)) // 高度：從圖表底部到數值對應的 Y 位置\n          .attr('fill', 'var(--my-color-blue)'); // 填充顏色：使用 CSS 自定義屬性，便於主題切換\n\n        // ==================== 數值標籤添加階段 ====================\n        // 在每個柱子的上方顯示具體數值，但只顯示有實際數據的項目\n        // 過濾掉空位和數值為0的項目，避免顯示無意義的標籤\n        // filter(): JavaScript 陣列方法，根據條件篩選元素\n        // !d.isEmpty: 不是空位\n        // d.value > 0: 數值大於0\n        const labelData = displayData.filter((d) => !d.isEmpty && d.value > 0);\n\n        // 使用 D3.js 數據綁定創建數值標籤的文字元素\n        g.selectAll('.bar-label') // 選擇所有具有 'bar-label' 類別的元素\n          .data(labelData) // 綁定過濾後的標籤數據（只包含有效數據）\n          .enter() // 為新數據項創建對應的元素\n          .append('text') // 在 SVG 中添加文字元素\n          .attr('class', 'bar-label') // 設定 CSS 類別，便於樣式控制\n          .attr('x', (d) => {\n            // X 座標計算：將標籤精確置於對應柱子的水平中央\n            // xScale(d.uniqueName): 使用唯一名稱獲取柱子中心點的 X 座標\n            // 由於使用 scalePoint 和固定寬度，直接返回中心點位置\n            return xScale(d.uniqueName);\n          })\n          .attr('y', (d) => {\n            // Y 座標計算：將標籤放置在柱子頂部的上方\n            // yScale(d.value): 使用數值獲取柱子頂部的 Y 座標\n            // - 5: 向上偏移5像素，讓標籤與柱子頂部保持適當距離，避免視覺重疊\n            // 注意：SVG 座標系中 Y 軸向下為正，所以減法表示向上移動\n            return yScale(d.value) - 5;\n          })\n          .attr('text-anchor', 'middle') // SVG 文字錨點：設定為中央對齊，配合 X 座標實現完美置中\n          .style('font-size', '12px') // CSS 樣式：設定字體大小為12像素，確保可讀性\n          .style('fill', '#333') // CSS 樣式：設定文字顏色為深灰色 (#333)，提供良好的對比度\n          .style('font-weight', 'bold') // CSS 樣式：設定粗體字重，增強數值的視覺重要性\n          .text((d) => d3.format(',')(Math.round(d.value))); // 文字內容：使用 Math.round 四捨五入到整數，再用 d3.format(',') 格式化數值，添加千分位逗號\n\n        // ==================== 座標軸和網格線繪製階段 ====================\n\n        // 繪製水平虛線網格：根據Y軸刻度繪製虛線，包含刻度0\n        g.selectAll('.grid-line')\n          .data(yTicks) // 綁定所有Y軸刻度數據（包括0）\n          .enter()\n          .append('line') // 添加線條元素\n          .attr('class', 'grid-line') // 設定CSS類別\n          .attr('x1', 0) // 線條起點X座標：圖表左邊\n          .attr('x2', width) // 線條終點X座標：圖表右邊\n          .attr('y1', (d) => yScale(d)) // 線條起點Y座標：根據刻度值計算\n          .attr('y2', (d) => yScale(d)) // 線條終點Y座標：與起點相同，形成水平線\n          .attr('stroke', '#bdbdbd') // 統一使用 gray-400 顏色 (#bdbdbd)\n          .attr('stroke-width', 1) // 設定線條寬度\n          .attr('stroke-dasharray', '3,3') // 設定虛線樣式：3像素實線，3像素空白\n          .attr('opacity', (d) => (d === 0 ? 0.8 : 0.4)); // 刻度0更明顯，其他更淡\n\n        // X 軸繪製：顯示主管機關或執行單位的名稱標籤\n        const xAxisGroup = g\n          .append('g') // 在主繪圖群組中添加新的群組元素，用於容納 X 軸\n          .attr('transform', `translate(0,${height})`); // 變換設定：將 X 軸群組移動到圖表底部\n\n        // 由於使用自定義 xScale 函數，不需要調用 d3.axisBottom\n        // 刻度線已設定為 tickSize(0)，所以不需要額外創建\n\n        // 移除預設的 X 軸文字，改為自訂垂直文字\n        xAxisGroup.selectAll('text').remove();\n\n        // 自訂 X 軸垂直文字：支援換行和垂直排列\n        displayData.forEach((dataItem) => {\n          if (!dataItem.isEmpty) {\n            const x = xScale(dataItem.uniqueName); // 取得 bar 的 x 位置\n            const text = dataItem.name;\n\n            // 為每個機關名稱創建垂直文字群組\n            const textGroup = xAxisGroup.append('g').attr('transform', `translate(${x}, 20)`); // 置中對齊 bar，向下偏移20px\n\n            // 將文字按每10個字符分割成多行\n            const lines = [];\n            for (let i = 0; i < text.length; i += 10) {\n              lines.push(text.substring(i, i + 10));\n            }\n\n            // 根據行數決定水平排列方式\n            const totalLines = lines.length;\n\n            lines.forEach((line, lineIndex) => {\n              // 計算每行的水平偏移：將多行置中排列\n              const lineOffset =\n                totalLines === 1\n                  ? 0\n                  : totalLines === 2\n                    ? lineIndex === 0\n                      ? -8\n                      : 8\n                    : totalLines === 3\n                      ? lineIndex === 0\n                        ? -12\n                        : lineIndex === 1\n                          ? 0\n                          : 12\n                      : // 4行或更多時，均勻分布\n                        (lineIndex - (totalLines - 1) / 2) * 8;\n\n              // 在每行內垂直排列字符\n              line.split('').forEach((char, charIndex) => {\n                textGroup\n                  .append('text')\n                  .text(char)\n                  .attr('x', lineOffset) // 水平偏移以實現多行排列\n                  .attr('y', charIndex * (12 + 0.6)) // 字體大小12px + letter-spacing 0.6px\n                  .style('font-size', '12px')\n                  .style('font-family', 'Arial, sans-serif')\n                  .style('fill', '#333')\n                  .style('text-anchor', 'middle'); // 水平置中\n              });\n            });\n          }\n        });\n\n        // Y 軸繪製：數值顯示在圖表內部，實現滿版效果\n        g.append('g') // 在主繪圖群組中添加新的群組元素，用於容納 Y 軸\n          .call(\n            d3\n              .axisLeft(yScale)\n              .tickValues(yTicks) // 使用自定義的刻度值\n              .tickSize(0) // 移除垂直刻度線\n              .tickFormat((d) => {\n                // 自定義格式化函數：顯示原始數字，添加千分位逗號\n                return d3.format(',')(d); // 使用千分位逗號格式化，不顯示k或M\n              }) // 格式化：顯示原始數字，添加千分位逗號\n          )\n          .style('font-size', '11px') // CSS 樣式：設定 Y 軸刻度文字的字體大小\n          .select('.domain')\n          .remove(); // 移除Y軸主線\n\n        // Y軸數值標籤保持在左側正常位置\n        g.selectAll('.tick text')\n          .style('fill', '#666') // 設定文字顏色\n          .style('font-weight', 'normal'); // 設定字重\n\n        // 移除Y軸標籤：根據用戶需求，不再顯示Y軸標籤\n      };\n\n      /**\n       * 小圖表批次繪製函數\n       * 功能：遍歷所有主管機關，為每個主管機關創建對應的執行單位統計圖表\n       *\n       * 處理流程：\n       * 1. 獲取前8名主管機關的數據\n       * 2. 為每個主管機關提取其下前3名執行單位\n       * 3. 調用通用圖表繪製函數創建小圖表\n       *\n       * 設計特點：\n       * - 統一使用 drawChart 函數，確保視覺一致性\n       * - 動態數據轉換，適配不同的數據結構\n       * - 批次處理，提高渲染效率\n       */\n      const drawSupervisorCharts = () => {\n        // 獲取計算屬性的值：前12名主管機關及其子單位數據\n        // .value: Vue 3 Composition API 中獲取計算屬性實際值的語法\n        const chartsData = getSupervisorChartsData.value;\n\n        // 添加防護性檢查\n        if (!chartsData || chartsData.length === 0) {\n          return;\n        }\n\n        // 遍歷每個主管機關的數據，為其創建對應的小圖表\n        // forEach(): JavaScript 陣列方法，對每個元素執行指定的函數\n        chartsData.forEach((chartData) => {\n          // 添加防護性檢查\n          if (!chartData || !chartData.subUnits) {\n            return;\n          }\n\n          // 數據格式轉換：將子單位數據轉換為圖表所需的格式\n          // 只取前6名執行單位（按平均預算排序），符合用戶需求\n          // slice(0, 6): 截取前6個子單位\n          // map(): 將每個子單位轉換為標準的圖表數據格式\n          const subUnitsData = chartData.subUnits\n            .slice(0, 6)\n            .map((unit) => {\n              // 添加防護性檢查\n              if (!unit || !unit.name_sub) {\n                return null;\n              }\n\n              return {\n                name: unit.name_sub, // 添加name屬性，drawChart函數需要這個屬性\n                uniqueName: unit.name_sub,\n                value: unit.本期經費平均_千元 || 0, // 使用本期經費平均_千元，提供默認值\n                extra: {\n                  count: unit.委托案件數 || 0, // 使用委托案件數，提供默認值\n                  budget: Math.round(unit.本期經費平均_千元 || 0), // 使用本期經費平均_千元，提供默認值\n                },\n              };\n            })\n            .filter(Boolean); // 過濾掉 null 值\n\n          // 如果沒有有效的子單位數據，跳過這個圖表\n          if (subUnitsData.length === 0) {\n            return;\n          }\n\n          // 小圖表配置對象：定義圖表的所有參數和設定\n          const chartConfig = {\n            // 容器ID：對應HTML中的元素ID，用於D3.js選擇器定位\n            containerId: chartData.id,\n            // 圖表數據：轉換後的執行單位數據陣列\n            data: subUnitsData,\n            // Y軸標籤：根據用戶需求，設為空字串不顯示\n            yAxisLabel: '',\n            // 容器高度：與主圖表完全一致（160px bar區域 + 160px文字區域）\n            containerHeight: 320,\n            // Tooltip模板：定義懸停提示的HTML內容（雖然已移除互動功能，但保留配置）\n            tooltipTemplate: (d) => `\n              <strong>${d.fullName}</strong><br/>\n              平均預算: ${Math.round(d.value)}<br/>\n              平均預算: ${Math.round(d.extra.budget)}萬元<br/>\n              主管機關: ${d.extra.agencyName}\n            `,\n          };\n\n          // 調用通用圖表繪製函數：使用統一的繪圖邏輯創建小圖表\n          // 傳入配置對象，確保所有小圖表具有一致的視覺風格\n          drawChart(chartConfig);\n        });\n      };\n\n      // ==================== 數據準備函數區域 ====================\n\n      /**\n       * 主圖表數據準備函數\n       * 功能：從數據存儲中提取並轉換主管機關數據，準備用於主圖表顯示\n       *\n       * 處理邏輯：\n       * 1. 從 dataStore 獲取排序後的主管機關數據\n       * 2. 截取前8名（根據用戶最新需求調整）\n       * 3. 轉換數據格式以適配圖表繪製函數\n       * 4. 處理名稱長度以適應 X 軸顯示\n       *\n       * @returns {Array} 轉換後的圖表數據陣列\n       */\n      const prepareMainChartData = () => {\n        const topAgencies = dataStore.getTopSupervisorAgenciesByBudget;\n\n        // 添加防護性檢查\n        if (!topAgencies || topAgencies.length === 0) {\n          return [];\n        }\n\n        return topAgencies\n          .map((agency) => {\n            // 確保 agency 和必要屬性存在\n            if (!agency || !agency.name) {\n              return null;\n            }\n\n            return {\n              name: agency.name, // 添加name屬性用於顯示\n              uniqueName: agency.name,\n              value: agency.本期經費平均_千元 || 0, // 使用本期經費平均_千元，提供默認值\n              extra: {\n                count: agency.委托案件數 || 0, // 使用委托案件數，提供默認值\n                budget: agency.本期經費平均_千元 || 0, // 使用本期經費平均_千元，提供默認值\n              },\n            };\n          })\n          .filter(Boolean); // 過濾掉 null 值\n      };\n\n      // ==================== 關係圖數據準備函數區域 ====================\n\n      /**\n       * 準備關係圖的節點和連結數據\n       * 功能：從主管機關與執行單位映射數據中提取節點和邊的關係\n       *\n       * 重要：只包含 \"學術單位\":\"TRUE\" 的數據\n       *\n       * 數據結構：\n       * - nodes: 包含主管機關和執行單位的節點陣列\n       * - links: 包含它們之間連接關係的邊陣列\n       *\n       * 節點類型：\n       * - 主管機關：type = 'agency', 藍色顯示\n       * - 執行單位：type = 'unit', 橘色顯示\n       *\n       * @returns {Object} 包含 nodes 和 links 的數據對象\n       */\n      const prepareNetworkGraphData = () => {\n        // 1. 獲取主管機關數據，找出所有學術單位\n        const supervisorAgencies = dataStore.supervisorAgencies;\n        if (!supervisorAgencies || supervisorAgencies.length === 0) {\n          console.log('沒有主管機關數據');\n          return { nodes: [], links: [] };\n        }\n\n        // 輸出原始主管機關數據的調試信息\n        console.log('原始主管機關數據樣本:', supervisorAgencies.slice(0, 3));\n        console.log('主管機關數量:', supervisorAgencies.length);\n\n        // 2. 創建學術單位集合\n        const academicAgencies = new Set();\n        const nonAcademicAgencies = new Set();\n\n        supervisorAgencies.forEach((agency) => {\n          console.log(`檢查主管機關: ${agency.name}, 學術單位標記: \"${agency.學術單位}\"`);\n          if (agency.學術單位 === 'TRUE') {\n            academicAgencies.add(agency.name);\n            console.log(`✓ ${agency.name} 是學術單位`);\n          } else {\n            nonAcademicAgencies.add(agency.name);\n            console.log(`✗ ${agency.name} 不是學術單位 (標記: \"${agency.學術單位}\")`);\n          }\n        });\n\n        console.log('學術單位主管機關:', [...academicAgencies]);\n        console.log('非學術單位主管機關:', [...nonAcademicAgencies]);\n\n        // 3. 獲取映射關係數據\n        const mappingData = dataStore.supervisorExecutingMapping;\n        if (!mappingData || mappingData.length === 0) {\n          console.log('沒有映射關係數據');\n          return { nodes: [], links: [] };\n        }\n\n        // 輸出映射數據的調試信息\n        console.log('映射數據樣本:', mappingData.slice(0, 3));\n        console.log('映射數據數量:', mappingData.length);\n\n        // 4. 過濾出只與學術單位有關的映射關係\n        const academicMappings = mappingData.filter((item) => {\n          const isAcademic = academicAgencies.has(item.name);\n          if (isAcademic) {\n            console.log(`✓ 保留映射: ${item.name} -> ${item.name_sub}`);\n          } else {\n            console.log(`✗ 過濾掉映射: ${item.name} -> ${item.name_sub} (非學術單位)`);\n          }\n          return isAcademic;\n        });\n\n        console.log('過濾前映射數據數量:', mappingData.length);\n        console.log('過濾後學術單位映射數量:', academicMappings.length);\n\n        if (academicMappings.length === 0) {\n          console.log('沒有學術單位的映射關係');\n          return { nodes: [], links: [] };\n        }\n\n        // 5. 收集所有相關的執行單位，但只保留真正的學術單位\n        const academicUnits = new Set();\n        academicMappings.forEach((item) => {\n          // 檢查執行單位本身是否為學術單位\n          const unitData = dataStore.executingUnits.find((unit) => unit.name === item.name_sub);\n          if (unitData && unitData.學術單位 === 'TRUE') {\n            academicUnits.add(item.name_sub);\n          }\n        });\n\n        console.log('相關執行單位:', [...academicUnits]);\n\n        // 6. 創建節點數據\n        let nodes = [];\n\n        // 添加學術單位主管機關節點\n        academicAgencies.forEach((agencyName) => {\n          // 計算該主管機關的統計數據\n          const agencyMappings = academicMappings.filter((item) => item.name === agencyName);\n          const totalCount = agencyMappings.reduce((sum, item) => sum + (item.委托案件數 || 0), 0);\n          const totalBudget = agencyMappings.reduce(\n            (sum, item) => sum + (item.本期經費平均_千元 || 0),\n            0\n          );\n          const projectCount = agencyMappings.length;\n\n          nodes.push({\n            id: `agency-${agencyName}`,\n            name: agencyName,\n            type: 'agency',\n            totalCount: totalCount,\n            totalBudget: totalBudget,\n            projectCount: projectCount,\n            meanBudget: projectCount > 0 ? totalBudget / projectCount : 0,\n            isAcademic: true, // 標記為學術單位\n            academicStatus: 'TRUE', // 學術單位狀態\n          });\n        });\n\n        // 添加與學術單位有關係的執行單位節點\n        academicUnits.forEach((unitName) => {\n          // 計算該執行單位的統計數據\n          const unitMappings = academicMappings.filter((item) => item.name_sub === unitName);\n          const totalCount = unitMappings.reduce((sum, item) => sum + (item.委托案件數 || 0), 0);\n          const totalBudget = unitMappings.reduce(\n            (sum, item) => sum + (item.本期經費平均_千元 || 0),\n            0\n          );\n          const projectCount = unitMappings.length;\n\n          // 從執行單位數據中獲取學術單位狀態\n          const unitData = dataStore.executingUnits.find((item) => item.name === unitName);\n          const unitAcademicStatus = unitData ? unitData.學術單位 : 'FALSE';\n\n          nodes.push({\n            id: `unit-${unitName}`,\n            name: unitName,\n            type: 'unit',\n            totalCount: totalCount,\n            totalBudget: totalBudget,\n            projectCount: projectCount,\n            meanBudget: projectCount > 0 ? totalBudget / projectCount : 0,\n            isAcademic: unitAcademicStatus === 'TRUE',\n            academicStatus: unitAcademicStatus, // 使用 JSON 數據中的學術單位狀態\n          });\n        });\n\n        // 7. 創建連結數據，只保留目標執行單位是學術單位的連結\n        let links = academicMappings\n          .filter((item) => academicUnits.has(item.name_sub)) // 只保留目標執行單位在學術單位集合中的連結\n          .map((item) => ({\n            source: `agency-${item.name}`,\n            target: `unit-${item.name_sub}`,\n            value: item.本期經費平均_千元 || 0,\n          }));\n\n        // 8. 合併「平均金額 <= 2000(千元)」的執行單位節點為「其他」\n        const THRESHOLD = 2000;\n        const unitNodesBelow = new Set(\n          nodes\n            .filter((n) => n.type === 'unit' && (Number(n.meanBudget) || 0) <= THRESHOLD)\n            .map((n) => n.id)\n        );\n\n        if (unitNodesBelow.size > 0) {\n          // 聚合被合併單位的統計量\n          let aggTotalCount = 0;\n          let aggTotalBudget = 0;\n          let aggProjectCount = 0;\n\n          nodes\n            .filter((n) => unitNodesBelow.has(n.id))\n            .forEach((n) => {\n              aggTotalCount += Number(n.totalCount) || 0;\n              aggTotalBudget += Number(n.totalBudget) || 0;\n              aggProjectCount += Number(n.projectCount) || 0;\n            });\n\n          // 依來源 agency 聚合被合併單位的連結權重（以 value 加總）\n          const linkAggBySource = new Map();\n          links\n            .filter((l) => unitNodesBelow.has(l.target))\n            .forEach((l) => {\n              const prev = linkAggBySource.get(l.source) || 0;\n              linkAggBySource.set(l.source, prev + (Number(l.value) || 0));\n            });\n\n          // 移除原本指向被合併單位的連結\n          const keptLinks = links.filter((l) => !unitNodesBelow.has(l.target));\n\n          if (aggProjectCount > 0 || aggTotalBudget > 0) {\n            const otherNodeId = 'unit-其他';\n            const otherNode = {\n              id: otherNodeId,\n              name: '其他',\n              type: 'unit',\n              totalCount: aggTotalCount,\n              totalBudget: aggTotalBudget,\n              projectCount: aggProjectCount,\n              meanBudget: aggProjectCount > 0 ? aggTotalBudget / aggProjectCount : 0,\n              isAcademic: true,\n              academicStatus: 'TRUE',\n            };\n\n            // 建立聚合連結（每個 agency 一條連到「其他」）\n            const aggregatedLinks = Array.from(linkAggBySource.entries()).map(\n              ([sourceId, sumValue]) => ({\n                source: sourceId,\n                target: otherNodeId,\n                value: sumValue || 0,\n              })\n            );\n\n            // 更新 nodes/links 供後續門檻過濾\n            const keptNodes = nodes.filter((n) => !unitNodesBelow.has(n.id));\n            keptNodes.push(otherNode);\n            nodes = keptNodes;\n            links = keptLinks.concat(aggregatedLinks);\n          }\n        }\n\n        // 9. 最終門檻過濾：只保留「meanBudget > 2000」的節點（不移除『其他』）與其連結\n        const allowedIds = new Set(\n          nodes\n            .filter(\n              (n) =>\n                n.name === '其他' ||\n                (n.type === 'unit' ? (Number(n.meanBudget) || 0) > THRESHOLD : true)\n            )\n            .map((n) => n.id)\n        );\n        nodes = nodes.filter((n) => allowedIds.has(n.id));\n        links = links.filter((l) => allowedIds.has(l.source) && allowedIds.has(l.target));\n\n        return { nodes, links };\n      };\n\n      /**\n       * 繪製關係網絡圖函數\n       * 功能：使用 D3.js 力導向布局創建主管機關與執行單位的關係圖\n       *\n       * 視覺設計：\n       * - 藍色圓圈：主管機關\n       * - 橘色圓圈：執行單位\n       * - 圓圈大小：根據總預算調整\n       * - 灰色線條：表示合作關係\n       * - 互動功能：拖拽節點、懸停顯示詳情\n       */\n      const drawNetworkGraph = () => {\n        // 獲取圖表數據：節點和連結關係\n        const graphData = prepareNetworkGraphData();\n\n        // 數據驗證：如果沒有節點，顯示提示信息\n        if (!graphData.nodes || graphData.nodes.length === 0) {\n          const container = d3.select('#network-graph');\n          container.html('<div class=\"text-center text-muted p-5\">暫無關係數據</div>');\n          return;\n        }\n\n        // 清除舊的圖表內容\n        const container = d3.select('#network-graph');\n        container.selectAll('*').remove();\n\n        // 獲取容器尺寸：動態適應容器大小\n        const containerRect = container.node().getBoundingClientRect();\n        const width = containerRect.width;\n        const height = 600; // 固定高度，與CSS設定一致\n\n        // 創建 SVG 容器：關係圖的根元素\n        const svg = container.append('svg').attr('width', width).attr('height', height);\n\n        // 創建主繪圖群組：所有圖形元素的容器\n        const g = svg.append('g');\n\n        // 添加縮放功能：允許用戶縮放和平移圖表\n        const zoom = d3\n          .zoom()\n          .scaleExtent([0.1, 3]) // 縮放範圍：0.1x 到 3x\n          .on('zoom', (event) => {\n            // 應用變換：縮放和平移\n            g.attr('transform', event.transform);\n          });\n\n        // 將縮放行為綁定到 SVG 元素\n        svg.call(zoom);\n\n        // 設定力導向模擬：控制節點和連結的物理行為\n        const simulation = d3\n          .forceSimulation(graphData.nodes)\n          .force(\n            'link',\n            d3\n              .forceLink(graphData.links)\n              .id((d) => d.id) // 使用節點 ID 來匹配連結\n              .distance(100)\n          ) // 連結的理想長度\n          .force('charge', d3.forceManyBody().strength(-300)) // 節點間的排斥力\n          .force('center', d3.forceCenter(width / 2, height / 2)) // 將圖形置於中心\n          .force(\n            'collision',\n            d3.forceCollide().radius((d) => {\n              // 計算節點半徑：讓節點面積與平均金額成正比\n              // 目標：讓節點面積與平均金額成正比\n              // 面積 = 平均金額，半徑 = √(面積/π)\n              const scaleMultiplier = 0.001; // 放大倍數：1.0 = 原始大小，2.0 = 放大2倍，0.5 = 縮小2倍\n              const area = d.meanBudget * scaleMultiplier; // 面積 = 平均金額 × 放大倍數\n              const radius = Math.sqrt(area / Math.PI);\n              return Math.max(5, Math.min(radius, 100)); // 最小半徑5px（直徑10px），最大半徑100px（直徑200px）\n            })\n          ); // 防止節點重疊，調整碰撞半徑與圓圈大小一致\n\n        // 繪製連結線：表示主管機關與執行單位的關係\n        const links = g\n          .append('g')\n          .attr('class', 'links')\n          .selectAll('line')\n          .data(graphData.links)\n          .enter()\n          .append('line')\n          .attr('stroke', '#999') // 灰色線條\n          .attr('stroke-opacity', 0.6) // 半透明效果\n          .attr('stroke-width', 2); // 固定線條寬度\n\n        // 繪製節點：主管機關和執行單位的圓圈\n        const nodes = g\n          .append('g')\n          .attr('class', 'nodes')\n          .selectAll('circle')\n          .data(graphData.nodes)\n          .enter()\n          .append('circle')\n          .attr('r', (d) => {\n            // 計算節點半徑：讓節點面積與平均金額成正比\n            // 目標：讓節點面積與平均金額成正比\n            // 面積 = 平均金額，半徑 = √(面積/π)\n            const scaleMultiplier = 1.0; // 放大倍數：1.0 = 原始大小，2.0 = 放大2倍，0.5 = 縮小2倍\n            const area = d.meanBudget * scaleMultiplier; // 面積 = 平均金額 × 放大倍數\n            const radius = Math.sqrt(area / Math.PI);\n            return Math.max(5, Math.min(radius, 100)); // 最小半徑5px（直徑10px），最大半徑100px（直徑200px）\n          })\n          .attr('fill', (d) => (d.type === 'agency' ? '#4a90e2' : '#f5a623')) // 藍色：機關，橘色：單位\n          .attr('stroke', '#fff') // 白色邊框\n          .attr('stroke-width', 2) // 邊框寬度\n          .style('cursor', 'pointer') // 滑鼠游標變為手型\n          .call(\n            d3\n              .drag() // 添加拖拽功能\n              .on('start', dragstarted) // 拖拽開始\n              .on('drag', dragged) // 拖拽進行中\n              .on('end', dragended)\n          ); // 拖拽結束\n\n        // 添加節點標籤：顯示機關或單位名稱\n        const labels = g\n          .append('g')\n          .attr('class', 'labels')\n          .selectAll('text')\n          .data(graphData.nodes)\n          .enter()\n          .append('text')\n          .text((d) => {\n            // 截短過長的名稱：超過10個字符則截斷並加省略號\n            return d.name.length > 10 ? d.name.substring(0, 10) + '...' : d.name;\n          })\n          .attr('font-size', '12px')\n          .attr('font-family', 'Arial, sans-serif')\n          .attr('fill', '#333')\n          .attr('text-anchor', 'middle') // 文字置中對齊\n          .attr('dy', '0.35em') // 垂直置中調整\n          .style('pointer-events', 'none'); // 標籤不響應滑鼠事件\n\n        // 創建自定義 tooltip 元素\n        const tooltip = d3\n          .select('body')\n          .append('div')\n          .attr('class', 'network-tooltip')\n          .style('position', 'absolute')\n          .style('padding', '10px')\n          .style('background', 'rgba(0, 0, 0, 0.8)')\n          .style('color', 'white')\n          .style('border-radius', '5px')\n          .style('font-size', '12px')\n          .style('line-height', '1.4')\n          .style('pointer-events', 'none')\n          .style('opacity', 0)\n          .style('z-index', '1000');\n\n        // 添加滑鼠事件：懸停顯示詳細資訊\n        nodes\n          .on('mouseover', function (event, d) {\n            // 高亮當前節點\n            d3.select(this)\n              .transition()\n              .duration(200)\n              .attr('stroke-width', 3)\n              .attr('stroke', '#333');\n\n            // 準備顯示的資訊\n            const typeText = d.type === 'agency' ? '主管機關' : '執行單位';\n\n            let tooltipContent = `\n              <div style=\"font-weight: bold; margin-bottom: 5px;\">${typeText}</div>\n              <div style=\"font-size: 14px; font-weight: bold; margin-bottom: 8px;\">${d.name}</div>\n              <div>案件數: <span style=\"color: #4a90e2;\">${d.projectCount}</span></div>\n              <div>平均金額: <span style=\"color: #50e3c2;\">${Math.round(d.meanBudget).toLocaleString()}</span>(千元)</div>\n            `;\n\n            // 如果是執行單位，顯示額外資訊\n            if (d.type === 'unit') {\n              tooltipContent += `<div style=\"margin-top: 5px; color: #f5a623;\">🏫 學術機構</div>`;\n            }\n\n            // 顯示 tooltip\n            tooltip\n              .html(tooltipContent)\n              .style('opacity', 1)\n              .style('left', event.pageX + 10 + 'px')\n              .style('top', event.pageY - 10 + 'px');\n          })\n          .on('mousemove', function (event) {\n            // 跟隨滑鼠移動\n            tooltip.style('left', event.pageX + 10 + 'px').style('top', event.pageY - 10 + 'px');\n          })\n          .on('mouseout', function () {\n            // 恢復節點樣式\n            d3.select(this)\n              .transition()\n              .duration(200)\n              .attr('stroke-width', 2)\n              .attr('stroke', '#fff');\n\n            // 隱藏 tooltip\n            tooltip.transition().duration(200).style('opacity', 0);\n          });\n\n        // 力導向模擬的每一幀更新：更新節點和連結位置\n        simulation.on('tick', () => {\n          // 更新連結線的位置\n          links\n            .attr('x1', (d) => d.source.x)\n            .attr('y1', (d) => d.source.y)\n            .attr('x2', (d) => d.target.x)\n            .attr('y2', (d) => d.target.y);\n\n          // 更新節點圓圈的位置\n          nodes.attr('cx', (d) => d.x).attr('cy', (d) => d.y);\n\n          // 更新標籤文字的位置\n          labels.attr('x', (d) => d.x).attr('y', (d) => d.y);\n        });\n\n        // 拖拽事件處理函數：拖拽開始時重新啟動模擬\n        function dragstarted(event, d) {\n          if (!event.active) simulation.alphaTarget(0.3).restart();\n          d.fx = d.x; // 固定 X 座標\n          d.fy = d.y; // 固定 Y 座標\n        }\n\n        // 拖拽進行中：更新節點位置\n        function dragged(event, d) {\n          d.fx = event.x; // 更新固定的 X 座標\n          d.fy = event.y; // 更新固定的 Y 座標\n        }\n\n        // 拖拽結束：釋放節點固定位置\n        function dragended(event, d) {\n          if (!event.active) simulation.alphaTarget(0); // 停止模擬的熱重啟\n          d.fx = null; // 釋放 X 座標固定\n          d.fy = null; // 釋放 Y 座標固定\n        }\n      };\n\n      /**\n       * 文字雲繪製函數\n       *\n       * 功能說明：\n       * 使用 D3.js 創建學術單位的文字雲視覺化，文字大小反映各單位的平均金額。\n       * 這為用戶提供了另一種視角來理解學術單位的預算分布情況，文字越大表示平均金額越高。\n       *\n       * 技術實現架構：\n       * - 布局算法：使用 D3.js 的 d3-cloud 布局算法，實現文字的隨機分布\n       * - 視覺化設計：文字大小與平均金額成正比，實現數據的視覺化表達\n       * - 互動功能：支持滑鼠懸停效果，顯示詳細的統計信息\n       * - 響應式設計：自動適應容器尺寸，支持不同螢幕分辨率\n       *\n       * 數據處理邏輯：\n       * 1. 從 dataStore 獲取學術單位數據（\"學術單位\":\"TRUE\"）\n       * 2. 過濾出有預算金額的單位，避免顯示零預算的單位\n       * 3. 根據平均金額計算文字大小，實現數據的視覺化表達\n       * 4. 使用 d3-cloud 算法計算文字的隨機位置，避免重疊\n       *\n       * 視覺設計特點：\n       * - 文字大小編碼：文字大小與平均金額成正比\n       * - 顏色編碼：使用漸變色彩，平均金額越高顏色越深\n       * - 隨機布局：文字位置隨機分布，創造視覺上的動態感\n       * - 懸停效果：滑鼠懸停時文字變大變深，提升用戶體驗\n       *\n       * 與案件數文字雲的區別：\n       * - 數據維度：關注平均金額而非案件數量\n       * - 分析重點：資金分配效率而非業務活躍度\n       * - 應用場景：主要用於預算分析和資金流向研究\n       *\n       * 性能優化：\n       * - 只顯示有預算金額的學術單位，避免無意義的視覺元素\n       * - 使用 D3.js 的過渡動畫，提升用戶體驗\n       * - 及時清理舊的文字雲元素，防止記憶體洩漏\n       */\n      const drawWordCloud = () => {\n        // 獲取文字雲容器\n        const container = d3.select('#word-cloud');\n        if (container.empty()) {\n          console.warn('文字雲容器 #word-cloud 不存在');\n          return;\n        }\n\n        // 清理容器\n        container.selectAll('*').remove();\n\n        // 獲取學術單位數據\n        const academicUnits = dataStore.executingUnits.filter(\n          (unit) => unit.學術單位 === 'TRUE' && unit.本期經費平均_千元 > 0\n        );\n\n        if (academicUnits.length === 0) {\n          container\n            .append('div')\n            .attr('class', 'd-flex align-items-center justify-content-center h-100')\n            .style('color', '#666')\n            .text('無學術單位預算數據');\n          return;\n        }\n\n        // 計算字級比例尺（壓縮動態範圍，避免字過大）\n        const budgetValsForScale = academicUnits.map((u) => u.本期經費平均_千元);\n        const minBudgetForScale = d3.min(budgetValsForScale) || 0;\n        const maxBudgetForScale = d3.max(budgetValsForScale) || 1;\n        const sizeScale = d3\n          .scaleSqrt()\n          .domain([minBudgetForScale, maxBudgetForScale])\n          .range([12, 40]);\n\n        // 準備文字雲數據（套用縮小後字級）\n        const wordData = academicUnits.map((unit) => ({\n          text: unit.name,\n          size: Math.max(10, Math.round(sizeScale(unit.本期經費平均_千元))),\n          budget: unit.本期經費平均_千元,\n          count: unit.委托案件數 || 0,\n        }));\n\n        // 創建 SVG 容器\n        const containerWidth = container.node().getBoundingClientRect().width;\n        const containerHeight = 400;\n\n        const svg = container\n          .append('svg')\n          .attr('width', containerWidth)\n          .attr('height', containerHeight);\n\n        // CSS 顏色變數陣列\n        const cssColors = [\n          'var(--my-color-red)',\n          'var(--my-color-pink)',\n          'var(--my-color-deeporange)',\n          'var(--my-color-orange)',\n          'var(--my-color-amber)',\n          'var(--my-color-yellow)',\n          'var(--my-color-lime)',\n          'var(--my-color-light-green)',\n          'var(--my-color-green)',\n          'var(--my-color-teal)',\n          'var(--my-color-cyan)',\n          'var(--my-color-lightblue)',\n          'var(--my-color-blue)',\n          'var(--my-color-bluegrey)',\n          'var(--my-color-indigo)',\n          'var(--my-color-deeppurple)',\n          'var(--my-color-purple)',\n          'var(--my-color-brown)',\n        ];\n\n        // 以螺旋搜尋與實際文字矩形碰撞檢測的防重疊布局\n        const words = [];\n        const placedRects = [];\n\n        // 測量特定字級的文字實際寬高\n        const measureText = (text, fontSize) => {\n          const tempSvg = d3\n            .select('body')\n            .append('svg')\n            .attr('width', 0)\n            .attr('height', 0)\n            .style('position', 'absolute')\n            .style('left', '-9999px')\n            .style('top', '-9999px');\n          const tempText = tempSvg\n            .append('text')\n            .style('font-size', `${fontSize}px`)\n            .style('font-family', 'Arial, Microsoft JhengHei, sans-serif')\n            .text(text);\n          const bbox = tempText.node().getBBox();\n          tempSvg.remove();\n          return { width: bbox.width, height: bbox.height };\n        };\n\n        const centerX = containerWidth / 2;\n        const centerY = containerHeight / 2;\n        const marginPad = 2;\n\n        const rectsIntersect = (a, b) =>\n          !(a.right < b.left || a.left > b.right || a.bottom < b.top || a.top > b.bottom);\n\n        const sortedWordData = [...wordData].sort((a, b) => b.size - a.size);\n\n        sortedWordData.forEach((word) => {\n          let placed = false;\n\n          // 嘗試縮小字級以增加可放置機會\n          for (let trySize = word.size; trySize >= 10 && !placed; trySize -= 2) {\n            const { width, height } = measureText(word.text, trySize);\n\n            // 螺旋搜尋位置\n            for (let t = 0; t < 2000 && !placed; t++) {\n              const angle = 0.35 * t;\n              const radius = 2 + 2 * angle;\n              const x = centerX + radius * Math.cos(angle);\n              const y = centerY + radius * Math.sin(angle);\n\n              const rect = {\n                left: x - width / 2 - marginPad,\n                right: x + width / 2 + marginPad,\n                top: y - height / 2 - marginPad,\n                bottom: y + height / 2 + marginPad,\n              };\n\n              // 邊界檢查\n              if (\n                rect.left < 0 ||\n                rect.right > containerWidth ||\n                rect.top < 0 ||\n                rect.bottom > containerHeight\n              ) {\n                continue;\n              }\n\n              // 與已放置文字碰撞檢測\n              const hasCollision = placedRects.some((r) => rectsIntersect(rect, r));\n              if (!hasCollision) {\n                // 朝中心方向作微移擠壓，盡量貼近中心\n                let curX = x;\n                let curY = y;\n                let curRect = { ...rect };\n                for (let s = 0; s < 80; s++) {\n                  const vx = centerX - curX;\n                  const vy = centerY - curY;\n                  const vlen = Math.hypot(vx, vy) || 1;\n                  const step = 1; // 每步1px\n                  const nx = curX + (vx / vlen) * step;\n                  const ny = curY + (vy / vlen) * step;\n                  const nrect = {\n                    left: nx - width / 2 - marginPad,\n                    right: nx + width / 2 + marginPad,\n                    top: ny - height / 2 - marginPad,\n                    bottom: ny + height / 2 + marginPad,\n                  };\n                  const outOfBounds =\n                    nrect.left < 0 ||\n                    nrect.right > containerWidth ||\n                    nrect.top < 0 ||\n                    nrect.bottom > containerHeight;\n                  const collide = placedRects.some((r) => rectsIntersect(nrect, r));\n                  if (outOfBounds || collide) break;\n                  curX = nx;\n                  curY = ny;\n                  curRect = nrect;\n                }\n\n                const placedWord = {\n                  text: word.text,\n                  size: trySize,\n                  budget: word.budget,\n                  count: word.count,\n                  x: curX,\n                  y: curY,\n                  color: cssColors[Math.floor(Math.random() * cssColors.length)],\n                };\n                words.push(placedWord);\n                placedRects.push(curRect);\n                placed = true;\n              }\n            }\n          }\n        });\n\n        // 繪製文字雲\n        svg\n          .selectAll('text')\n          .data(words)\n          .enter()\n          .append('text')\n          .style('font-size', (d) => `${d.size}px`)\n          .style('font-family', 'Arial, Microsoft JhengHei, sans-serif')\n          .style('font-weight', 'bold')\n          .style('fill', (d) => d.color)\n          .style('cursor', 'pointer')\n          .attr('text-anchor', 'middle')\n          .attr('dominant-baseline', 'middle')\n          .attr('x', (d) => d.x)\n          .attr('y', (d) => d.y)\n          // 移除旋轉以簡化碰撞判定\n          .text((d) => d.text)\n          .on('mouseover', function (event, d) {\n            // 懸停效果\n            d3.select(this).style('fill', 'var(--my-color-red)');\n\n            // 顯示 tooltip\n            const tooltip = d3\n              .select('body')\n              .append('div')\n              .attr('class', 'word-cloud-tooltip')\n              .style('position', 'absolute')\n              .style('background', 'rgba(0, 0, 0, 0.8)')\n              .style('color', 'white')\n              .style('padding', '8px 12px')\n              .style('border-radius', '4px')\n              .style('font-size', '12px')\n              .style('pointer-events', 'none')\n              .style('z-index', '1000');\n\n            tooltip.html(`\n              <div><strong>${d.text}</strong></div>\n              <div>平均金額: ${Math.round(d.budget).toLocaleString()}(千元)</div>\n              <div>委托案件數: ${d.count.toLocaleString()}</div>\n            `);\n          })\n          .on('mousemove', function (event) {\n            // 跟隨滑鼠移動 tooltip\n            d3.select('.word-cloud-tooltip')\n              .style('left', event.pageX + 10 + 'px')\n              .style('top', event.pageY - 10 + 'px');\n          })\n          .on('mouseout', function (event, d) {\n            // 恢復原始狀態\n            d3.select(this).style('font-size', `${d.size}px`).style('fill', d.color);\n\n            // 移除 tooltip\n            d3.select('.word-cloud-tooltip').remove();\n          });\n      };\n\n      // ==================== 地圖初始化函數區域 ====================\n\n      /**\n       * 台灣地圖初始化函數\n       * 功能：使用 Leaflet.js 創建互動式地圖，顯示學術單位執行單位的地理分布\n       *\n       * 地圖特色：\n       * - 以台灣為中心的地理視圖\n       * - 圓圈標記代表執行單位位置\n       * - 圓圈大小反映平均預算金額\n       * - 點擊圓圈顯示詳細信息\n       * - 滿版顯示設計（左右下邊緣對齊容器）\n       *\n       * 數據篩選：\n       * - 只顯示包含「大學」或「學院」關鍵字的執行單位\n       * - 過濾掉沒有地理座標的單位\n       */\n      const initMap = () => {\n        // 防止重複初始化：檢查地圖容器是否已存在 Leaflet 實例\n        // document.getElementById(): 瀏覽器 DOM API，根據 ID 獲取 HTML 元素\n        const mapContainer = document.getElementById('taiwan-map');\n\n        // Leaflet 實例檢查：_leaflet_id 是 Leaflet 自動添加的內部屬性\n        // 如果存在則表示已經初始化過地圖實例\n        if (mapContainer._leaflet_id) {\n          // 清理舊的 Leaflet 實例：重置內部 ID 和清空容器內容\n          mapContainer._leaflet_id = null; // 重置 Leaflet 內部標識\n          mapContainer.innerHTML = ''; // 清空容器內的所有 HTML 內容\n        }\n\n        // 創建地圖實例，設定中心點為台灣中部，移除版權和縮放控制\n        const map = L.map('taiwan-map', {\n          zoomControl: false, // 移除縮放按鈕\n          attributionControl: false, // 移除版權bar\n        }).setView([23.8, 120.9], 7);\n\n        // 添加 OpenStreetMap 圖層（無版權標示）\n        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n          attribution: '', // 移除版權文字\n        }).addTo(map);\n\n        // 獲取包含\"大學\"或\"學院\"並有地理位置的執行單位數據\n        const universityUnits = dataStore.getUniversityExecutingUnitsWithLocation;\n\n        // 輸出除錯資訊\n        // eslint-disable-next-line no-console\n        console.log('地圖數據:', {\n          總大學學院數: universityUnits.length,\n          有地理位置的數量: universityUnits.filter((u) => u.hasLocation).length,\n          樣本數據: universityUnits.slice(0, 3),\n        });\n\n        // 如果沒有數據，顯示提示訊息\n        if (universityUnits.length === 0) {\n          // eslint-disable-next-line no-console\n          console.warn('沒有找到包含學術單位且有地理位置的執行單位數據');\n          return;\n        }\n\n        // 計算圓圈大小的範圍：基於平均金額的統計\n        const budgetValues = universityUnits.map((unit) => unit.本期經費平均_千元); // 使用本期經費平均_千元\n        const minBudget = Math.min(...budgetValues);\n        const maxBudget = Math.max(...budgetValues);\n\n        // eslint-disable-next-line no-console\n        console.log('平均預算金額範圍:', { 最小: minBudget, 最大: maxBudget });\n\n        // 在地圖上添加圓圈標記，大小反映平均預算金額\n        universityUnits.forEach((unit) => {\n          // 跳過沒有地理位置的單位\n          if (!unit.hasLocation) return;\n\n          // 計算圓圈大小：基於平均金額的相對大小\n          // 使用對數比例確保視覺效果合理\n          const scaleFactor = 0.15; // 縮放因子，調整整體大小（平均金額通常較大）\n          const radius = Math.sqrt((unit.本期經費平均_千元 * scaleFactor) / Math.PI); // 使用本期經費平均_千元\n\n          // 創建圓圈標記\n          const circle = L.circle([unit.lat, unit.lng], {\n            color: 'var(--my-color-red)', // 邊框顏色\n            fillColor: 'var(--my-color-red)', // 填充顏色\n            fillOpacity: 0.6, // 透明度\n            radius: radius * 1000, // 轉換為公尺\n            weight: 1, // 邊框寬度\n          }).addTo(map);\n\n          // 創建詳細的彈出視窗內容\n          const popupContent = `\n            <div>\n              <strong>${unit.name}</strong><br/>\n              <div>\n                <div>委托案件數: ${unit.委托案件數.toLocaleString()}</div>\n                <div>平均金額: ${Math.round(unit.本期經費平均_千元).toLocaleString()}(千元)</div>\n              </div>\n            </div>\n          `;\n\n          // 綁定彈出視窗\n          circle.bindPopup(popupContent, {\n            maxWidth: 300,\n          });\n\n          // 添加滑鼠懸停效果\n          circle.on('mouseover', function () {\n            this.setStyle({\n              fillOpacity: 0.8,\n              weight: 3,\n            });\n          });\n\n          circle.on('mouseout', function () {\n            this.setStyle({\n              fillOpacity: 0.6,\n              weight: 2,\n            });\n          });\n        });\n      };\n\n      // ==================== 生命週期鉤子區域 ====================\n\n      /**\n       * 組件掛載生命週期鉤子\n       * 功能：在組件 DOM 掛載完成後執行初始化邏輯\n       *\n       * 執行順序：\n       * 1. 載入所有必要的數據（主管機關、執行單位、映射關係）\n       * 2. 等待 DOM 更新完成\n       * 3. 初始化主圖表\n       * 4. 初始化所有小圖表\n       * 5. 初始化台灣地圖\n       *\n       * 異步處理：使用 async/await 確保數據載入完成後再進行圖表渲染\n       */\n      onMounted(async () => {\n        // 開發調試信息：記錄組件初始化開始\n        // eslint-disable-next-line no-console\n        console.log('平均金額統計頁面已初始化');\n\n        // 數據載入階段：從 dataStore 載入所有必要的數據\n        // await: 等待異步操作完成，確保數據準備就緒\n        // loadAllData(): dataStore 中的方法，載入主管機關、執行單位等所有數據\n        await dataStore.loadAllData();\n\n        // 開發調試信息：輸出載入狀態資訊，協助問題診斷\n        // eslint-disable-next-line no-console\n        console.log('資料載入狀態:', {\n          // 原始主管機關數據的數量\n          主管機關數量: dataStore.supervisorAgencies.length,\n          // 主管機關與執行單位映射關係的數量\n          映射資料數量: dataStore.supervisorExecutingMapping.length,\n          // 經過處理的前N名主管機關數量\n          前十名主管機關: dataStore.getTopSupervisorAgencies.length,\n          // 當前載入狀態（布林值）\n          載入中: dataStore.loading,\n          // 載入過程中的錯誤信息（如果有）\n          錯誤: dataStore.error,\n        });\n\n        // DOM 更新等待：確保 Vue 的響應式更新完成後再進行 DOM 操作\n        // nextTick(): Vue 3 提供的方法，等待下一個 DOM 更新週期\n        // 這確保所有的模板渲染和條件顯示都已完成，DOM 容器已準備就緒\n        const redrawAll = () => {\n          // 主圖表初始化：創建配置對象並調用繪圖函數\n          const mainChartConfig = {\n            // DOM 容器 ID：對應模板中的主圖表容器\n            containerId: 'main-chart',\n            // 圖表數據：調用數據準備函數獲取前8名主管機關數據\n            data: prepareMainChartData(),\n            // Y 軸標籤：根據用戶需求，設為空字串不顯示\n            yAxisLabel: '',\n            // 提高主圖高度：bar 區 320、容器總高 480（原本 160/320）\n            getChartHeight: () => 320,\n            getContainerHeight: () => 480,\n          };\n          // 調用主圖表繪製函數：使用配置對象創建主統計圖表\n          drawChart(mainChartConfig);\n\n          // 調用小圖表批次繪製函數：為每個主管機關創建執行單位圖表\n          drawSupervisorCharts();\n\n          // 調用地圖初始化函數：創建台灣地圖並添加學術單位標記\n          initMap();\n\n          // 調用關係圖繪製函數：創建主管機關與執行單位的網絡關係圖\n          drawNetworkGraph();\n\n          // 調用文字雲繪製函數：創建學術單位平均金額文字雲\n          drawWordCloud();\n        };\n\n        nextTick(() => {\n          redrawAll();\n          let resizeTimer = null;\n          const onResize = () => {\n            if (resizeTimer) clearTimeout(resizeTimer);\n            resizeTimer = setTimeout(() => {\n              d3.select('#main-chart').selectAll('*').remove();\n              redrawAll();\n            }, 200);\n          };\n          window.addEventListener('resize', onResize);\n          CaseBudget_onResize = onResize;\n        });\n      });\n\n      /**\n       * 組件卸載生命週期鉤子\n       * 功能：在組件從 DOM 中移除前執行清理工作\n       *\n       * 清理項目：\n       * - 移除 D3.js 創建的全域 DOM 元素\n       * - 防止記憶體洩漏和 DOM 污染\n       * - 確保組件重新掛載時不會出現衝突\n       *\n       * 注意：由於使用了容器內的 selectAll('*').remove()，\n       * 大部分清理工作已在圖表重繪時自動完成\n       */\n      let CaseBudget_onResize = null;\n      onUnmounted(() => {\n        // 清理 D3.js 創建的全域圖表標籤元素\n        // selectAll('.bar-label'): 選擇所有具有 'bar-label' 類別的元素\n        // remove(): 從 DOM 中移除選中的元素，釋放記憶體\n        // 這確保組件卸載時不會留下孤立的 DOM 元素\n        d3.selectAll('.bar-label').remove();\n\n        // 清理網絡圖的 tooltip 元素，避免記憶體洩漏\n        d3.selectAll('.network-tooltip').remove();\n\n        // 清理文字雲的 tooltip 元素，避免記憶體洩漏\n        d3.selectAll('.word-cloud-tooltip').remove();\n        if (CaseBudget_onResize) window.removeEventListener('resize', CaseBudget_onResize);\n      });\n\n      // ==================== 返回對象：暴露給模板的響應式數據和方法 ====================\n      // 在 Composition API 中，setup 函數必須返回一個對象\n      // 包含模板中需要使用的所有響應式數據、計算屬性和方法\n\n      return {\n        // 數據管理 Store：提供給模板使用的 Pinia store 實例\n        // 模板可以通過 dataStore.loading 等方式訪問數據狀態\n        dataStore,\n\n        // 除錯資訊：提供給模板的調試和狀態顯示數據\n        // 包含載入狀態、錯誤信息、數據統計等信息\n        debugInfo,\n\n        // 小圖表數據：計算屬性，提供前12名主管機關的圖表配置數據\n        // 模板中的 v-for 指令使用此數據來動態生成小圖表\n        getSupervisorChartsData,\n        exportContainerSvgAsPng,\n      };\n    }, // setup 函數結束\n  }; // Vue 組件配置對象結束\n</script>\n\n<template>\n  <div class=\"case-budget-container\">\n    <div class=\"w-100 px-3\">\n      <div class=\"row\">\n        <div class=\"col-6\">\n          <div class=\"chart-container my-bgcolor-white rounded-4 border py-3 position-relative\">\n            <button\n              class=\"btn btn-sm btn-outline-secondary position-absolute\"\n              style=\"\n                top: 8px;\n                right: 8px;\n                z-index: 2;\n                color: var(--my-color-gray-400);\n                border-color: var(--my-color-gray-400);\n              \"\n              title=\"下載 PNG\"\n              @click=\"exportContainerSvgAsPng('main-chart', '平均金額_主圖表.png')\"\n            >\n              <i class=\"fa-solid fa-download\"></i>\n            </button>\n            <div class=\"d-flex justify-content-center my-title-md-black\">\n              主管機關平均金額統計 (前12名)\n            </div>\n            <div v-if=\"debugInfo.error\" class=\"alert alert-danger mb-3\">\n              載入錯誤：{{ debugInfo.error }}\n            </div>\n            <div v-if=\"debugInfo.loading\" class=\"text-center text-muted mb-3\">載入中...</div>\n\n            <div\n              v-if=\"!debugInfo.hasData && !debugInfo.loading && !debugInfo.error\"\n              class=\"text-center text-muted mb-3\"\n            >\n              無資料\n            </div>\n\n            <div id=\"main-chart\" style=\"min-height: 480px\"></div>\n          </div>\n        </div>\n\n        <div class=\"col-6\">\n          <div class=\"chart-container my-bgcolor-white rounded-4 border pt-3\">\n            <div class=\"d-flex justify-content-center my-title-md-black pb-3\">\n              學術單位平均金額分布\n            </div>\n            <div id=\"taiwan-map\" style=\"height: 480px; border-radius: 0 0 1rem 1rem\"></div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"row\">\n        <div v-for=\"chartData in getSupervisorChartsData\" :key=\"chartData.id\" class=\"col-3 mt-4\">\n          <div class=\"chart-container my-bgcolor-white rounded-4 border py-3 position-relative\">\n            <button\n              class=\"btn btn-sm btn-outline-secondary position-absolute\"\n              style=\"\n                top: 8px;\n                right: 8px;\n                z-index: 2;\n                color: var(--my-color-gray-400);\n                border-color: var(--my-color-gray-400);\n              \"\n              title=\"下載 PNG\"\n              @click=\"exportContainerSvgAsPng(chartData.id, chartData.title + '_小圖表.png')\"\n            >\n              <i class=\"fa-solid fa-download\"></i>\n            </button>\n            <div class=\"d-flex justify-content-center my-title-md-black\">\n              {{ chartData.title }}\n            </div>\n            <div :id=\"chartData.id\" style=\"min-height: 320px\"></div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"row\">\n        <div class=\"col-12 mt-4\">\n          <div class=\"my-bgcolor-white rounded-4 border p-3 position-relative\">\n            <button\n              class=\"btn btn-sm btn-outline-secondary position-absolute\"\n              style=\"\n                top: 8px;\n                right: 8px;\n                z-index: 2;\n                color: var(--my-color-gray-400);\n                border-color: var(--my-color-gray-400);\n              \"\n              title=\"下載 PNG\"\n              @click=\"exportContainerSvgAsPng('network-graph', '平均金額_關係圖.png')\"\n            >\n              <i class=\"fa-solid fa-download\"></i>\n            </button>\n            <div class=\"d-flex justify-content-center my-title-md-black mb-3\">\n              主管機關與執行單位關係網絡圖\n            </div>\n            <div id=\"network-graph\" style=\"height: 600px; width: 100%\"></div>\n          </div>\n        </div>\n      </div>\n\n      <!-- 文字雲獨立框 -->\n      <div class=\"row\">\n        <div class=\"col-12 mt-4\">\n          <div class=\"my-bgcolor-white rounded-4 border p-3\">\n            <div class=\"d-flex justify-content-center my-title-md-black mb-3\">\n              學術單位平均金額文字雲\n            </div>\n            <div class=\"position-relative\">\n              <button\n                class=\"btn btn-sm btn-outline-secondary position-absolute\"\n                style=\"\n                  top: 8px;\n                  right: 8px;\n                  z-index: 2;\n                  color: var(--my-color-gray-400);\n                  border-color: var(--my-color-gray-400);\n                \"\n                title=\"下載 PNG\"\n                @click=\"exportContainerSvgAsPng('word-cloud', '平均金額_文字雲.png')\"\n              >\n                <i class=\"fa-solid fa-download\"></i>\n              </button>\n              <div id=\"word-cloud\" style=\"height: 400px; width: 100%\"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n  /* 使用Bootstrap和common.css的樣式，高度設定使用內聯style */\n</style>\n","import { render } from \"./CaseBudgetView.vue?vue&type=template&id=f01050c8&scoped=true\"\nimport script from \"./CaseBudgetView.vue?vue&type=script&lang=js\"\nexport * from \"./CaseBudgetView.vue?vue&type=script&lang=js\"\n\nimport \"./CaseBudgetView.vue?vue&type=style&index=0&id=f01050c8&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-f01050c8\"]])\n\nexport default __exports__","/**\n * Vue Router 路由配置\n * 雲林縣研究案統計平台路由管理\n */\n\nimport { createRouter, createWebHistory } from 'vue-router';\nimport HomeView from '../views/HomeView.vue';\nimport BasicStatsView from '../views/BasicStatsView.vue';\nimport CaseCountView from '../views/CaseCountView.vue';\nimport CaseBudgetView from '../views/CaseBudgetView.vue';\n\n/**\n * 路由配置陣列\n */\nconst routes = [\n  {\n    path: '/',\n    name: 'Home',\n    component: HomeView,\n    meta: {\n      title: '雲林縣研究案統計',\n    },\n    children: [\n      {\n        path: '',\n        redirect: '/basic-stats',\n      },\n      {\n        path: 'basic-stats',\n        name: 'BasicStats',\n        component: BasicStatsView,\n        meta: {\n          title: '雲林縣研究案統計 - 基本統計',\n        },\n      },\n      {\n        path: 'case-count',\n        name: 'CaseCount',\n        component: CaseCountView,\n        meta: {\n          title: '雲林縣研究案統計 - 案件數分析',\n        },\n      },\n      {\n        path: 'case-budget',\n        name: 'CaseBudget',\n        component: CaseBudgetView,\n        meta: {\n          title: '雲林縣研究案統計 - 預算分析',\n        },\n      },\n    ],\n  },\n];\n\n/**\n * 路由器實例創建\n */\nconst router = createRouter({\n  history: createWebHistory('/yulin-research/'),\n  routes,\n});\n\n// 設置頁面標題\nrouter.beforeEach((to, from, next) => {\n  document.title = to.meta.title || '雲林縣研究案統計';\n  next();\n});\n\nexport default router;\n","/**\n * 雲林縣研究案統計平台\n * 主要入口文件\n */\n\nimport { createApp } from 'vue';\nimport { createPinia } from 'pinia';\nimport App from './App.vue';\nimport router from './router';\n\n// 導入 Bootstrap CSS\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\n// 導入 Leaflet CSS\nimport 'leaflet/dist/leaflet.css';\n\n// 導入 Font Awesome CSS（本地套件，避免 CDN/SRI 問題）\nimport '@fortawesome/fontawesome-free/css/all.min.css';\n\n// 創建 Vue 應用\nconst app = createApp(App);\n\n// 創建並註冊 Pinia\nconst pinia = createPinia();\napp.use(pinia);\n\n// 註冊路由\napp.use(router);\n\n// 掛載應用\napp.mount('#app');\n\n// eslint-disable-next-line no-console\nconsole.log('雲林縣研究案統計平台已啟動');\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t524: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkyulin_research\"] = self[\"webpackChunkyulin_research\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], function() { return __webpack_require__(4528); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["id","_createElementBlock","_hoisted_1","_createVNode","_component_router_view","name","setup","__exports__","render","class","_createElementVNode","_hoisted_2","_hoisted_3","_normalizeClass","$setup","activeTab","onClick","_cache","$event","switchTab","_hoisted_4","router","useRouter","route","useRoute","computed","path","includes","tab","push","style","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_toDisplayString","countsSummary","全部","toLocaleString","_hoisted_10","_hoisted_11","_hoisted_12","學術","_hoisted_13","_hoisted_14","非學術","_hoisted_15","_hoisted_16","_hoisted_17","雲林","_hoisted_18","_hoisted_19","title","exportContainerSvgAsPng","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","async","containerId","filename","optionsOrScale","undefined","defaultScale","defaultBackground","isNumber","opts","scale","background","container","document","getElementById","svg","querySelector","clonedSvg","cloneNode","styleProps","originalNodes","querySelectorAll","cloneNodes","count","Math","min","length","i","src","dst","window","getComputedStyle","forEach","prop","val","getPropertyValue","setAttribute","rect","getBoundingClientRect","width","ceil","parseFloat","getAttribute","height","String","serializer","XMLSerializer","svgString","serializeToString","svgBlob","Blob","type","url","URL","createObjectURL","img","Image","Promise","resolve","reject","onload","onerror","canvas","createElement","max","Number","isFinite","round","ctx","getContext","imageSmoothingEnabled","imageSmoothingQuality","fillStyle","fillRect","drawImage","revokeObjectURL","a","download","href","toDataURL","body","appendChild","click","removeChild","ref","drawYearLineChart","d3","selectAll","remove","node","append","attr","margin","top","right","bottom","left","innerWidth","innerHeight","g","data","parsed","map","d","year","sort","b","sumAll","sumAcademic","sumNonAcademic","sumYunlin","value","years","minYear","maxYear","x","domain","range","maxValue","getRoundedMax","interval","roundedMax","roundedMaxValue","calculateYTicks","ticks","yTicks","y","yAxis","tickValues","tickSize","tickFormat","xAxis","xAxisG","call","select","enter","tooltip","makeLine","key","datum","drawPoints","color","label","on","event","html","pageX","pageY","legend","legendItems","item","text","drawWordCloud","config","items","textKey","valueKey","filter","sizeScale","exponent","words","size","placed","rects","measure","fontSize","tempSvg","tempText","bbox","getBBox","w","h","centerX","centerY","pad","intersect","r","l","t","placedOk","fs","tw","th","ang","rad","cos","sin","some","s","vx","vy","len","hypot","nx","ny","nrect","oob","palette","floor","random","passes","p","out","collide","j","BasicStatsView_onResize","onMounted","redrawAll","resizeTimer","onResize","clearTimeout","setTimeout","addEventListener","onUnmounted","removeEventListener","debugInfo","error","loading","hasData","_Fragment","_renderList","getSupervisorChartsData","chartData","useDataStore","defineStore","executingUnits","supervisorAgencies","supervisorExecutingMapping","executingUnitsLocations","getTopExecutingUnits","slice","委托案件數","getExecutingUnitsByBudget","所有相符資料_JSON","getTotalCount","reduce","sum","unit","getAverageBudget","totalBudget","getTopSupervisorAgencies","getTopSupervisorAgenciesByBudget","本期經費平均_千元","getAgencySubUnits","agencyName","subUnits","record","getAgencySubUnitsByBudget","getTop10AgenciesWithSubUnits","top12Agencies","agency","console","log","getTop10AgenciesWithSubUnitsByBudget","getUniversityExecutingUnitsWithLocation","universityUnits","學術單位","location","find","loc","lat","lng","hasLocation","loadSupervisorAgencies","response","fetch","ok","Error","status","json","mappedData","本期經費總合_千元","err","message","loadSupervisorExecutingMapping","name_sub","loadExecutingUnits","universityCount","loadExecutingUnitsLocations","loadAllData","all","searchExecutingUnits","keyword","toLowerCase","dataStore","top12AgenciesWithSubUnits","index","agencyData","topUnitsCount","drawChart","empty","containerWidth","containerHeight","getContainerHeight","barAreaHeight","getChartHeight","isMainChart","maxBars","topData","displayData","Array","from","_","position","uniqueName","fullName","isEmpty","barWidth","dataCount","totalBarWidth","availableSpaceWidth","spaceUnit","xScale","findIndex","yScale","labelData","xAxisGroup","dataItem","textGroup","lines","substring","totalLines","line","lineIndex","lineOffset","split","char","charIndex","drawSupervisorCharts","chartsData","subUnitsData","extra","budget","Boolean","chartConfig","yAxisLabel","tooltipTemplate","prepareMainChartData","topAgencies","prepareNetworkGraphData","nodes","links","academicAgencies","Set","add","mappingData","academicMappings","has","academicUnits","unitData","agencyMappings","totalCount","projectCount","meanBudget","isAcademic","academicStatus","unitName","unitMappings","unitAcademicStatus","source","target","unitNodesToMerge","n","aggTotalCount","aggTotalBudget","aggProjectCount","linkAggBySource","Map","prev","get","set","keptLinks","otherNodeId","otherNode","aggregatedLinks","entries","sourceId","sumValue","keptNodes","concat","MIN_COUNT","allowedNodeIds","drawNetworkGraph","graphData","containerRect","zoom","scaleExtent","transform","simulation","force","distance","strength","radius","scaleMultiplier","area","sqrt","PI","dragstarted","dragged","dragended","labels","active","alphaTarget","restart","fx","fy","this","transition","duration","typeText","tooltipContent","initMap","mapContainer","warn","_leaflet_id","innerHTML","L","zoomControl","attributionControl","setView","attribution","addTo","總大學學院數","有地理位置的數量","u","樣本數據","scaleFactor","circle","fillColor","fillOpacity","weight","popupContent","bindPopup","maxWidth","setStyle","countsForScale","minCountForScale","maxCountForScale","wordData","cssColors","placedRects","measureText","marginPad","rectsIntersect","sortedWordData","word","trySize","angle","hasCollision","curX","curY","curRect","vlen","step","outOfBounds","placedWord","主管機關數量","映射資料數量","前十名主管機關","載入中","錯誤","mainChartConfig","nextTick","CaseCount_onResize","numTicks","finalInterval","nonAcademicAgencies","THRESHOLD","unitNodesBelow","allowedIds","budgetValsForScale","minBudgetForScale","maxBudgetForScale","budgetValues","minBudget","maxBudget","最小","最大","CaseBudget_onResize","routes","component","HomeView","meta","children","redirect","BasicStatsView","CaseCountView","CaseBudgetView","createRouter","history","createWebHistory","beforeEach","to","next","app","createApp","App","pinia","createPinia","use","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","m","deferred","O","result","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","Object","keys","every","splice","getter","__esModule","definition","o","defineProperty","enumerable","globalThis","Function","e","obj","prototype","hasOwnProperty","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","bind","__webpack_exports__"],"sourceRoot":""}